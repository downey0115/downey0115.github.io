<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GitLab+Jenkins实现持续集成+自动化部署（转载） | LeafD</title><meta name="keywords" content="jenkins"><meta name="author" content="LeafD"><meta name="copyright" content="LeafD"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="一.自动化上线代码基本介绍1.软件开发生命周期老板创意—产品经理—立项—开发团队—测试团队(黑白盒)—运维上线产品经理—加需求—开发团队—测试团队—运维更新代码上线 2.什么是环境？开发环境：开发自己用的电脑本地自己装的php python的开发工具等。测试环境：多个人的代码合起来跑一遍，运行一次，测试mysql redis等。预发布环境：直接连接线上数据库，专门的测试域名小范围内测试。生产环境：">
<meta property="og:type" content="article">
<meta property="og:title" content="GitLab+Jenkins实现持续集成+自动化部署（转载）">
<meta property="og:url" content="https://downey0115.github.io/d564cbe68145.html">
<meta property="og:site_name" content="LeafD">
<meta property="og:description" content="一.自动化上线代码基本介绍1.软件开发生命周期老板创意—产品经理—立项—开发团队—测试团队(黑白盒)—运维上线产品经理—加需求—开发团队—测试团队—运维更新代码上线 2.什么是环境？开发环境：开发自己用的电脑本地自己装的php python的开发工具等。测试环境：多个人的代码合起来跑一遍，运行一次，测试mysql redis等。预发布环境：直接连接线上数据库，专门的测试域名小范围内测试。生产环境：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover9.png">
<meta property="article:published_time" content="2021-06-21T13:51:34.000Z">
<meta property="article:modified_time" content="2022-07-04T02:51:03.475Z">
<meta property="article:author" content="LeafD">
<meta property="article:tag" content="jenkins">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover9.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://downey0115.github.io/d564cbe68145"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: LeafD","link":"链接: ","source":"来源: LeafD","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-04 10:51:03'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/downey0115/CDN/configuration/avatar1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover9.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LeafD</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">GitLab+Jenkins实现持续集成+自动化部署（转载）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-21T13:51:34.000Z" title="发表于 2021-06-21 21:51:34">2021-06-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-04T02:51:03.475Z" title="更新于 2022-07-04 10:51:03">2022-07-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一-自动化上线代码基本介绍"><a href="#一-自动化上线代码基本介绍" class="headerlink" title="一.自动化上线代码基本介绍"></a>一.自动化上线代码基本介绍</h1><h4 id="1-软件开发生命周期"><a href="#1-软件开发生命周期" class="headerlink" title="1.软件开发生命周期"></a>1.软件开发生命周期</h4><p>老板创意—产品经理—立项—开发团队—测试团队(黑白盒)—运维上线<br>产品经理—加需求—开发团队—测试团队—运维更新代码上线</p>
<h4 id="2-什么是环境？"><a href="#2-什么是环境？" class="headerlink" title="2.什么是环境？"></a>2.什么是环境？</h4><p>开发环境：开发自己用的电脑本地自己装的php python的开发工具等。<br>测试环境：多个人的代码合起来跑一遍，运行一次，测试mysql redis等。<br>预发布环境：直接连接线上数据库，专门的测试域名小范围内测试。<br>生产环境：线上环境 每个项目一套环境 (线下可以放一起配多域名 线上不行)。</p>
<h4 id="3-什么是持续集成-CI-？"><a href="#3-什么是持续集成-CI-？" class="headerlink" title="3.什么是持续集成(CI)？"></a>3.什么是持续集成(CI)？</h4><p>每天都进行一次代码合并，就是持续集成。<br>多个开发写的代码 集中起来管理 放到代码库里 (版本控制管理软件)代码库工具：svn git(多) 。（版本控制系统：类似于快照的增量备份的机制，也就是每一次版本更新，都会在原来的基础上保留变化的内容，生成一个新的版本，之前的版本也会被保留，以便快速回滚。）<br>每天都要做代码合并，防止冲突，在合并的时候会产生冲突，所以提交的时候有先后顺序，就是你先上传，然后我把你上传的拉过来和我的进行合并，排除冲突，然后我在上传到主分支。持续集成是一种软件开发实践，即团队开发成员经常集成他们的工作，通常每个成员至少集成一次，也就意味着每天可能会发生多次集成。每次集成都通过自动化的构建（包括编译、发布、自动化测试）来验证，从而尽快地发现集成错误。许多团队发现这个过程可以大大减少集成的问题，让团队能够更快的开发内聚的软件。</p>
<h4 id="4-什么是持续交付？"><a href="#4-什么是持续交付？" class="headerlink" title="4.什么是持续交付？"></a>4.什么是持续交付？</h4><p>开发首先进行单元测试—最后把所有代码放一起进行测试—代码质量检查。</p>
<h4 id="5-什么是持续部署？"><a href="#5-什么是持续部署？" class="headerlink" title="5.什么是持续部署？"></a>5.什么是持续部署？</h4><p>频繁的代码上线就是持续部署。</p>
<h4 id="6-没有持续集成"><a href="#6-没有持续集成" class="headerlink" title="6.没有持续集成"></a>6.没有持续集成</h4><p>项目做模块集成的时候，发现很多接口都不通==&gt;浪费大量时间<br>需要手动去编译打包最新的代码==&gt;构建过程不透明<br>发布代码，上线，基本靠手工==&gt;脚本乱飞</p>
<h4 id="7-持续集成最佳实践"><a href="#7-持续集成最佳实践" class="headerlink" title="7.持续集成最佳实践"></a>7.持续集成最佳实践</h4><p>维护一个单一的代码库<br>使构建自动化<br>执行测试是构建的一部分<br>集成日志及历史记录<br>使用统一的依赖包管理库<br>每天至少集成一次</p>
<h1 id="二-jenkins基础使用"><a href="#二-jenkins基础使用" class="headerlink" title="二.jenkins基础使用"></a>二.jenkins基础使用</h1><p>说明：如何安装Jenkins请参考文档：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/343bdd43c82a">https://www.jianshu.com/p/343bdd43c82a</a><br>这里就省略安装。</p>
<h6 id="1-登录Jenkins-webUI界面创建一个项目"><a href="#1-登录Jenkins-webUI界面创建一个项目" class="headerlink" title="1.登录Jenkins webUI界面创建一个项目"></a>1.登录Jenkins webUI界面创建一个项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a287d2ba7cc58975.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="2-输入项目名称-free-job-并选择构建一个自由风格的软件项目"><a href="#2-输入项目名称-free-job-并选择构建一个自由风格的软件项目" class="headerlink" title="2.输入项目名称(free-job)并选择构建一个自由风格的软件项目"></a>2.输入项目名称(free-job)并选择构建一个自由风格的软件项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-2adb0148c5a8f6ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5-7天即可）"><a href="#3-上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5-7天即可）" class="headerlink" title="3.上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5~7天即可）"></a>3.上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5~7天即可）</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-3935302285e0b972.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-接着上面选择构建，然后选择Execute-Shell-来执行shell命令"><a href="#4-接着上面选择构建，然后选择Execute-Shell-来执行shell命令" class="headerlink" title="4.接着上面选择构建，然后选择Execute Shell 来执行shell命令"></a>4.接着上面选择构建，然后选择Execute Shell 来执行shell命令</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a4d7a122be4c7a6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里"><a href="#5-既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里" class="headerlink" title="5.既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里"></a>5.既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-01056822b249c761.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="6-上面保存后点击立即构建，就会在下面生成一个build-history，（出现蓝色即表示正常，若红色即表示有问题"><a href="#6-上面保存后点击立即构建，就会在下面生成一个build-history，（出现蓝色即表示正常，若红色即表示有问题" class="headerlink" title="6.上面保存后点击立即构建，就会在下面生成一个build history，（出现蓝色即表示正常，若红色即表示有问题)"></a>6.上面保存后点击立即构建，就会在下面生成一个build history，（出现蓝色即表示正常，若红色即表示有问题)</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-4e05999c5800be4d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="7-构建完成，我们可以点击build-ID下拉框选择Console-Output-来查看详细信息"><a href="#7-构建完成，我们可以点击build-ID下拉框选择Console-Output-来查看详细信息" class="headerlink" title="7.构建完成，我们可以点击build ID下拉框选择Console Output 来查看详细信息"></a>7.构建完成，我们可以点击build ID下拉框选择Console Output 来查看详细信息</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-f3263514aaf2605f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="8-通过输出信息我们可以看到Jenkins默认的工作目录在-root-jenkins-workspace-项目名称"><a href="#8-通过输出信息我们可以看到Jenkins默认的工作目录在-root-jenkins-workspace-项目名称" class="headerlink" title="8.通过输出信息我们可以看到Jenkins默认的工作目录在 /root/.jenkins/workspace/(项目名称)"></a>8.通过输出信息我们可以看到Jenkins默认的工作目录在 /root/.jenkins/workspace/(项目名称)</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9b36f97427b2c201.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="9-既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置"><a href="#9-既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置" class="headerlink" title="9.既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置"></a>9.既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-1f152a1b8ee32f9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="10-创建一个free-txt文件并保存"><a href="#10-创建一个free-txt文件并保存" class="headerlink" title="10.创建一个free.txt文件并保存"></a>10.创建一个free.txt文件并保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-5db1e86e782071f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="11-同上面一样，我们点击立即构建"><a href="#11-同上面一样，我们点击立即构建" class="headerlink" title="11.同上面一样，我们点击立即构建"></a>11.同上面一样，我们点击立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-e2988a3a78150fd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="12-同样查看构建后的控制台输出，可以看到构建成功"><a href="#12-同样查看构建后的控制台输出，可以看到构建成功" class="headerlink" title="12.同样查看构建后的控制台输出，可以看到构建成功"></a>12.同样查看构建后的控制台输出，可以看到构建成功</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-d2676c3d8845048d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="13-既然构建成功，那么我们进入服务器进行验证是否创建成功"><a href="#13-既然构建成功，那么我们进入服务器进行验证是否创建成功" class="headerlink" title="13.既然构建成功，那么我们进入服务器进行验证是否创建成功"></a>13.既然构建成功，那么我们进入服务器进行验证是否创建成功</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]<span class="meta"># cd /var/lib/jenkins/workspace/free-job/</span></span><br><span class="line">[root@jenkins /var/lib/jenkins/workspace/<span class="built_in">free</span>-job]<span class="meta"># ls</span></span><br><span class="line"><span class="built_in">free</span>.txt</span><br></pre></td></tr></table></figure>
<h1 id="三-GitLab-Jenkins自动化部署及更新"><a href="#三-GitLab-Jenkins自动化部署及更新" class="headerlink" title="三.GitLab+Jenkins自动化部署及更新"></a>三.GitLab+Jenkins自动化部署及更新</h1><p><strong>流程图如下：</strong>  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-834f444e13df92e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1067/format/webp"></p>
<p>说明：通过gitlab+Jenkins实现代码的自动更新同步代码到web服务器站点目录。此处示例后端web服务器使用nginx。<br><strong>环境规划以及ip分配如下表：</strong>  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-fb6ed0a0bc780d1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/348/format/webp"></p>
<p>注意：开发环境这里直接放在gitlab服务器上这里将git也部署在gitlab服务器上。git基本使用请参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/96c4a6d0c587">https://www.jianshu.com/p/96c4a6d0c587</a></p>
<h4 id="3-1gitlab-配置"><a href="#3-1gitlab-配置" class="headerlink" title="3.1gitlab 配置"></a>3.1gitlab 配置</h4><p>说明：首先在gitlab上面创建一个群组，并创建一个项目，将代码push 到代码仓库中（项目）。创建一个开发用户（用于提交代码等），同时在Jenkins服务器上面生成ssh秘钥并将key添加到新建用户的ssh认证下面。</p>
<h6 id="1-登录gitlab点击项目，然后点击创建一个群组"><a href="#1-登录gitlab点击项目，然后点击创建一个群组" class="headerlink" title="1.登录gitlab点击项目，然后点击创建一个群组"></a>1.登录gitlab点击项目，然后点击创建一个群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9c5feed5943c278e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="2-点击新建群组"><a href="#2-点击新建群组" class="headerlink" title="2.点击新建群组"></a>2.点击新建群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9d45f29e57affb83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-输入新建群组的相关信息并点击创建"><a href="#3-输入新建群组的相关信息并点击创建" class="headerlink" title="3.输入新建群组的相关信息并点击创建"></a>3.输入新建群组的相关信息并点击创建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7328687ce393e424.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-cf5a88ead554872b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-29416ea87d2b2928.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-新建一个项目"><a href="#4-新建一个项目" class="headerlink" title="4.新建一个项目"></a>4.新建一个项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-76caee6af95d3769.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-a3f535c71eaf882f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-f90bab31319fd9dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-设置秘钥"><a href="#5-设置秘钥" class="headerlink" title="5.设置秘钥"></a>5.设置秘钥</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># ssh-keygen -t rsa</span></span><br><span class="line">Generating <span class="keyword">public</span>/<span class="keyword">private</span> rsa key pair.</span><br><span class="line"><span class="function">Enter file <span class="keyword">in</span> which to save the <span class="title">key</span> (<span class="params">/root/.ssh/id_rsa</span>): </span></span><br><span class="line"><span class="function">Created directory &#x27;/root/.ssh&#x27;.</span></span><br><span class="line"><span class="function">Enter <span class="title">passphrase</span> (<span class="params">empty <span class="keyword">for</span> no passphrase</span>): </span></span><br><span class="line"><span class="function">Enter same passphrase again: </span></span><br><span class="line"><span class="function">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span></span><br><span class="line"><span class="function">Your <span class="keyword">public</span> key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span></span><br><span class="line"><span class="function">The key fingerprint <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">SHA256:WyI0C3MBpUdsAKQsDkEf99WmtCUvcXUoxWL+NgF2R0I root@gitlab</span></span><br><span class="line"><span class="function">The key&#x27;s randomart image <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">+---[RSA 2048]----+</span></span><br><span class="line"><span class="function">|ooooo*+  ..</span> =Eoo |</span><br><span class="line">|.o. oo+..+ @ +o. |</span><br><span class="line">|+. .+.=.. &amp; = .  |</span><br><span class="line">|+    * o + o .   |</span><br><span class="line">| .    o S o . .  |</span><br><span class="line">|       . +   +   |</span><br><span class="line">|        .   . .  |</span><br><span class="line">|                 |</span><br><span class="line">|                 |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># cat .ssh/id_rsa.pub </span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnnyT5IRLN2AzknCPE3pLnLhH0Vq6jGJsYsjDaLKBQNkBD4coTMW47PJpjxL/pjwyV9KaQ3BuEqam8jQlpaDYUQVBK++<span class="number">0</span>ALFAObGTyTPThRVKhW7X3kjSkInkwAZVj2dLdU0oIinzEuCjldhOe3BF2FYHRgcbnklEFIVpK3quTJbKxcF4h8SMbihRbXor0AIsOupWd0z2skqqvr4xSDNPAb4t+Ypd0MnGPRJYb8DTs+Ign+gn6L7a48RWqqIhBjVjgDLHiitMeEKA6FCS4cEHvcbHhXtrLswfF2ocA+mjfb5WGfP73d959fSPfvraRhhxXqBMqM309DmO3DGtS2e1j root@gitlab</span><br></pre></td></tr></table></figure>
<h6 id="6-塞key操作，方便源码上传下载"><a href="#6-塞key操作，方便源码上传下载" class="headerlink" title="6.塞key操作，方便源码上传下载"></a>6.塞key操作，方便源码上传下载</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-60ec72f29fad364e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="7-点击头像查看创建项目的结果"><a href="#7-点击头像查看创建项目的结果" class="headerlink" title="7.点击头像查看创建项目的结果"></a>7.点击头像查看创建项目的结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-2dc066a5f3995902.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-caf14bb024770513.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="8-查看项目根据提示配置初始化"><a href="#8-查看项目根据提示配置初始化" class="headerlink" title="8.查看项目根据提示配置初始化"></a>8.查看项目根据提示配置初始化</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-fef4277cd6f8e322.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-cb0b1b094c67aac0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="9-模拟开发建立git本地工作目录和本地仓库"><a href="#9-模拟开发建立git本地工作目录和本地仓库" class="headerlink" title="9.模拟开发建立git本地工作目录和本地仓库"></a>9.模拟开发建立git本地工作目录和本地仓库</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#这里的源码使用的码云上源码，你可以自行下载使用即可。</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git config --global user.name &quot;Administrator&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git config --global user.email &quot;admin@example.com&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git init</span></span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /root/yiliaoqixie/.git/</span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git commit -m &quot;第一次提交项目&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git remote add origin git@10.0.0.55:yiliao/yiliao.git</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure>
<h5 id="10-查看上传的结果"><a href="#10-查看上传的结果" class="headerlink" title="10.查看上传的结果"></a>10.查看上传的结果</h5><p><img src="//upload-images.jianshu.io/upload_images/19901269-f48caa199901c898.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="11-点击设置选择新建用户"><a href="#11-点击设置选择新建用户" class="headerlink" title="11.点击设置选择新建用户"></a>11.点击设置选择新建用户</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-bf376a1c2e0f11ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="12-输入账号相关信息并点击创建用户"><a href="#12-输入账号相关信息并点击创建用户" class="headerlink" title="12.输入账号相关信息并点击创建用户"></a>12.输入账号相关信息并点击创建用户</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-01abf88d15a779f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-04d351fdec1043af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="13-点击编辑，为上面新创建的用户设置密码"><a href="#13-点击编辑，为上面新创建的用户设置密码" class="headerlink" title="13.点击编辑，为上面新创建的用户设置密码"></a>13.点击编辑，为上面新创建的用户设置密码</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-0bdccd453ea8bdb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="14-给这个账号设置密码并保存"><a href="#14-给这个账号设置密码并保存" class="headerlink" title="14.给这个账号设置密码并保存"></a>14.给这个账号设置密码并保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7848ede10c6052aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-decd77c763d152b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="15-将上面创建的用户添加到devops组中并给与开发者权限"><a href="#15-将上面创建的用户添加到devops组中并给与开发者权限" class="headerlink" title="15.将上面创建的用户添加到devops组中并给与开发者权限"></a>15.将上面创建的用户添加到devops组中并给与开发者权限</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-8ee57e9f62b3954f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="16-找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组"><a href="#16-找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组" class="headerlink" title="16.找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组"></a>16.找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-1f58d023dcc17794.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h2 id="3-2Jenkins配置"><a href="#3-2Jenkins配置" class="headerlink" title="3.2Jenkins配置"></a>3.2Jenkins配置</h2><h6 id="1-在Jenkins的服务器上生成秘钥"><a href="#1-在Jenkins的服务器上生成秘钥" class="headerlink" title="1.在Jenkins的服务器上生成秘钥"></a>1.在Jenkins的服务器上生成秘钥</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># ssh-keygen -t rsa</span></span><br><span class="line">Generating <span class="keyword">public</span>/<span class="keyword">private</span> rsa key pair.</span><br><span class="line"><span class="function">Enter file <span class="keyword">in</span> which to save the <span class="title">key</span> (<span class="params">/root/.ssh/id_rsa</span>): </span></span><br><span class="line"><span class="function">Created directory &#x27;/root/.ssh&#x27;.</span></span><br><span class="line"><span class="function">Enter <span class="title">passphrase</span> (<span class="params">empty <span class="keyword">for</span> no passphrase</span>): </span></span><br><span class="line"><span class="function">Enter same passphrase again: </span></span><br><span class="line"><span class="function">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span></span><br><span class="line"><span class="function">Your <span class="keyword">public</span> key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span></span><br><span class="line"><span class="function">The key fingerprint <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">SHA256:Y/nVt2+ldZc+h4VrsormDhSXKj3ryP/LlLkpIU95xjA root@jenkins</span></span><br><span class="line"><span class="function">The key&#x27;s randomart image <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">+---[RSA 2048]----+</span></span><br><span class="line"><span class="function">|                 |</span></span><br><span class="line"><span class="function">|         .       |</span></span><br><span class="line"><span class="function">|      . o        |</span></span><br><span class="line"><span class="function">|     .E+ .   .   |</span></span><br><span class="line"><span class="function">|    .</span> ==S   . ..o|</span><br><span class="line">|    .o+++= .  .oB|</span><br><span class="line">|     +o++ .   .B+|</span><br><span class="line">|   . oo+.+  . =o+|</span><br><span class="line">|    o.o*X....+ .+|</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># cat ./.ssh/id_rsa</span></span><br><span class="line">id_rsa      id_rsa.pub  </span><br><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># cat ./.ssh/id_rsa.pub </span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCssc5KGRIvHV64Md3HR3SdT0w4twdrAIbxWSSo3tvfrauMdSk2ptmxvgzPqfGEQUgHfPsZY10eN0bpvaFARLBDytyRLbgdSo6gts+J0nGhy0hcjOhu4xJgygt8hN53UCUbdy7DhUnwxIfOuzENFYLS7ZW/Uk4N1FrNNuZK0X5aVNsV5r9H+fUeOfMJ4YLjLhFn6C94q4XmS9OfAW0aCSUfBbCT9LnRmeU/FoQMGdujBZ+Koc9289IVNHkVL+vEW6ZTxLPMEoRaB0RlLxfZF86LMsjsqx6ABBHNpV5FZWl0OYnnEn3jKHRNStfxx2g5Hz9e7eRguBubBis75OfHf2br root@jenkins</span><br></pre></td></tr></table></figure>
<h6 id="2-回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置"><a href="#2-回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置" class="headerlink" title="2.回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置"></a>2.回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-65eeefdfa3b423f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-上面的设置点进来后，选择SSH-秘钥，-然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥"><a href="#3-上面的设置点进来后，选择SSH-秘钥，-然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥" class="headerlink" title="3.上面的设置点进来后，选择SSH 秘钥， 然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥"></a>3.上面的设置点进来后，选择SSH 秘钥， 然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-cb62a56dc0f15837.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-21869ebbc48f29bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-8f40b346d767b6c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-新建任务"><a href="#4-新建任务" class="headerlink" title="4.新建任务"></a>4.新建任务</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-80ad5c7275c9baa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-78da6fa9e19e318f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-点击项目名称开始配置"><a href="#5-点击项目名称开始配置" class="headerlink" title="5.点击项目名称开始配置"></a>5.点击项目名称开始配置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-4813ed392f3dd230.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="6-选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存"><a href="#6-选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存" class="headerlink" title="6.选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存"></a>6.选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-bfe5b72ed06082f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="7-立即构建"><a href="#7-立即构建" class="headerlink" title="7.立即构建"></a>7.立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-312d586dd877b0a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="8-查看构建信息"><a href="#8-查看构建信息" class="headerlink" title="8.查看构建信息"></a>8.查看构建信息</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-efa9030643b3111d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="9-服务端查看"><a href="#9-服务端查看" class="headerlink" title="9.服务端查看"></a>9.服务端查看</h6><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@jenkins /var/lib/jenkins/workspace/yiliao]</span># <span class="selector-tag">ls</span></span><br><span class="line"><span class="selector-tag">about</span><span class="selector-class">.html</span>           <span class="selector-tag">article</span><span class="selector-class">.html</span>                         <span class="selector-tag">contact</span><span class="selector-class">.html</span>  <span class="selector-tag">index</span><span class="selector-class">.html</span>           <span class="selector-tag">product</span><span class="selector-class">.html</span></span><br><span class="line"><span class="selector-tag">album</span><span class="selector-class">.html</span>           <span class="selector-tag">Bootstrap</span>医疗器械公司响应式网站模板  <span class="selector-tag">css</span>           <span class="selector-tag">js</span></span><br><span class="line"><span class="selector-tag">article_detail</span><span class="selector-class">.html</span>  <span class="selector-tag">comment</span><span class="selector-class">.html</span>                         <span class="selector-tag">images</span>        <span class="selector-tag">product_detail</span><span class="selector-class">.html</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-3实现自动部署"><a href="#3-3实现自动部署" class="headerlink" title="3.3实现自动部署"></a>3.3实现自动部署</h2><p>上面已经完成了Jenkins从gitlab上拉取代码，现在需要实现如何将源码自动部署到web服务器上，这里使用脚本的方式来实现，Jenkins支持执行脚本的功能。</p>
<h6 id="1-在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证"><a href="#1-在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证" class="headerlink" title="1.在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证"></a>1.在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]<span class="comment"># ssh-copy-id -i 10.0.0.7</span></span><br><span class="line">[root@jenkins ~]<span class="comment"># ssh-copy-id -i 10.0.0.8</span></span><br><span class="line">[root@jenkins /server/scripts]<span class="comment"># vim deploy.sh </span></span><br><span class="line"><span class="comment">#项目目录</span></span><br><span class="line">CODE_DIR=/var/lib/jenkins/workspace/yiliao/</span><br><span class="line"><span class="comment">#时间格式</span></span><br><span class="line">DATE_TIME=`date +%Y-%m-%d-%H-%M-%S`</span><br><span class="line"><span class="comment">#打包后的名字</span></span><br><span class="line">TAR_NAME=web-<span class="variable">$&#123;DATE_TIME&#125;</span>.tar.gz</span><br><span class="line"><span class="comment">#web服务器站点目录的上一级 &quot;/usr/share/nginx/html&quot;</span></span><br><span class="line">WEB_DIR=/usr/share/nginx/</span><br><span class="line"><span class="comment">#web服务器新建的站点目录名字</span></span><br><span class="line">WEB_NEWDIR_NAME=web-<span class="variable">$&#123;DATE_TIME&#125;</span></span><br><span class="line"><span class="comment">#进入到项目目录上一级打包代码</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$CODE_DIR</span> &amp;&amp; tar czf /opt/<span class="variable">$TAR_NAME</span> ./*</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;7,8&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="comment">#拷贝到web服务器的站点目录的上一级</span></span><br><span class="line">    scp /opt/<span class="variable">$TAR_NAME</span> 10.0.0.<span class="variable">$&#123;i&#125;</span>:<span class="variable">$WEB_DIR</span></span><br><span class="line"><span class="comment">#连接web服务器进行解压压缩包到新的一个已时间命名的站点目录</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; mkdir <span class="variable">$WEB_NEWDIR_NAME</span> &amp;&amp; tar xf <span class="variable">$TAR_NAME</span> -C <span class="variable">$WEB_NEWDIR_NAME</span>&quot;</span></span><br><span class="line"><span class="comment">#将新建的站点目录与html站点目录做一个软链接</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; rm -rf html &amp;&amp; ln -s <span class="variable">$WEB_NEWDIR_NAME</span> html&quot;</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; rm -rf <span class="variable">$TAR_NAME</span>&quot;</span></span><br><span class="line">    sleep 3</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h6 id="2-配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）"><a href="#2-配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）" class="headerlink" title="2.配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）"></a>2.配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-8c8726bbf2777a43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-立即构建"><a href="#3-立即构建" class="headerlink" title="3.立即构建"></a>3.立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-56ae6962a19eaa34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-查看输出结果"><a href="#4-查看输出结果" class="headerlink" title="4.查看输出结果"></a>4.查看输出结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-848814b9bedb872b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-测试访问结果"><a href="#5-测试访问结果" class="headerlink" title="5.测试访问结果"></a>5.测试访问结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7fd0ba8900f2b980.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h2 id="3-4自动更新"><a href="#3-4自动更新" class="headerlink" title="3.4自动更新"></a>3.4自动更新</h2><h6 id="1-配置自动触发构建、需要设置安全令牌Secret-token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build-when-a-chang上面提示的URL地址（-http-10-0-0-57-8080-project-yiliao）"><a href="#1-配置自动触发构建、需要设置安全令牌Secret-token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build-when-a-chang上面提示的URL地址（-http-10-0-0-57-8080-project-yiliao）" class="headerlink" title="1.配置自动触发构建、需要设置安全令牌Secret token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build when a chang上面提示的URL地址（ http://10.0.0.57:8080/project/yiliao）"></a>1.配置自动触发构建、需要设置安全令牌Secret token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build when a chang上面提示的URL地址（ <a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http://10.0.0.57:8080/project/yiliao">http://10.0.0.57:8080/project/yiliao</a>）</h6><p>选择构建触发器，然后选择build when a change is ….,下方有个高级选项后然后选择Filter branches byname,然后输入master分支，再点击下面的Generate生成token,然后点击保存。</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-c98832fb2e89a63c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="2-配置gitlab，添加token"><a href="#2-配置gitlab，添加token" class="headerlink" title="2.配置gitlab，添加token"></a>2.配置gitlab，添加token</h6><p>点击项目→设置→设置→集成，然后输入Jenkins上面提示的URL地址和和生成的token，点击增加web钩子。</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-a39d98d7f47b447f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-测试Web钩子"><a href="#3-测试Web钩子" class="headerlink" title="3.测试Web钩子"></a>3.测试Web钩子</h6><p>添加完钩子完成后可以测试，选择Push event,执行完会显示上面的提示。</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-5ca93f8e5cfda33d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面，-这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。"><a href="#4-上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面，-这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。" class="headerlink" title="4.上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面， 这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。"></a>4.上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面， 这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。</h6><p>修改首页内容：</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-b74a0431f18f3756.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-推送新的修改源码"><a href="#5-推送新的修改源码" class="headerlink" title="5.推送新的修改源码"></a>5.推送新的修改源码</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git commit -m &quot;第二次提交&quot;</span></span><br><span class="line">[<span class="meta">master 4b8d377</span>] 第二次提交</span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure>
<h6 id="6-测试访问"><a href="#6-测试访问" class="headerlink" title="6.测试访问"></a>6.测试访问</h6><p>之前的结果如下图：</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-e41db0597803a470.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>现在的结果：</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-397919621c4700f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h2 id="3-5配置构建Jenkins返回构建状态gitlab"><a href="#3-5配置构建Jenkins返回构建状态gitlab" class="headerlink" title="3.5配置构建Jenkins返回构建状态gitlab"></a>3.5配置构建Jenkins返回构建状态gitlab</h2><h6 id="1-现在gotlab上面生成访问令牌token，点击用户处的设置"><a href="#1-现在gotlab上面生成访问令牌token，点击用户处的设置" class="headerlink" title="1.现在gotlab上面生成访问令牌token，点击用户处的设置"></a>1.现在gotlab上面生成访问令牌token，点击用户处的设置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-59e6db3363db43db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="2-访问令牌——-gt-输入名称——-gt-选择范围为api——-gt-创建个人访问令牌，将生成的令牌token复制"><a href="#2-访问令牌——-gt-输入名称——-gt-选择范围为api——-gt-创建个人访问令牌，将生成的令牌token复制" class="headerlink" title="2.访问令牌——&gt;输入名称——&gt;选择范围为api——&gt;创建个人访问令牌，将生成的令牌token复制"></a>2.访问令牌——&gt;输入名称——&gt;选择范围为api——&gt;创建个人访问令牌，将生成的令牌token复制</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-fd2d81d235808feb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="3-登录Jenkins———-gt-选择系统管理——-gt-选择系统设置——-gt-选择Gitlab——-gt-输入名字——-gt-输入URL———-gt-点击Add"><a href="#3-登录Jenkins———-gt-选择系统管理——-gt-选择系统设置——-gt-选择Gitlab——-gt-输入名字——-gt-输入URL———-gt-点击Add" class="headerlink" title="3.登录Jenkins———&gt;选择系统管理——&gt;选择系统设置——&gt;选择Gitlab——&gt;输入名字——&gt;输入URL———&gt;点击Add"></a>3.登录Jenkins———&gt;选择系统管理——&gt;选择系统设置——&gt;选择Gitlab——&gt;输入名字——&gt;输入URL———&gt;点击Add</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-c03148b9f513a509.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="4-上面点击Add进来后，kind处选择Gitlab-API-token，粘贴上面复制的token，自定义ID和描述"><a href="#4-上面点击Add进来后，kind处选择Gitlab-API-token，粘贴上面复制的token，自定义ID和描述" class="headerlink" title="4.上面点击Add进来后，kind处选择Gitlab API token，粘贴上面复制的token，自定义ID和描述"></a>4.上面点击Add进来后，kind处选择Gitlab API token，粘贴上面复制的token，自定义ID和描述</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-157415e4f2e03ca7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="5-上面添加后，回到这里选择刚刚生成的这个token。然后点击保存"><a href="#5-上面添加后，回到这里选择刚刚生成的这个token。然后点击保存" class="headerlink" title="5.上面添加后，回到这里选择刚刚生成的这个token。然后点击保存"></a>5.上面添加后，回到这里选择刚刚生成的这个token。然后点击保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-834c171ea982d8c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="6-上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish-…-to-…Gitlab，选择后直接保存就ok"><a href="#6-上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish-…-to-…Gitlab，选择后直接保存就ok" class="headerlink" title="6.上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish … to …Gitlab，选择后直接保存就ok"></a>6.上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish … to …Gitlab，选择后直接保存就ok</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-441d390b5e4ef93b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="7-测试，点击立即构建"><a href="#7-测试，点击立即构建" class="headerlink" title="7.测试，点击立即构建"></a>7.测试，点击立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-70653c07bb9f21e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="8-回到gitlab上面查看，那里生成了一个对号"><a href="#8-回到gitlab上面查看，那里生成了一个对号" class="headerlink" title="8.回到gitlab上面查看，那里生成了一个对号"></a>8.回到gitlab上面查看，那里生成了一个对号</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-c229b9b4fc197a5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="9-点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。"><a href="#9-点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。" class="headerlink" title="9.点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。"></a>9.点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-b9b2e6898e943674.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="10-点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success"><a href="#10-点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success" class="headerlink" title="10.点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success"></a>10.点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9f13e24bff75ac92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h6 id="11-再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。"><a href="#11-再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。" class="headerlink" title="11.再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。"></a>11.再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a77eca688ec6f4b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-ebdd57bd444800b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-860256818c23d065.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<h1 id="四-java项目代码上线"><a href="#四-java项目代码上线" class="headerlink" title="四.java项目代码上线"></a>四.java项目代码上线</h1><p>1）最终目标：对JAVA项目实现CI/CD<br>2）把代码存到GitLab<br>3）使用Maven编译并打包源码<br>4）将war包部署到Tomcat</p>
<h5 id="4-1安装maven"><a href="#4-1安装maven" class="headerlink" title="4.1安装maven"></a>4.1安装maven</h5><p>请参考链接文档进行安装：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b7dfc7c357ca">https://www.jianshu.com/p/b7dfc7c357ca</a></p>
<h5 id="4-2在jenkins中调用maven"><a href="#4-2在jenkins中调用maven" class="headerlink" title="4.2在jenkins中调用maven"></a>4.2在jenkins中调用maven</h5><p>点击系统管理→全局工具配置</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-2a26fc52439e3c50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>在Maven 配置这里分别设置默认和默认全局settings提供</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-3e1f198b2869fdea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>下拉到Maven，点击“新增Maven”，Name这里自定义即可，然后把“自动安装”前面方框里的对勾取消，填写MAVEN HOME为/usr/local/maven</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-2f26eea74c828813.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>配置JDK</p>
<p>之所以要配置JDK是因为后续的Maven操作需要设置JAVA_HOME这个变量。点击“系统管理”、“全局工具配置”，下拉到JDK，点击“JDK安装”，“别名”设置为jdk，“JAVA_HOME”设置为/usr/java/jdk</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-0ff169a4ae2200d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1032/format/webp"></p>
<p>这个JAVA_HOME路径其实就是你的JDK安装路径，如果用yum安装的openjdk，则在/usr/lib/jvm/java-xxxx（这里的xxxx是jdk版本）。</p>
<h5 id="4-3用Jenkins部署JAVA项目"><a href="#4-3用Jenkins部署JAVA项目" class="headerlink" title="4.3用Jenkins部署JAVA项目"></a>4.3用Jenkins部署JAVA项目</h5><p><strong>4.3.1安装插件</strong><br>首先需要安装Maven Integration plugin 和 Deploy to container Plugin。<br>到Jenkins逐次点击系统管理、插件管理、可选插件，在右上角的“过滤”文本框里输入“integration”，会出现两个插件，选择下面的插件，点击直接安装。  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-d25622cc8af855dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-d168f836d2053ee3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>等它安装完后，用同样的方式再安装Deploy to container。</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-dc82dd84e9ef80c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>两个插件完成安装后，重启一下Jenkins服务</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># systemctl restart jenkins</span></span><br></pre></td></tr></table></figure>
<p><strong>4.3.2模拟开发建立git本地工作目录和本地仓库</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#这里的源码使用的码云上源码，你可以自行下载使用即可。</span></span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># mkdir /jeesns</span></span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># cd /jeesns/</span></span><br><span class="line">[<span class="meta">root@gitlab /jeesns</span>]<span class="meta">#</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git config --global user.name &quot;Administrator&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git config --global user.email &quot;admin@example.com&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git init</span></span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /jeesns/.git/</span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git commit -m &quot;第一次提交项目&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git remote add origin git@10.0.0.56:jeesns/jeesns.git</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure>
<p>web界面查看项目</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-f67cf86806744cf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p><strong>4.3.3新建任务</strong><br>重启完成后，再次访问Jenkins的WEB界面，点击左侧的“新建任务”，任务名称自定义（jeesns），选择“构建一个maven项目”  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-c474d7cf2b250cf7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p>
<p>点击左下角的“确定”按钮后，进入配置页，下拉到“源码管理”，点击”git”，“Repositories”填写GitLab的jeesns项目地址  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-b6bddbcbca88ad6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1180/format/webp"></p>
<p>这里需要如之前的一样将Jenkins的服务器上生成秘钥的公钥塞到gitlab的用户的sshkey下，也可以点击“添加”按钮，紧接着点击“Jenkins”进入如下页面  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-05a158b2ffa22fb3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1065/format/webp"></p>
<p>类型选择“SSH Username with private key”，username填写git，Private Key右侧小圆点点击一下，把在git客户端生成的私钥（/root/.ssh/id_rsa）粘贴到此处，最后点“添加”，返回到刚才的页面，Credentials这里选择刚刚添加的“git”  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-82ade542c9e41207.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1173/format/webp"></p>
<p>Pre Steps设置，这里可以设置切换数据库，生产中可以用于切换测试库和生产库</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-cfc6ed9b14331e9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/976/format/webp"></p>
<p>build 构建设置，这里设置源码编译的参数</p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-2e1a992b1204b0c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/980/format/webp"></p>
<p>Post Steps设置，这里在源码包编译完成后通过ansible实现代码的批量上线  </p>
<p><img src="//upload-images.jianshu.io/upload_images/19901269-6ebf859b4b554538.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/976/format/webp"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">LeafD</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://downey0115.github.io/d564cbe68145.html">https://downey0115.github.io/d564cbe68145.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://downey0115.github.io" target="_blank">LeafD</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/jenkins/">jenkins</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover9.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/downey0115/CDN/configuration/wechat.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/downey0115/CDN/configuration/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/c621463b2578.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover9.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">二进制的加减乘除法</div></div></a></div><div class="next-post pull-right"><a href="/c7ae4151bb65.html"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/downey0115/CDN/top/cover/cover1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">java多线程</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E8%87%AA%E5%8A%A8%E5%8C%96%E4%B8%8A%E7%BA%BF%E4%BB%A3%E7%A0%81%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">一.自动化上线代码基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">1.软件开发生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BB%80%E4%B9%88%E6%98%AF%E7%8E%AF%E5%A2%83%EF%BC%9F"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">2.什么是环境？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90-CI-%EF%BC%9F"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">3.什么是持续集成(CI)？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%EF%BC%9F"><span class="toc-number">1.0.0.4.</span> <span class="toc-text">4.什么是持续交付？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2%EF%BC%9F"><span class="toc-number">1.0.0.5.</span> <span class="toc-text">5.什么是持续部署？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%B2%A1%E6%9C%89%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-number">1.0.0.6.</span> <span class="toc-text">6.没有持续集成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.0.0.7.</span> <span class="toc-text">7.持续集成最佳实践</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-jenkins%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">二.jenkins基础使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E7%99%BB%E5%BD%95Jenkins-webUI%E7%95%8C%E9%9D%A2%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.0.0.0.0.1.</span> <span class="toc-text">1.登录Jenkins webUI界面创建一个项目</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E8%BE%93%E5%85%A5%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0-free-job-%E5%B9%B6%E9%80%89%E6%8B%A9%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%87%AA%E7%94%B1%E9%A3%8E%E6%A0%BC%E7%9A%84%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.0.0.0.0.2.</span> <span class="toc-text">2.输入项目名称(free-job)并选择构建一个自由风格的软件项目</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E4%B8%8A%E9%9D%A2%E5%88%9B%E5%BB%BA%E5%AE%8C%E6%88%90%E5%90%8E%E8%B7%B3%E8%BD%AC%E8%BF%9B%E6%9D%A5%E5%90%8E%E8%BF%9B%E8%A1%8C%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%80%89%E6%8B%A9%E4%B8%A2%E5%BC%83%E6%97%A7%E7%9A%84%E6%9E%84%E5%BB%BA%EF%BC%88%E4%B8%8B%E9%9D%A2%E4%BF%9D%E6%8C%81%E5%A4%A9%E6%95%B0%E4%B8%80%E8%88%AC%E5%9C%A85-7%E5%A4%A9%E5%8D%B3%E5%8F%AF%EF%BC%89"><span class="toc-number">2.0.0.0.0.3.</span> <span class="toc-text">3.上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5~7天即可）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E6%8E%A5%E7%9D%80%E4%B8%8A%E9%9D%A2%E9%80%89%E6%8B%A9%E6%9E%84%E5%BB%BA%EF%BC%8C%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9Execute-Shell-%E6%9D%A5%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4"><span class="toc-number">2.0.0.0.0.4.</span> <span class="toc-text">4.接着上面选择构建，然后选择Execute Shell 来执行shell命令</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E6%97%A2%E7%84%B6%E8%83%BD%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E4%BB%AC%E6%89%A7%E8%A1%8C%E4%B8%80%E4%B8%AApwd%EF%BC%8C%E7%9C%8B%E4%B8%8B%E9%BB%98%E8%AE%A4%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95%E5%9C%A8%E5%93%AA%E9%87%8C"><span class="toc-number">2.0.0.0.0.5.</span> <span class="toc-text">5.既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-%E4%B8%8A%E9%9D%A2%E4%BF%9D%E5%AD%98%E5%90%8E%E7%82%B9%E5%87%BB%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA%EF%BC%8C%E5%B0%B1%E4%BC%9A%E5%9C%A8%E4%B8%8B%E9%9D%A2%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AAbuild-history%EF%BC%8C%EF%BC%88%E5%87%BA%E7%8E%B0%E8%93%9D%E8%89%B2%E5%8D%B3%E8%A1%A8%E7%A4%BA%E6%AD%A3%E5%B8%B8%EF%BC%8C%E8%8B%A5%E7%BA%A2%E8%89%B2%E5%8D%B3%E8%A1%A8%E7%A4%BA%E6%9C%89%E9%97%AE%E9%A2%98"><span class="toc-number">2.0.0.0.0.6.</span> <span class="toc-text">6.上面保存后点击立即构建，就会在下面生成一个build history，（出现蓝色即表示正常，若红色即表示有问题)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%88%90%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E7%82%B9%E5%87%BBbuild-ID%E4%B8%8B%E6%8B%89%E6%A1%86%E9%80%89%E6%8B%A9Console-Output-%E6%9D%A5%E6%9F%A5%E7%9C%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-number">2.0.0.0.0.7.</span> <span class="toc-text">7.构建完成，我们可以点击build ID下拉框选择Console Output 来查看详细信息</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-%E9%80%9A%E8%BF%87%E8%BE%93%E5%87%BA%E4%BF%A1%E6%81%AF%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0Jenkins%E9%BB%98%E8%AE%A4%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95%E5%9C%A8-root-jenkins-workspace-%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0"><span class="toc-number">2.0.0.0.0.8.</span> <span class="toc-text">8.通过输出信息我们可以看到Jenkins默认的工作目录在 &#x2F;root&#x2F;.jenkins&#x2F;workspace&#x2F;(项目名称)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9-%E6%97%A2%E7%84%B6%E8%83%BD%E6%89%A7%E8%A1%8Cshell%E5%91%BD%E4%BB%A4%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E8%AF%95%E8%AF%95%EF%BC%9B%E8%BF%94%E5%9B%9E%E5%B7%A5%E4%BD%9C%E5%8F%B0%EF%BC%8C%E7%82%B9%E5%87%BB%E9%85%8D%E7%BD%AE"><span class="toc-number">2.0.0.0.0.9.</span> <span class="toc-text">9.既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAfree-txt%E6%96%87%E4%BB%B6%E5%B9%B6%E4%BF%9D%E5%AD%98"><span class="toc-number">2.0.0.0.0.10.</span> <span class="toc-text">10.创建一个free.txt文件并保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#11-%E5%90%8C%E4%B8%8A%E9%9D%A2%E4%B8%80%E6%A0%B7%EF%BC%8C%E6%88%91%E4%BB%AC%E7%82%B9%E5%87%BB%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA"><span class="toc-number">2.0.0.0.0.11.</span> <span class="toc-text">11.同上面一样，我们点击立即构建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-%E5%90%8C%E6%A0%B7%E6%9F%A5%E7%9C%8B%E6%9E%84%E5%BB%BA%E5%90%8E%E7%9A%84%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%9E%84%E5%BB%BA%E6%88%90%E5%8A%9F"><span class="toc-number">2.0.0.0.0.12.</span> <span class="toc-text">12.同样查看构建后的控制台输出，可以看到构建成功</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#13-%E6%97%A2%E7%84%B6%E6%9E%84%E5%BB%BA%E6%88%90%E5%8A%9F%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E4%BB%AC%E8%BF%9B%E5%85%A5%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E8%A1%8C%E9%AA%8C%E8%AF%81%E6%98%AF%E5%90%A6%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F"><span class="toc-number">2.0.0.0.0.13.</span> <span class="toc-text">13.既然构建成功，那么我们进入服务器进行验证是否创建成功</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-GitLab-Jenkins%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E5%8F%8A%E6%9B%B4%E6%96%B0"><span class="toc-number">3.</span> <span class="toc-text">三.GitLab+Jenkins自动化部署及更新</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1gitlab-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">3.1gitlab 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E7%99%BB%E5%BD%95gitlab%E7%82%B9%E5%87%BB%E9%A1%B9%E7%9B%AE%EF%BC%8C%E7%84%B6%E5%90%8E%E7%82%B9%E5%87%BB%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%BE%A4%E7%BB%84"><span class="toc-number">3.0.0.1.0.1.</span> <span class="toc-text">1.登录gitlab点击项目，然后点击创建一个群组</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E7%82%B9%E5%87%BB%E6%96%B0%E5%BB%BA%E7%BE%A4%E7%BB%84"><span class="toc-number">3.0.0.1.0.2.</span> <span class="toc-text">2.点击新建群组</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E8%BE%93%E5%85%A5%E6%96%B0%E5%BB%BA%E7%BE%A4%E7%BB%84%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E7%82%B9%E5%87%BB%E5%88%9B%E5%BB%BA"><span class="toc-number">3.0.0.1.0.3.</span> <span class="toc-text">3.输入新建群组的相关信息并点击创建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.0.0.1.0.4.</span> <span class="toc-text">4.新建一个项目</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AE%E7%A7%98%E9%92%A5"><span class="toc-number">3.0.0.1.0.5.</span> <span class="toc-text">5.设置秘钥</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-%E5%A1%9Ekey%E6%93%8D%E4%BD%9C%EF%BC%8C%E6%96%B9%E4%BE%BF%E6%BA%90%E7%A0%81%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD"><span class="toc-number">3.0.0.1.0.6.</span> <span class="toc-text">6.塞key操作，方便源码上传下载</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-%E7%82%B9%E5%87%BB%E5%A4%B4%E5%83%8F%E6%9F%A5%E7%9C%8B%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="toc-number">3.0.0.1.0.7.</span> <span class="toc-text">7.点击头像查看创建项目的结果</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-%E6%9F%A5%E7%9C%8B%E9%A1%B9%E7%9B%AE%E6%A0%B9%E6%8D%AE%E6%8F%90%E7%A4%BA%E9%85%8D%E7%BD%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">3.0.0.1.0.8.</span> <span class="toc-text">8.查看项目根据提示配置初始化</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9-%E6%A8%A1%E6%8B%9F%E5%BC%80%E5%8F%91%E5%BB%BA%E7%AB%8Bgit%E6%9C%AC%E5%9C%B0%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95%E5%92%8C%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93"><span class="toc-number">3.0.0.1.0.9.</span> <span class="toc-text">9.模拟开发建立git本地工作目录和本地仓库</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10-%E6%9F%A5%E7%9C%8B%E4%B8%8A%E4%BC%A0%E7%9A%84%E7%BB%93%E6%9E%9C"><span class="toc-number">3.0.0.1.1.</span> <span class="toc-text">10.查看上传的结果</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#11-%E7%82%B9%E5%87%BB%E8%AE%BE%E7%BD%AE%E9%80%89%E6%8B%A9%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">3.0.0.1.1.1.</span> <span class="toc-text">11.点击设置选择新建用户</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-%E8%BE%93%E5%85%A5%E8%B4%A6%E5%8F%B7%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E7%82%B9%E5%87%BB%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">3.0.0.1.1.2.</span> <span class="toc-text">12.输入账号相关信息并点击创建用户</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#13-%E7%82%B9%E5%87%BB%E7%BC%96%E8%BE%91%EF%BC%8C%E4%B8%BA%E4%B8%8A%E9%9D%A2%E6%96%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E7%94%A8%E6%88%B7%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="toc-number">3.0.0.1.1.3.</span> <span class="toc-text">13.点击编辑，为上面新创建的用户设置密码</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#14-%E7%BB%99%E8%BF%99%E4%B8%AA%E8%B4%A6%E5%8F%B7%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81%E5%B9%B6%E4%BF%9D%E5%AD%98"><span class="toc-number">3.0.0.1.1.4.</span> <span class="toc-text">14.给这个账号设置密码并保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#15-%E5%B0%86%E4%B8%8A%E9%9D%A2%E5%88%9B%E5%BB%BA%E7%9A%84%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E5%88%B0devops%E7%BB%84%E4%B8%AD%E5%B9%B6%E7%BB%99%E4%B8%8E%E5%BC%80%E5%8F%91%E8%80%85%E6%9D%83%E9%99%90"><span class="toc-number">3.0.0.1.1.5.</span> <span class="toc-text">15.将上面创建的用户添加到devops组中并给与开发者权限</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#16-%E6%89%BE%E5%88%B0%E5%88%9A%E5%88%9A%E5%88%9B%E5%BB%BA%E7%9A%84dev%E7%94%A8%E6%88%B7%E5%B9%B6%E7%BB%99%E4%BA%88%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E6%9D%83%E9%99%90%EF%BC%8C%E7%84%B6%E5%90%8E%E5%A2%9E%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E7%BE%A4%E7%BB%84"><span class="toc-number">3.0.0.1.1.6.</span> <span class="toc-text">16.找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2Jenkins%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.</span> <span class="toc-text">3.2Jenkins配置</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%9C%A8Jenkins%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%94%9F%E6%88%90%E7%A7%98%E9%92%A5"><span class="toc-number">3.1.0.0.0.1.</span> <span class="toc-text">1.在Jenkins的服务器上生成秘钥</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E5%9B%9E%E5%88%B0gitlab%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%9D%A2%E4%BD%BF%E7%94%A8maliu%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%EF%BC%8C%E7%84%B6%E5%90%8E%E7%82%B9%E5%87%BB%E5%A4%B4%E5%83%8F%E9%80%89%E6%8B%A9%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.1.0.0.0.2.</span> <span class="toc-text">2.回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E4%B8%8A%E9%9D%A2%E7%9A%84%E8%AE%BE%E7%BD%AE%E7%82%B9%E8%BF%9B%E6%9D%A5%E5%90%8E%EF%BC%8C%E9%80%89%E6%8B%A9SSH-%E7%A7%98%E9%92%A5%EF%BC%8C-%E7%84%B6%E5%90%8E%E5%A4%8D%E5%88%B6Jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%94%9F%E6%88%90%E7%9A%84%E7%A7%98%E9%92%A5%E7%84%B6%E5%90%8E%E7%82%B9%E5%87%BB%E5%A2%9E%E5%8A%A0%E7%A7%98%E9%92%A5"><span class="toc-number">3.1.0.0.0.3.</span> <span class="toc-text">3.上面的设置点进来后，选择SSH 秘钥， 然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E6%96%B0%E5%BB%BA%E4%BB%BB%E5%8A%A1"><span class="toc-number">3.1.0.0.0.4.</span> <span class="toc-text">4.新建任务</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E7%82%B9%E5%87%BB%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.0.0.0.5.</span> <span class="toc-text">5.点击项目名称开始配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-%E9%80%89%E6%8B%A9%E6%BA%90%E7%A0%81%E7%AE%A1%E7%90%86%EF%BC%8C%E9%80%89Git%EF%BC%8C%E8%BE%93%E5%85%A5%E4%BB%93%E5%BA%93URL%E5%9C%B0%E5%9D%80%EF%BC%88%E5%A6%82%E6%9E%9C%E4%B8%8B%E6%96%B9%E5%87%BA%E7%8E%B0%E7%BA%A2%E8%89%B2%E5%8F%8A%E8%A1%A8%E7%A4%BA%E5%87%BA%E9%94%99%E4%BA%86%EF%BC%89%EF%BC%8C%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E4%BF%9D%E5%AD%98"><span class="toc-number">3.1.0.0.0.6.</span> <span class="toc-text">6.选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA"><span class="toc-number">3.1.0.0.0.7.</span> <span class="toc-text">7.立即构建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-%E6%9F%A5%E7%9C%8B%E6%9E%84%E5%BB%BA%E4%BF%A1%E6%81%AF"><span class="toc-number">3.1.0.0.0.8.</span> <span class="toc-text">8.查看构建信息</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%9F%A5%E7%9C%8B"><span class="toc-number">3.1.0.0.0.9.</span> <span class="toc-text">9.服务端查看</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="toc-number">3.2.</span> <span class="toc-text">3.3实现自动部署</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%9C%A8Jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%9D%A2%E7%BC%96%E5%86%99%E5%90%8C%E6%AD%A5%E8%84%9A%E6%9C%AC%EF%BC%8C%E7%94%B1%E4%BA%8E%E6%98%AF%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E6%8B%B7%E8%B4%9D%E5%88%B0web%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E7%AB%99%E7%82%B9%E7%9B%AE%E5%BD%95%EF%BC%8C%E6%89%80%E4%BB%A5%E9%9C%80%E8%A6%81%E5%85%88%E5%81%9A%E4%B8%80%E4%B8%AAssh%E7%A7%98%E9%92%A5%E8%AE%A4%E8%AF%81"><span class="toc-number">3.2.0.0.0.1.</span> <span class="toc-text">1.在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AEJenkins%EF%BC%8C%E4%BD%BF%E7%94%A8Jenkins%E8%B0%83%E7%94%A8%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC%EF%BC%88%E6%AD%A4%E5%A4%84%E5%86%99%E8%84%9A%E6%9C%AC%E5%85%A8%E8%B7%AF%E5%BE%84%E8%84%9A%E6%9C%AC%E5%90%8D%E7%A7%B0%EF%BC%89"><span class="toc-number">3.2.0.0.0.2.</span> <span class="toc-text">2.配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA"><span class="toc-number">3.2.0.0.0.3.</span> <span class="toc-text">3.立即构建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E6%9F%A5%E7%9C%8B%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C"><span class="toc-number">3.2.0.0.0.4.</span> <span class="toc-text">4.查看输出结果</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AE%E7%BB%93%E6%9E%9C"><span class="toc-number">3.2.0.0.0.5.</span> <span class="toc-text">5.测试访问结果</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0"><span class="toc-number">3.3.</span> <span class="toc-text">3.4自动更新</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E8%87%AA%E5%8A%A8%E8%A7%A6%E5%8F%91%E6%9E%84%E5%BB%BA%E3%80%81%E9%9C%80%E8%A6%81%E8%AE%BE%E7%BD%AE%E5%AE%89%E5%85%A8%E4%BB%A4%E7%89%8CSecret-token%EF%BC%8C%E8%BF%9B%E5%85%A5%E9%A1%B9%E7%9B%AE%E9%80%89%E6%8B%A9%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%AE%BE%E7%BD%AE%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%EF%BC%8C%E7%84%B6%E5%90%8E%E7%94%9F%E6%88%90token%EF%BC%8C%E5%A4%8D%E5%88%B6token%EF%BC%88%E9%9C%80%E8%A6%81%E5%A1%AB%E5%86%99%E5%88%B0gitlab%E4%B8%8A%E9%9D%A2%EF%BC%89%E5%92%8CBuild-when-a-chang%E4%B8%8A%E9%9D%A2%E6%8F%90%E7%A4%BA%E7%9A%84URL%E5%9C%B0%E5%9D%80%EF%BC%88-http-10-0-0-57-8080-project-yiliao%EF%BC%89"><span class="toc-number">3.3.0.0.0.1.</span> <span class="toc-text">1.配置自动触发构建、需要设置安全令牌Secret token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build when a chang上面提示的URL地址（ http:&#x2F;&#x2F;10.0.0.57:8080&#x2F;project&#x2F;yiliao）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AEgitlab%EF%BC%8C%E6%B7%BB%E5%8A%A0token"><span class="toc-number">3.3.0.0.0.2.</span> <span class="toc-text">2.配置gitlab，添加token</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E6%B5%8B%E8%AF%95Web%E9%92%A9%E5%AD%90"><span class="toc-number">3.3.0.0.0.3.</span> <span class="toc-text">3.测试Web钩子</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E4%B8%8A%E9%9D%A2%E5%B7%B2%E7%BB%8F%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90%EF%BC%8C%E6%8E%A5%E4%B8%8B%E6%9D%A5%E5%B0%B1%E6%98%AF%E6%B5%8B%E8%AF%95%EF%BC%8C%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%E7%9B%AE%E5%89%8Dweb%E6%9C%8D%E5%8A%A1%E7%AB%99%E7%82%B9%E8%AE%BF%E9%97%AE%E5%BE%97%E5%88%B0%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8A%E9%9D%A2%EF%BC%8C-%E8%BF%99%E9%87%8Cgitlab%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E8%BD%BD%E7%9A%84%E4%BB%A3%E7%A0%81%E5%B9%B6%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%EF%BC%8C%E7%84%B6%E5%90%8E%E6%8E%A8%E9%80%81gitlab%E4%BB%93%E5%BA%93%E3%80%82%E8%BF%99%E9%87%8C%E5%8E%BB%E9%99%A4%E9%A6%96%E9%A1%B5%E7%9A%84%E5%8F%B3%E4%B8%8A%E8%A7%92%E7%9A%84English%E7%89%88%E6%9C%AC%E3%80%82"><span class="toc-number">3.3.0.0.0.4.</span> <span class="toc-text">4.上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面， 这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E6%8E%A8%E9%80%81%E6%96%B0%E7%9A%84%E4%BF%AE%E6%94%B9%E6%BA%90%E7%A0%81"><span class="toc-number">3.3.0.0.0.5.</span> <span class="toc-text">5.推送新的修改源码</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AE"><span class="toc-number">3.3.0.0.0.6.</span> <span class="toc-text">6.测试访问</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5%E9%85%8D%E7%BD%AE%E6%9E%84%E5%BB%BAJenkins%E8%BF%94%E5%9B%9E%E6%9E%84%E5%BB%BA%E7%8A%B6%E6%80%81gitlab"><span class="toc-number">3.4.</span> <span class="toc-text">3.5配置构建Jenkins返回构建状态gitlab</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E7%8E%B0%E5%9C%A8gotlab%E4%B8%8A%E9%9D%A2%E7%94%9F%E6%88%90%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8Ctoken%EF%BC%8C%E7%82%B9%E5%87%BB%E7%94%A8%E6%88%B7%E5%A4%84%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.4.0.0.0.1.</span> <span class="toc-text">1.现在gotlab上面生成访问令牌token，点击用户处的设置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C%E2%80%94%E2%80%94-gt-%E8%BE%93%E5%85%A5%E5%90%8D%E7%A7%B0%E2%80%94%E2%80%94-gt-%E9%80%89%E6%8B%A9%E8%8C%83%E5%9B%B4%E4%B8%BAapi%E2%80%94%E2%80%94-gt-%E5%88%9B%E5%BB%BA%E4%B8%AA%E4%BA%BA%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C%EF%BC%8C%E5%B0%86%E7%94%9F%E6%88%90%E7%9A%84%E4%BB%A4%E7%89%8Ctoken%E5%A4%8D%E5%88%B6"><span class="toc-number">3.4.0.0.0.2.</span> <span class="toc-text">2.访问令牌——&gt;输入名称——&gt;选择范围为api——&gt;创建个人访问令牌，将生成的令牌token复制</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E7%99%BB%E5%BD%95Jenkins%E2%80%94%E2%80%94%E2%80%94-gt-%E9%80%89%E6%8B%A9%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E2%80%94%E2%80%94-gt-%E9%80%89%E6%8B%A9%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE%E2%80%94%E2%80%94-gt-%E9%80%89%E6%8B%A9Gitlab%E2%80%94%E2%80%94-gt-%E8%BE%93%E5%85%A5%E5%90%8D%E5%AD%97%E2%80%94%E2%80%94-gt-%E8%BE%93%E5%85%A5URL%E2%80%94%E2%80%94%E2%80%94-gt-%E7%82%B9%E5%87%BBAdd"><span class="toc-number">3.4.0.0.0.3.</span> <span class="toc-text">3.登录Jenkins———&gt;选择系统管理——&gt;选择系统设置——&gt;选择Gitlab——&gt;输入名字——&gt;输入URL———&gt;点击Add</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-%E4%B8%8A%E9%9D%A2%E7%82%B9%E5%87%BBAdd%E8%BF%9B%E6%9D%A5%E5%90%8E%EF%BC%8Ckind%E5%A4%84%E9%80%89%E6%8B%A9Gitlab-API-token%EF%BC%8C%E7%B2%98%E8%B4%B4%E4%B8%8A%E9%9D%A2%E5%A4%8D%E5%88%B6%E7%9A%84token%EF%BC%8C%E8%87%AA%E5%AE%9A%E4%B9%89ID%E5%92%8C%E6%8F%8F%E8%BF%B0"><span class="toc-number">3.4.0.0.0.4.</span> <span class="toc-text">4.上面点击Add进来后，kind处选择Gitlab API token，粘贴上面复制的token，自定义ID和描述</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-%E4%B8%8A%E9%9D%A2%E6%B7%BB%E5%8A%A0%E5%90%8E%EF%BC%8C%E5%9B%9E%E5%88%B0%E8%BF%99%E9%87%8C%E9%80%89%E6%8B%A9%E5%88%9A%E5%88%9A%E7%94%9F%E6%88%90%E7%9A%84%E8%BF%99%E4%B8%AAtoken%E3%80%82%E7%84%B6%E5%90%8E%E7%82%B9%E5%87%BB%E4%BF%9D%E5%AD%98"><span class="toc-number">3.4.0.0.0.5.</span> <span class="toc-text">5.上面添加后，回到这里选择刚刚生成的这个token。然后点击保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-%E4%B8%8A%E9%9D%A2%E4%BF%9D%E5%AD%98%E5%90%8E%EF%BC%8C%E8%BF%9B%E5%85%A5%E5%88%B0%E9%A1%B9%E7%9B%AE%E9%87%8C%E9%80%89%E6%8B%A9%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%85%8D%E7%BD%AE%E6%9E%84%E5%BB%BA%E5%90%8E%E6%93%8D%E4%BD%9C%EF%BC%8C%E9%80%89%E6%8B%A9Publish-%E2%80%A6-to-%E2%80%A6Gitlab%EF%BC%8C%E9%80%89%E6%8B%A9%E5%90%8E%E7%9B%B4%E6%8E%A5%E4%BF%9D%E5%AD%98%E5%B0%B1ok"><span class="toc-number">3.4.0.0.0.6.</span> <span class="toc-text">6.上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish … to …Gitlab，选择后直接保存就ok</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-%E6%B5%8B%E8%AF%95%EF%BC%8C%E7%82%B9%E5%87%BB%E7%AB%8B%E5%8D%B3%E6%9E%84%E5%BB%BA"><span class="toc-number">3.4.0.0.0.7.</span> <span class="toc-text">7.测试，点击立即构建</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-%E5%9B%9E%E5%88%B0gitlab%E4%B8%8A%E9%9D%A2%E6%9F%A5%E7%9C%8B%EF%BC%8C%E9%82%A3%E9%87%8C%E7%94%9F%E6%88%90%E4%BA%86%E4%B8%80%E4%B8%AA%E5%AF%B9%E5%8F%B7"><span class="toc-number">3.4.0.0.0.8.</span> <span class="toc-text">8.回到gitlab上面查看，那里生成了一个对号</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9-%E7%82%B9%E5%87%BB%E5%AF%B9%E5%8F%B7%EF%BC%8C%E8%BF%9B%E6%9D%A5%E5%90%8E%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E6%B5%81%E6%B0%B4%E7%BA%BF%EF%BC%8C%E4%B8%8B%E9%9D%A2%E4%B8%80%E4%BA%9B%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%AF%94%E5%A6%82%E7%8A%B6%E6%80%81%EF%BC%8C%E6%8F%90%E4%BA%A4%E7%AD%89%E3%80%82"><span class="toc-number">3.4.0.0.0.9.</span> <span class="toc-text">9.点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10-%E7%82%B9%E5%87%BB%E4%B8%8A%E9%9D%A2Status%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%AF%B9%E5%8F%B7%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%A6%82%E4%B8%8B%E5%9B%BE%E4%B8%80%E6%A0%B7%E7%9A%84%E6%9C%89%E4%B8%AAjenkins-success"><span class="toc-number">3.4.0.0.0.10.</span> <span class="toc-text">10.点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#11-%E5%86%8D%E7%82%B9%E5%87%BBjenkins%E5%B0%B1%E8%B7%B3%E8%BD%AC%E5%88%B0jenkins%E4%B8%8A%E9%9D%A2%E5%8E%BB%E4%BA%86%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E8%BE%93%E5%87%BA%EF%BC%8C%E8%BF%98%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%88%B0%E6%89%80%E6%9C%89%E4%BB%A3%E7%A0%81%EF%BC%8C%E8%BF%94%E5%9B%9E%E7%9A%84%E8%AF%9D%E5%8F%AA%E8%83%BD%E9%80%89%E6%8B%A9%E5%90%8E%E9%80%80%E3%80%82"><span class="toc-number">3.4.0.0.0.11.</span> <span class="toc-text">11.再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B-java%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E4%B8%8A%E7%BA%BF"><span class="toc-number">4.</span> <span class="toc-text">四.java项目代码上线</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1%E5%AE%89%E8%A3%85maven"><span class="toc-number">4.0.0.0.1.</span> <span class="toc-text">4.1安装maven</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2%E5%9C%A8jenkins%E4%B8%AD%E8%B0%83%E7%94%A8maven"><span class="toc-number">4.0.0.0.2.</span> <span class="toc-text">4.2在jenkins中调用maven</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3%E7%94%A8Jenkins%E9%83%A8%E7%BD%B2JAVA%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.0.0.0.3.</span> <span class="toc-text">4.3用Jenkins部署JAVA项目</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2022 By LeafD</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: 'e541ee1aae43eee8a9b5',
      clientSecret: 'f2dae4f6eac8c3323063a2f8023cc78144261042',
      repo: 'blog-comment',
      owner: 'downey0115',
      admin: ['downey0115'],
      id: '527c885534842f28220fbe489aab7ef6',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="aplayer no-destroy" data-id="5273081683" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" data-lrctype="1" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>