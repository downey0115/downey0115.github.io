<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>关于在vim中的查找和替换</title>
      <link href="daf361161210.html"/>
      <url>daf361161210.html</url>
      
        <content type="html"><![CDATA[<h2 id="关于在vim中的查找和替换"><a href="#关于在vim中的查找和替换" class="headerlink" title="关于在vim中的查找和替换"></a>关于在vim中的查找和替换</h2><h4 id="1，查找"><a href="#1，查找" class="headerlink" title="1，查找"></a><strong>1，查找</strong></h4><p>在normal模式下按下<code>/</code>即可进入查找模式，输入要查找的字符串并按下回车。 Vim会跳转到第一个匹配。按下<code>n</code>查找下一个，按下<code>N</code>查找上一个。</p><p>Vim查找支持正则表达式，例如<code>/vim$</code>匹配行尾的<code>&quot;vim&quot;</code>。 需要查找特殊字符需要转义，例如<code>/vim$</code>匹配<code>&quot;vim$&quot;</code>。</p><h4 id="2，大小写敏感查找"><a href="#2，大小写敏感查找" class="headerlink" title="2，大小写敏感查找"></a><strong>2，大小写敏感查找</strong></h4><p>在查找模式中加入<code>c</code>表示大小写不敏感查找，<code>C</code>表示大小写敏感查找。例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;fooc</span><br></pre></td></tr></table></figure><p>将会查找所有的<code>&quot;foo&quot;</code>,<code>&quot;FOO&quot;</code>,<code>&quot;Foo&quot;</code>等字符串。</p><h4 id="3，大小写敏感配置"><a href="#3，大小写敏感配置" class="headerlink" title="3，大小写敏感配置"></a><strong>3，大小写敏感配置</strong></h4><p>Vim 默认采用大小写敏感的查找，为了方便我们常常将其配置为大小写不敏感：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot; 设置默认进行大小写不敏感查找</span><br><span class="line">set ignorecase</span><br><span class="line">&quot; 如果有一个大写字母，则切换到大小写敏感查找</span><br><span class="line">set smartcase </span><br></pre></td></tr></table></figure><blockquote><p>将上述设置粘贴到你的<code>~/.vimrc</code>，重新打开Vim即可生效</p></blockquote><h4 id="4，查找当前单词"><a href="#4，查找当前单词" class="headerlink" title="4，查找当前单词"></a><strong>4，查找当前单词</strong></h4><p>在normal模式下按下<code>*</code>即可查找光标所在单词（word）， 要求每次出现的前后为空白字符或标点符号。例如当前为<code>foo</code>， 可以匹配<code>foo bar</code>中的<code>foo</code>，但不可匹配<code>foobar</code>中的<code>foo</code>。 这在查找函数名、变量名时非常有用。</p><p>按下<code>g*</code>即可查找光标所在单词的字符序列，每次出现前后字符无要求。 即<code>foo bar</code>和<code>foobar</code>中的<code>foo</code>均可被匹配到。</p><h4 id="5，查找与替换"><a href="#5，查找与替换" class="headerlink" title="5，查找与替换"></a><strong>5，查找与替换</strong></h4><p><code>:s</code>（substitute）命令用来查找和替换字符串。语法如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:&#123;作用范围&#125;s&#x2F;&#123;目标&#125;&#x2F;&#123;替换&#125;&#x2F;&#123;替换标志&#125;</span><br></pre></td></tr></table></figure><p>例如<code>:%s/foo/bar/g</code>会在全局范围(<code>%</code>)查找<code>foo</code>并替换为<code>bar</code>，所有出现都会被替换（<code>g</code>）</p><h4 id="6，作用范围"><a href="#6，作用范围" class="headerlink" title="6，作用范围"></a><strong>6，作用范围</strong></h4><p>作用范围分为当前行、全文、选区等等。</p><p>当前行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:s&#x2F;foo&#x2F;bar&#x2F;g</span><br></pre></td></tr></table></figure><p>全文：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s&#x2F;foo&#x2F;bar&#x2F;g</span><br></pre></td></tr></table></figure><p>选区，在Visual模式下选择区域后输入<code>:</code>，Vim即可自动补全为 <code>:&#39;&lt;,&#39;&gt;</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:&#39;&lt;,&#39;&gt;s&#x2F;foo&#x2F;bar&#x2F;g</span><br></pre></td></tr></table></figure><p>2-11行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:5,12s&#x2F;foo&#x2F;bar&#x2F;g</span><br></pre></td></tr></table></figure><p>当前行<code>.</code>与接下来两行<code>+2</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:.,+2s&#x2F;foo&#x2F;bar&#x2F;g</span><br></pre></td></tr></table></figure><h2 id="替换标志"><a href="#替换标志" class="headerlink" title="替换标志"></a>替换标志</h2><p>上文中命令结尾的<code>g</code>即是替换标志之一，表示全局<code>global</code>替换（即替换目标的所有出现）。 还有很多其他有用的替换标志：</p><p>空替换标志表示只替换从光标位置开始，目标的第一次出现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s&#x2F;foo&#x2F;bar</span><br></pre></td></tr></table></figure><p><code>i</code>表示大小写不敏感查找，<code>I</code>表示大小写敏感：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:%s&#x2F;foo&#x2F;bar&#x2F;i</span><br><span class="line"># 等效于模式中的c（不敏感）或C（敏感）</span><br><span class="line">:%s&#x2F;fooc&#x2F;bar</span><br></pre></td></tr></table></figure><p><code>c</code>表示需要确认，例如全局查找<code>&quot;foo&quot;</code>替换为<code>&quot;bar&quot;</code>并且需要确认：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s&#x2F;foo&#x2F;bar&#x2F;gc</span><br></pre></td></tr></table></figure><p>回车后Vim会将光标移动到每一次<code>&quot;foo&quot;</code>出现的位置，并提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace with bar (y&#x2F;n&#x2F;a&#x2F;q&#x2F;l&#x2F;^E&#x2F;^Y)?</span><br></pre></td></tr></table></figure><p>按下<code>y</code>表示替换，<code>n</code>表示不替换，<code>a</code>表示替换所有，<code>q</code>表示退出查找模式， <code>l</code>表示替换当前位置并退出。<code>^E</code>与<code>^Y</code>是光标移动快捷键，参考： <a href="http://harttle.com/2015/11/07/vim-cursor.html">Vim中如何快速进行光标移</a></p><h2 id="大小写敏感查找"><a href="#大小写敏感查找" class="headerlink" title="大小写敏感查找"></a>大小写敏感查找</h2><p>在查找模式中加入<code>c</code>表示大小写不敏感查找，<code>C</code>表示大小写敏感查找。例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;fooc</span><br></pre></td></tr></table></figure><p>将会查找所有的<code>&quot;foo&quot;</code>,<code>&quot;FOO&quot;</code>,<code>&quot;Foo&quot;</code>等字符串。</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux开启Swap分区</title>
      <link href="b45eb2943e16.html"/>
      <url>b45eb2943e16.html</url>
      
        <content type="html"><![CDATA[<h2 id="Linux开启Swap分区"><a href="#Linux开启Swap分区" class="headerlink" title="Linux开启Swap分区"></a>Linux开启Swap分区</h2><p>场景: 华为云购买的机器，默认不会开启<code>swap</code>分区，服务器运行内存只有<code>4GB</code>，不满足使用，开启<code>swap</code>交换分区</p><h3 id="开启步骤"><a href="#开启步骤" class="headerlink" title="开启步骤"></a>开启步骤</h3><p>1、<strong>开启<code>swap</code>分区</strong><br>新建一个专门的文件用于<code>swap</code>分区</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/zero of=/data/swap bs=1024 count=400000</span><br></pre></td></tr></table></figure><p>注：此文件的大小是<code>count</code>的大小乘以<code>bs</code>大小，上面命令的大小是<code>4GB</code><br>2、<strong>通过<code>mkswap</code>命令将上面新建出的文件做成<code>swap</code>分区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap /data/swap</span><br></pre></td></tr></table></figure><p>3、<strong>查看内核参数<code>vm.swappiness</code></strong><br>若<code>vm.swappiness</code>为<code>0</code>则根据实际需要调整成<code>30</code>或者<code>60</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/vm/swappiness   </span><br><span class="line">sysctl -a | grep swappiness    </span><br><span class="line">sysctl -w vm.swappiness=60</span><br></pre></td></tr></table></figure><p>注：若想永久修改，则编辑<code>/etc/sysctl.conf</code>文件</p><p>4、<strong>启用此交换分区的交换功能</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">swapon /data/swap   </span><br><span class="line">echo &quot;/data/swap swap swap defaults    0  0&quot; &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure><p>这里有可能会有报错，如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@peiyanbing /]# swapon /data/swap </span><br><span class="line">swapon: /data/swap：不安全的权限 0644，建议使用 0600。</span><br><span class="line">swapon: /data/swap：swapon 失败: 设备或资源忙</span><br><span class="line">[root@peiyanbing /]# chmod 0600 /data/swap </span><br><span class="line">[root@peiyanbing /]# swapon /data/swap </span><br><span class="line">swapon: /data/swap：swapon 失败: 设备或资源忙</span><br><span class="line">[root@peiyanbing /]# swapon /data/swap </span><br><span class="line">swapon: /data/swap：swapon 失败: 设备或资源忙</span><br></pre></td></tr></table></figure><p>解决方法：<br><strong>尝试激活 <code>Swap</code> 文件</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@peiyanbing /]# swapoff /data/swap</span><br><span class="line">[root@peiyanbing /]# swapon /data/swap</span><br><span class="line">[root@peiyanbing /]#</span><br></pre></td></tr></table></figure><p>5、<strong>关闭<code>swap</code>分区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">swapoff /data/swap   </span><br><span class="line">swapoff -a &gt;/dev/null</span><br></pre></td></tr></table></figure><p>6、<strong>重新激活<code>swap</code>分区，没有写入系统配置文件中，系统重启后，就需要重新激活</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[bing@peiyanbing ~]$ sudo swapon /swap/swapfile</span><br><span class="line">[bing@peiyanbing ~]$ free -h</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           3.7G        2.5G        130M         88M        1.1G        928M</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br><span class="line">[bing@peiyanbing ~]$ </span><br></pre></td></tr></table></figure><p>7、<strong>如果需要一直保持这个 <code>swap</code> ，可以把它写入 <code>/etc/fstab</code> 文件</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/fstab</span><br><span class="line"><span class="meta">#</span><span class="bash">增加以下两行：</span></span><br><span class="line">(add swap space on /swap/swapfile)</span><br><span class="line">  /swap/swapfile                          /swap           swap    defaults        0       0</span><br></pre></td></tr></table></figure><p>8、<strong>关机重启确认<code>Swap</code>大小</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -m</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>butterfly主题优雅魔改系列</title>
      <link href="8a53386903ec.html"/>
      <url>8a53386903ec.html</url>
      
        <content type="html"><![CDATA[<p>为了便于各位博主了解到是否新增了魔改方案，请查看<a href="https://share.mubu.com/doc/765JBkIK8_V">更新记录页</a></p><h2 id="前置说明"><a href="#前置说明" class="headerlink" title="前置说明"></a>前置说明</h2><p>魔改亮点</p><p>🆙主题可升级：几乎不改动主题<a href="https://so.csdn.net/so/search?q=%E6%BA%90%E7%A0%81&spm=1001.2101.3001.7020">源码</a>。即便魔改，也不需要为升级主题而烦恼。</p><p>🍳简单快速：简单上手，快速修改。</p><p>🍭看我72变：多种背景随意更换。</p><p>📕优雅阅读：对卡片进行不同的透明度设置，实现更优雅的阅读。</p><p>👦个性友联：为你的好友设置不同的颜色</p><p>🎈页脚更炫酷：彩色渐变footer喜欢么？</p><p>🍟更多优点等你发现</p><p>为什么写这篇文章?</p><p>相信在这之前，大家肯定看过网上的各种魔改教程。但是这些魔改教程基本上千篇一律，都是一种方式，大量修改模板（主题源文件）。这种方式的好处就是简单快速且直接，缺点就是每次升级😏，不用我说了吧。除非你不打算在升级。</p><p>但是对于一个热爱升级的我来说，我怎么可以这样。于是乎我便写了这篇文章。按照此教程进行的魔改，大部分都是通过引入新的js文件和css文件实现的。这意味着再也不用因为升级而再次魔改而苦恼了😄。同样的缺点也还是有的，引入新文件必定导致页面加载速度下降，下降多少取决于访客网速、电脑配置及服务器的带宽。具体速度可以参考本博客。</p><p>此博客环境：Coding + Jsdeliver</p><blockquote><p>这篇文章大部分修改全部没有改动pug模板。基本都是添加css文件和js文件实现的修改。</p><p>至此（2020-06-12）只有两项（友链页、双评论）修改改动了pug模板。</p><p>至于友链页 ，可改动空间并不大，因此升级主题只需要直接将文件覆盖作者文件即可。</p><p>而双评论，只需要每次升级主题将对应文件的<code>else if</code>改为<code>if</code>即可。</p><p>相信上述两项pug模板的修改不需要刻意记录也能印在心头把？</p></blockquote><h2 id="快速预览魔改范围"><a href="#快速预览魔改范围" class="headerlink" title="快速预览魔改范围"></a>快速预览魔改范围</h2><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9hZTAxLmFsaWNkbi5jb20va2YvVTcwYTk3ZDIxMWU4MTQxZWM4YjJmOTI4YzQyMzk0NmQ1Zy5qcGc?x-oss-process=image/format,png"></p><h2 id="JS-CSS如何使用"><a href="#JS-CSS如何使用" class="headerlink" title="JS/CSS如何使用"></a>JS/CSS如何使用</h2><p>下面关于各种修改我会直接给出参考代码，你可以每做一个修改都建立一个新的css/js文件，也可以将所有的代码都复制到一个css/js文件。</p><h2 id="JS-CSS如何引用"><a href="#JS-CSS如何引用" class="headerlink" title="JS/CSS如何引用"></a>JS/CSS如何引用</h2><p>此篇文章所说的一切引用（包括css和js）都可以参考这里。</p><ol><li>打开主题配置文件（butterfly.yml）</li><li>定位搜索 inject</li><li>其中head是用来引入css的。bottom是用来引入js的。</li></ol><p>示例：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/flink.min.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/hideMobileSidebar.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注：以上方式2.3.5版本可用，其他版本请自行查找引入自定义js及css的地方。</strong></p><h3 id="引用方式说明"><a href="#引用方式说明" class="headerlink" title="引用方式说明"></a>引用方式说明</h3><p>引用方式二选一即可。</p><h3 id="以相对路径引入"><a href="#以相对路径引入" class="headerlink" title="以相对路径引入"></a>以相对路径引入</h3><ol><li><p>将写好的css文件移动到<code>\Butterfly\source\css\</code>目录下。</p><p> <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzAyL2I3ZGYxOGNjZDQzNGViZTQyMTJhMmZmMGY4MGE5MGI5LnBuZw?x-oss-process=image/format,png"></p></li><li><p>然后修改配置文件的引入方式</p><p> <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzEwLzBkODY4NGM4NDZiNDU4NDVlODQwODljNGQ0MWViMDQyLnBuZw?x-oss-process=image/format,png"></p></li></ol><h3 id="以外链的方式引入"><a href="#以外链的方式引入" class="headerlink" title="以外链的方式引入"></a>以外链的方式引入</h3><p>同样的可以将这个文件上传到cdn，如七牛云、又拍云、GitHub+Jsdeliver等。</p><p>只需要将引入地址写为你的文件外链地址即可。</p><p>例如我的jsd链接<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzAyL2I5YjhlOTBmYjhkMTdlMDk1ZDBmMjI1MWYxZWI1NGI0LnBuZw?x-oss-process=image/format,png"></p><p>注：不同版本可能设置略有不同，请仔细对照你所使用版本的文档。引入并非写个连接，而是使用html标签引入。</p><h2 id="快速“复制”"><a href="#快速“复制”" class="headerlink" title="快速“复制”"></a>快速“复制”</h2><p>不想动手，就想得到魔改后的效果。😏可以直接使用作者自用的css。</p><blockquote><p>直接使用作者自用的css可能会导致自己的布局出现错误排版，或者其他各种问题。无法解决！或者自行解决。（除非自己懂前端。）</p></blockquote><p>css</p><ol><li><p>自定义css</p><p> <code>https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/pool.min.css</code></p></li><li><p>阿里iconfont</p><p> <code>https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/iconfont.min.css</code></p></li></ol><p>js</p><ol><li><p>自定义js</p><p> <code>https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/js/pool.min.js</code></p></li></ol><p>以上三个链接<strong>引用后</strong>理论上会与我的博客效果一模一样（不包含友链、双评论）。其中：</p><ul><li><p>友情链接页面</p><p>  替换模板即可，无需在添加css（引用以上三个链接的情况下）</p></li><li><p>双评论</p><p>  修改模板，无需添加css（引用以上三个链接的情况下）</p></li></ul><h2 id="小康的蝴蝶魔改库"><a href="#小康的蝴蝶魔改库" class="headerlink" title="小康的蝴蝶魔改库"></a>小康的蝴蝶魔改库</h2><p>这个工具库主要为了方便修改js部分而编写的库，以后可能会扩充也可能是最后一个版本。</p><p>具体使用与文档参照：<a href="https://www.tzki.cn/xkTool/index.html">xkTool工具库文档</a></p><blockquote><p>使用此库后此页面所有有关js部分的代码(css代码参照此文档)均可参照文档使用对象方法调用，而无需复制粘贴冗长的代码。例如：</p><ul><li>随机背景</li><li>简单插入阿里svg</li><li>banner图滤镜效果、透明</li><li>。。。</li></ul></blockquote><h2 id="视觉体验"><a href="#视觉体验" class="headerlink" title="视觉体验"></a>视觉体验</h2><p>这部分修改主要是针对进入博客后的直观感受。</p><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>与本博客同款背景。开启需关闭背景图片设置，可能也需要关闭js动态背景。具体请自己尝试，本人没有尝试过。（_主题的background请设置<code>&#39;#efefef&#39;</code>_）</p><p><strong>背景可参照<a href="https://www.antmoe.com/posts/7198453/index.html">Hexo博客之butterfly主题优化更换背景</a>这篇文章进行魔改</strong></p><h3 id="去掉Banner图"><a href="#去掉Banner图" class="headerlink" title="去掉Banner图"></a>去掉Banner图</h3><p>效果图：</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE2LzI3YmUwZmZjOGQ3YzU1OTU0NGQxN2U1NDc3YTQ1OGY2LnBuZw?x-oss-process=image/format,png"></p><p>通过几行JS即可搞定：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> full_page = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&quot;full_page&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (full_page.length != <span class="number">0</span>) &#123;</span><br><span class="line">  full_page[<span class="number">0</span>].style.background = <span class="string">&quot;transparent&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>2020-05-17</p><p>  F 修复连同文章页也变透明的bug</p></li></ul><h3 id="鼠标样式"><a href="#鼠标样式" class="headerlink" title="鼠标样式"></a>鼠标样式</h3><p>将以下代码复制到你所创建的css文件即可。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: <span class="built_in">url</span>(https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/img/default.cur),</span><br><span class="line">        default;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: <span class="built_in">url</span>(https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/img/pointer.cur),</span><br><span class="line">        default;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>代码解读：以上代码表示当鼠标在<code>body</code>元素及<code>a</code>、<code>img</code>元素上时所显示的鼠标为url路径里的样式。</p><p>因此你可以将里边的文件替换为任意鼠标样式。</p></blockquote><h3 id="鼠标-字跟随样式"><a href="#鼠标-字跟随样式" class="headerlink" title="鼠标*字跟随样式"></a>鼠标*字跟随样式</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvSGV4b1N0YXRpY0ZpbGUyQGxhdGVzdC8yMDIwLzA1LzIwLzJjNTQwNDNjNDVkN2QwMWJlNzNlM2E0ZDkzZGRhOTYzLnBuZw?x-oss-process=image/format,png"></p><p>真实效果可以去<a href="https://www.antmoe.com/iconfont/">IconFont表</a>或者<a href="https://www.antmoe.com/frends/">友情链接</a>页面去体验。</p><p>这个修改只是一个js，当然你可以全局引入，这样就会在整个博客都有这种效果。当然也可以向我一样，只在某个文章引入。</p><ol><li><p>全局引入</p><p> 直接在配置文件处引入这个js即可。</p><p> <code>https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js</code></p></li><li><p>只在部分文章引入</p><p> 将下边内容复制到markdown即可。<strong>注意：如果你的编辑器为你转化成了代码块，请删掉代码块。因为这是一个HTML标签</strong></p> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="页脚渐变"><a href="#页脚渐变" class="headerlink" title="页脚渐变"></a>页脚渐变</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2LzFjZDc0NzRhODcxZTVlM2RmZjg2MmQ4ZTg1YzE5ZDFiLnBuZw?x-oss-process=image/format,png" alt="效果图"></p><p>同样的将以下代码复制到你所创建的css文件即可。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页脚footer */</span></span><br><span class="line"><span class="comment">/* 渐变色滚动动画 */</span></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> Gradient &#123;</span><br><span class="line">    0% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    50% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    100% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-moz-keyframes</span> Gradient &#123;</span><br><span class="line">    0% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    50% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    100% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> Gradient &#123;</span><br><span class="line">    0% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    50% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    100% &#123;</span><br><span class="line">        <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(-<span class="number">45deg</span>, #ee7752, #ce3e75, #<span class="number">23</span>a6d5, #<span class="number">23</span>d5ab);</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">400%</span> <span class="number">400%</span>;</span><br><span class="line">    <span class="attribute">-webkit-animation</span>: Gradient <span class="number">10s</span> ease infinite;</span><br><span class="line">    <span class="attribute">-moz-animation</span>: Gradient <span class="number">10s</span> ease infinite;</span><br><span class="line">    <span class="attribute">animation</span>: Gradient <span class="number">10s</span> ease infinite;</span><br><span class="line">    <span class="attribute">-o-user-select</span>: none;</span><br><span class="line">    <span class="attribute">-ms-user-select</span>: none;</span><br><span class="line">    <span class="attribute">-webkit-user-select</span>: none;</span><br><span class="line">    <span class="attribute">-moz-user-select</span>: none;</span><br><span class="line">    <span class="attribute">user-select</span>: none;</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border-top-right-radius</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#footer</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="滚动条"><a href="#滚动条" class="headerlink" title="滚动条"></a>滚动条</h3><p>将以下代码复制到你所创建的css文件即可。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2Lzc2NTk0OTg4YjUwNzgyZWIyZTRiNWQ2Mjk2OWYxZmQ5LnBuZw?x-oss-process=image/format,png"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 滚动条 */</span></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-track</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">73</span>, <span class="number">177</span>, <span class="number">245</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-thumb</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">-webkit-linear-gradient</span>(</span><br><span class="line">    <span class="number">45deg</span>,</span><br><span class="line">    rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">25%</span>,</span><br><span class="line">    transparent <span class="number">25%</span>,</span><br><span class="line">    transparent <span class="number">50%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">50%</span>,</span><br><span class="line">    <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="number">75%</span>,</span><br><span class="line">    transparent <span class="number">75%</span>,</span><br><span class="line">    transparent</span><br><span class="line">  );</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-corner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-moz-selection</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="手机侧边栏默认不展开"><a href="#手机侧边栏默认不展开" class="headerlink" title="手机侧边栏默认不展开"></a>手机侧边栏默认不展开</h3><p>这段修改需要将下边的代码复制到新建的<strong>js</strong>文件中。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzAzLzA4ZDg0NzY1Y2I2MzI1NjQyMjQxNDdmOTUzMDg3NDgyLnBuZw?x-oss-process=image/format,png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mobile_sidebar_menus = <span class="built_in">document</span>.getElementById(<span class="string">&quot;mobile-sidebar-menus&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> menus_item_child = mobile_sidebar_menus.getElementsByClassName(</span><br><span class="line">    <span class="string">&quot;menus_item_child&quot;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> menus_expand = mobile_sidebar_menus.getElementsByClassName(<span class="string">&quot;menus-expand&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; menus_item_child.length; i++) &#123;</span><br><span class="line">    menus_item_child[i].style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    menus_expand[i].className += <span class="string">&quot; menus-closed&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这里提供一个现成的地址，可以直接在引用处填写。也可以复制上边的代码到你自己的js文件中。</p><p>在线地址：<a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/[Hexo](https://so.csdn.net/so/search?q=Hexo&amp;spm=1001.2101.3001.7020)/js/hideMobileSidebar.js">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/[Hexo](https://so.csdn.net/so/search?q=Hexo&amp;spm=1001.2101.3001.7020)/js/hideMobileSidebar.js</a></p></blockquote><h3 id="分类卡片折叠"><a href="#分类卡片折叠" class="headerlink" title="分类卡片折叠"></a>分类卡片折叠</h3><p>分类卡片隐藏需要同时引入css和js文件。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2L2Q1MmEyODBlZGM1ODgxMTVmNzAxMWI1MDljOTA2M2VhLnBuZw?x-oss-process=image/format,png"></p><ol><li><p>JavaScript代码</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> card_category_list = <span class="built_in">document</span>.getElementsByClassName(</span><br><span class="line">    <span class="string">&quot;card-category-list child&quot;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> item = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&quot;card-category-list-item&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggle</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> display = t.parentElement.nextSibling.style.display;</span><br><span class="line">    <span class="keyword">if</span> (display == <span class="string">&quot;none&quot;</span>) &#123;</span><br><span class="line">        t.parentElement.nextSibling.style.display = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">        t.parentElement.nextSibling.style.height = <span class="string">&quot;100%&quot;</span>;</span><br><span class="line">        t.className = t.className.replace(<span class="string">&quot;fa-chevron-up&quot;</span>, <span class="string">&quot;fa-chevron-down&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        t.parentElement.nextSibling.style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">        t.className = t.className.replace(<span class="string">&quot;fa-chevron-down&quot;</span>, <span class="string">&quot;fa-chevron-up&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; card_category_list.length; i++) &#123;</span><br><span class="line">    card_category_list[i].style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    card_category_list[i].style.transition = <span class="string">&quot;all 1s&quot;</span>;</span><br><span class="line">    card_category_list[i].previousSibling.innerHTML +=</span><br><span class="line">        <span class="string">&#x27;&lt;i class=&quot;fa fa-chevron-up menus-expand  menus-closed&quot; aria-hidden=&quot;true&quot; style=&quot;margin-left:20px;&quot; οnclick=&quot;toggle(this)&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>CSS代码</p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#aside_content</span></span><br><span class="line"><span class="selector-class">.card-archives</span></span><br><span class="line"><span class="selector-tag">ul</span><span class="selector-class">.card-archive-list</span></span><br><span class="line">&gt; <span class="selector-class">.card-archive-list-item</span></span><br><span class="line"><span class="selector-tag">a</span></span><br><span class="line"><span class="selector-tag">span</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-id">#aside_content</span></span><br><span class="line"><span class="selector-class">.card-categories</span></span><br><span class="line"><span class="selector-tag">ul</span><span class="selector-class">.card-category-list</span></span><br><span class="line">&gt; <span class="selector-class">.card-category-list-item</span></span><br><span class="line"><span class="selector-tag">a</span></span><br><span class="line"><span class="selector-tag">span</span><span class="selector-pseudo">:first-child</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: auto;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>同样的，这个魔改也提供在线地址。</p><ul><li><p>JS</p><p><a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/hideCategory.min.js">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/hideCategory.min.js</a></p></li><li><p>CSS</p><p><a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/hideCategory.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/hideCategory.min.css</a></p></li></ul></blockquote><h3 id="文章表情不换行"><a href="#文章表情不换行" class="headerlink" title="文章表情不换行"></a>文章表情不换行</h3><p>这个是一段JS代码，我建议在你需要添加表情的文章引入这段js。如果全局引入可能会拖慢页面加载速度。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/WithoutLine.min.js&quot;</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>以上代码，直接在markdown文档最下边写即可。</p><p>注意：如果你用的markdown如果将其转为代码块，那么请删除代码块，因为这是一个脚本内容。正确写的姿势如图（typora为例）：</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE1Lzk1NWNmNTA4YmE5ZjgzYzExZTlmNDE0MDg1NzY2M2ZiLnBuZw?x-oss-process=image/format,png"></p><p>错误示例：</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE1Lzk1OTUyMmRkNTA5N2NiNWQyZmYxMjhhOTFkMmI3YjE2LnBuZw?x-oss-process=image/format,png"></p><p>部分编辑器可能将其自动转化为代码块，请各位博主注意些！</p><h3 id="阅读模式的背景与字体"><a href="#阅读模式的背景与字体" class="headerlink" title="阅读模式的背景与字体"></a>阅读模式的背景与字体</h3><p>阅读模式下会给body加一个class名，因此改起来很简单。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.read-mode</span>&#123;</span><br><span class="line">    <span class="comment">/* 字体大小 */</span></span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">17px</span>;</span><br><span class="line">    <span class="comment">/* 可以在这里引入自定义字体，具体方法请自行百度css引入字体 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.read-mode</span> <span class="selector-id">#web_bg</span>&#123;</span><br><span class="line">    <span class="comment">/* 背景颜色 */</span></span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#fdf6e3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="任意元素添加动效动画"><a href="#任意元素添加动效动画" class="headerlink" title="任意元素添加动效动画"></a>任意元素添加动效动画</h3><p>On DOM load</p><p>On hover</p><p>On parent hover</p><p> faa-wrench animated</p><p> faa-wrench animated-hover</p><p> faa-wrench</p><p> faa-ring animated</p><p> faa-ring animated-hover</p><p> faa-ring</p><p> faa-horizontal animated</p><p> faa-horizontal animated-hover</p><p> faa-horizontal</p><p> faa-vertical animated</p><p> faa-vertical animated-hover</p><p> faa-vertical</p><p> faa-flash animated</p><p> faa-flash animated-hover</p><p> faa-flash</p><p> faa-bounce animated</p><p> faa-bounce animated-hover</p><p> faa-bounce</p><p> faa-spin animated</p><p> faa-spin animated-hover</p><p> faa-spin</p><p> faa-float animated</p><p> faa-float animated-hover</p><p> faa-float</p><p> faa-pulse animated</p><p> faa-pulse animated-hover</p><p> faa-pulse</p><p> faa-shake animated</p><p> faa-shake animated-hover</p><p> faa-shake</p><p> faa-tada animated</p><p> faa-tada animated-hover</p><p> faa-tada</p><p> faa-passing animated</p><p> faa-passing animated-hover</p><p> faa-passing</p><p> faa-passing-reverse animated</p><p> faa-passing-reverse animated-hover</p><p> faa-passing-reverse</p><p> faa-burst animated</p><p> faa-burst animated-hover</p><p> faa-burst</p><p> faa-falling animated</p><p> faa-falling animated-hover</p><p> faa-falling</p><p> faa-rising animated</p><p> faa-rising animated-hover</p><p> faa-rising</p><p>理论上这些动效是可以给任意DOM元素添加的。添加方式很简单，引入一个css库：<a href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile/_HEXO@latest/butterfly/css/font-awesome-animation.min.css">https://cdn.jsdelivr.net/gh/sviptzk/StaticFile\_HEXO@latest/butterfly/css/font-awesome-animation.min.css</a></p><p>然后在DOM元素的类名添加相应的动画即可。</p><p>例如网址导航栏可以写为<code>- 网址收藏 || https://dh.xiaokang.me/ || fas fa-infinity faa-shake animated</code></p><blockquote><p>注意：如果使用<code>On parent hover</code>需要向父级元素添加class名<code>faa-parent animated-hover</code>。其余两个不需要。</p></blockquote><h3 id="MAC代码框美化"><a href="#MAC代码框美化" class="headerlink" title="MAC代码框美化"></a>MAC代码框美化</h3><p>将<code>butterfly.yml</code>的<code>highlight_theme</code>配置项改为<code>mac</code>后任意引入下方一个css即可。（也可加入到自己的css文件中）</p><ul><li><p>白色代码框</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile/_HEXO@latest/butterfly/css/macWhite.css">https://cdn.jsdelivr.net/gh/sviptzk/StaticFile\_HEXO@latest/butterfly/css/macWhite.css</a></p><p>  <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvSGV4b1N0YXRpY0ZpbGUyQGxhdGVzdC8yMDIwLzA2LzI1L2UxMzU4ZTI5ZjdiNDM1NTc0Y2QwNmZkZDI5MjNjZDI2LnBuZw?x-oss-process=image/format,png" alt="image-20200625185013423"></p></li><li><p>黑色美化版</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile/_HEXO@latest/butterfly/css/macblack.css">https://cdn.jsdelivr.net/gh/sviptzk/StaticFile\_HEXO@latest/butterfly/css/macblack.css</a></p><p>  <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvSGV4b1N0YXRpY0ZpbGUyQGxhdGVzdC8yMDIwLzA2LzI1L2E2OGFiMjM3N2I1YmFhYmQ5YTZmZmEwMjcxNWFkOTBkLnBuZw?x-oss-process=image/format,png" alt="image-20200625184949239"></p></li></ul><h2 id="页面类修改"><a href="#页面类修改" class="headerlink" title="页面类修改"></a>页面类修改</h2><p>这部分的修改主要是针对一些特殊的页面，例如友链页。</p><h3 id="友情链接页面修改"><a href="#友情链接页面修改" class="headerlink" title="友情链接页面修改"></a>友情链接页面修改</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2L2VmZmUxYzI5MTFlYWJmN2E0NWJkNWJlNjdkNDcyZDMwLnBuZw?x-oss-process=image/format,png" alt="效果图"></p><p>友情链接修改内容过大，不建议小白修改。</p><p>此修改需要<strong>替换</strong>作者文件（及<code>flink.pug</code>），位置<code>\themes\Butterfly\layout\</code></p><p><code>flink.pug</code>下载地址：<a href="https://tzk.lanzous.com/b06lwtwkb">https://tzk.lanzous.com/b06lwtwkb</a></p><p>替换完pug模板之后引入此css样式即可：<a href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile/_HEXO@latest/butterfly/css/flink.min.css">https://cdn.jsdelivr.net/gh/sviptzk/StaticFile\_HEXO@latest/butterfly/css/flink.min.css</a></p><ul><li><p>2020-0617</p><p>  适配蝴蝶3.0版本</p></li><li><p>2020-05-09</p><p>  加入一行小字效果。</p><p>  <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA5L2VmZWE1Y2IwMzE1M2U0NjM0Mjk3YTVlODc2ZTZmZTc3LnBuZw?x-oss-process=image/format,png"></p></li></ul><h4 id="字段说明"><a href="#字段说明" class="headerlink" title="字段说明"></a>字段说明</h4><p>至于如何配合使用，请自行尝试（此配置加在<code>link.yml</code>下即可）示例如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">class_test:</span></span><br><span class="line">  <span class="attr">class_name:</span> <span class="string">class名</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="string">小字描述支持html标签</span></span><br><span class="line">  <span class="attr">link_list:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">小康博客</span></span><br><span class="line">    <span class="attr">link:</span> <span class="string">https://antmoe.com</span></span><br><span class="line">    <span class="attr">avatar:</span> <span class="string">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg</span></span><br><span class="line">    <span class="attr">descr:</span> <span class="string">更多效果自行搭配</span></span><br><span class="line">    <span class="comment"># 边框大小 默认为0 </span></span><br><span class="line">    <span class="attr">width:</span> <span class="string">0px</span></span><br><span class="line">    <span class="comment"># 边框样式 默认 solid</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">solid</span></span><br><span class="line">    <span class="comment"># 边框颜色 默认淡蓝色 #49b1f5</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#0078e7&quot;</span></span><br><span class="line">    <span class="comment"># 自动旋转 可选值 flash（闪现） link_custom（单色呼吸灯） link_custom1（彩色呼吸灯）</span></span><br><span class="line">    <span class="attr">custom:</span> <span class="string">link_custom1</span></span><br><span class="line">    <span class="comment"># 动画时长设定，默认为0</span></span><br><span class="line">    <span class="attr">time:</span> <span class="string">4s</span></span><br><span class="line">    <span class="comment"># name的颜色</span></span><br><span class="line">    <span class="attr">namecolor:</span> <span class="string">&quot;#ff9191&quot;</span></span><br><span class="line">    <span class="comment"># descr的颜色</span></span><br><span class="line">    <span class="attr">descolor:</span> <span class="string">&quot;#ff9191&quot;</span></span><br><span class="line">    <span class="comment"># 背景颜色</span></span><br><span class="line">    <span class="attr">background:</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 鼠标悬停旋转角度</span></span><br><span class="line">    <span class="attr">rotate:</span> <span class="string">360deg</span></span><br><span class="line">    <span class="comment"># 自动旋转 latuo左旋转 rauto右旋转</span></span><br><span class="line">    <span class="attr">autorotate:</span> <span class="string">&quot;lauto&quot;</span></span><br><span class="line">    <span class="comment"># 旋转的周期（时长）</span></span><br><span class="line">    <span class="attr">autotime:</span> <span class="string">2s</span></span><br><span class="line">    <span class="comment">#移除此链接的权重 0为否 非0为移除</span></span><br><span class="line">    <span class="attr">remove:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="背景设置页"><a href="#背景设置页" class="headerlink" title="背景设置页"></a>背景设置页</h3><p>这个页面的初衷是为了测试不同背景下的博客效果。但可以勉强当作背景设置页。效果参考地址：<a href="https://www.antmoe.com/background/">butterfly主题背景更换</a></p><p>这个修改同样需要同时添加css与js代码。</p><ol><li><p>JavaScript代码</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取标签</span></span><br><span class="line"><span class="comment">// 全局背景div</span></span><br><span class="line"><span class="keyword">var</span> web_bg = <span class="built_in">document</span>.getElementById(<span class="string">&quot;web_bg&quot;</span>);</span><br><span class="line"><span class="comment">// 公共父级</span></span><br><span class="line"><span class="keyword">var</span> content_inner = <span class="built_in">document</span>.getElementById(<span class="string">&quot;content-inner&quot;</span>);</span><br><span class="line"><span class="comment">// 获取Cookies</span></span><br><span class="line"><span class="comment">// 透明度</span></span><br><span class="line"><span class="keyword">var</span> opacity = Cookies.get(<span class="string">&quot;opacity&quot;</span>);</span><br><span class="line"><span class="comment">// 背景</span></span><br><span class="line"><span class="keyword">var</span> bg = Cookies.get(<span class="string">&quot;bg&quot;</span>);</span><br><span class="line"><span class="comment">// 动画</span></span><br><span class="line"><span class="keyword">var</span> animation = Cookies.get(<span class="string">&quot;animation&quot;</span>);</span><br><span class="line"><span class="comment">// 背景类型</span></span><br><span class="line"><span class="keyword">var</span> type = Cookies.get(<span class="string">&quot;type&quot;</span>);</span><br><span class="line"><span class="comment">// 声明遍历 用于记录当前color</span></span><br><span class="line"><span class="comment">// 设置背景</span></span><br><span class="line"><span class="keyword">if</span> (bg) &#123;</span><br><span class="line">  web_bg.style.background = bg;</span><br><span class="line">  web_bg.setAttribute(<span class="string">&quot;data-type&quot;</span>, type);</span><br><span class="line">  <span class="keyword">if</span> (animation) &#123;</span><br><span class="line">    web_bg.style.animation = animation;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setColor</span>(<span class="params">opacity</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// style=&quot;--light_bg_color: rgb(255, 255, 255,.3);--dark_bg_color: rgba(18,18,18,.2);&quot;</span></span><br><span class="line">  <span class="keyword">var</span> light_bg_color = <span class="string">&quot;--light_bg_color: rgb(255, 255, 255,&quot;</span> + opacity + <span class="string">&quot;);&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> dark_bg_color = <span class="string">&quot;--dark_bg_color: rgba(18,18,18,&quot;</span> + opacity + <span class="string">&quot;);&quot;</span>;</span><br><span class="line">  content_inner.setAttribute(<span class="string">&quot;style&quot;</span>, light_bg_color + dark_bg_color);</span><br><span class="line">&#125;</span><br><span class="line">setColor(opacity);</span><br></pre></td></tr></table></figure></li><li><p>CSS代码</p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#aside_content</span> <span class="selector-class">.card-widget</span>,<span class="selector-id">#recent-posts</span>&gt;<span class="selector-class">.recent-post-item</span>,<span class="selector-class">.layout_page</span>&gt;<span class="selector-tag">div</span><span class="selector-pseudo">:first-child</span><span class="selector-pseudo">:not(.recent-posts)</span>,<span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#page</span>,<span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#post</span>,<span class="selector-class">.read-mode</span> <span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#post</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--light_bg_color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-id">#nav</span>,<span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.layout_page</span>&gt;<span class="selector-tag">div</span><span class="selector-pseudo">:first-child</span><span class="selector-pseudo">:not(.recent-posts)</span>,<span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.layout_post</span>&gt;<span class="selector-id">#post</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--dark_bg_color)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>将以上js与css全部引入后，新建一个页面。然后在其<code>index.md</code>中（正文部分）写入以下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span>@keyframes gradientBG&#123;0%&#123;background-position: 0% 50%;&#125;50%&#123;background-position: 100% 50%;&#125;100% &#123;background-position: 0% 50%;&#125;&#125;#rightside&#123;display:none;&#125;<span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; 这个页面是用来测试渐变背景的效果，以及不同透明度的效果。如果你有能力可以直接看 css 样式。否则请返回[<span class="string">Hexo 博客之 butterfly 主题优化更换背景</span>](<span class="link">https://www.antmoe.com/posts/7198453/index.html#附录</span>)复制代码。</span></span><br><span class="line"><span class="quote">&gt; 阅读体验及个标签样式请自己进行调整。</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 透明度调节</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">center</span> <span class="attr">style</span>=<span class="string">&#x27;margin-bottom:20px&#x27;</span> <span class="attr">id</span> = <span class="string">&#x27;opt&#x27;</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span>透明度0<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.1&quot;</span>&gt;</span></span>透明度0.1<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.2&quot;</span>&gt;</span></span>透明度0.2<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.3&quot;</span>&gt;</span></span>透明度0.3<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.4&quot;</span>&gt;</span></span>透明度0.4<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.5&quot;</span>&gt;</span></span>透明度0.5<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.6&quot;</span>&gt;</span></span>透明度0.6<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.7&quot;</span>&gt;</span></span>透明度0.7<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.8&quot;</span>&gt;</span></span>透明度0.8<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;0.9&quot;</span>&gt;</span></span>透明度0.9<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: #FFF;margin-bottom: 10px;&quot;</span>  <span class="attr">style</span>=<span class="string">&quot;color: #FFF;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button button-primary button-rounded button-small&quot;</span> <span class="attr">data-opacity</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span>透明度1<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">## 背景调节</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;demo_style&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align:center;margin:0 auto;&#x27;</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">### 渐变类</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px;background: url(<span class="symbol">&amp;quot;</span>https://ae01.alicdn.com/kf/H5662031fbf344418aa2c8bf74c68826eV.png<span class="symbol">&amp;quot;</span>),linear-gradient(45deg, #6dd0f2 15%, #f59abe 85%);text-align: center;line-height: 200px;margin-bottom:5px;cursor: pointer;&quot;</span>&gt;</span></span>粉蓝色有图片<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px;background: linear-gradient(45deg, #6dd0f2 15%, #f59abe 85%);text-align: center;line-height: 200px;cursor: pointer;&quot;</span>&gt;</span></span>粉蓝色无图片<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px;background: linear-gradient(102.7deg,#fddaff 8.2%,#dfadfc 19.6%,#adcdfc 36.8%,#adfcf4 73.2%,#caf8d0 90.9%);text-align: center;line-height: 200px;cursor: pointer;&quot;</span>&gt;</span></span>美美哒渐变<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;color&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: linear-gradient(90deg,rgba(247,149,51,.1) 0,rgba(243,112,85,.1) 15%,rgba(239,78,123,.1) 30%,rgba(161,102,171,.1) 44%,rgba(80,115,184,.1) 58%,rgba(16,152,173,.1) 72%,rgba(7,179,155,.1) 86%,rgba(109,186,130,.1) 100%);text-align: center;line-height: 200px;cursor: pointer;&quot;</span>&gt;</span></span>博主同款<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);    background-size: 400% 400%;animation: gradientBG 15s ease infinite;text-align: center;line-height: 200px;cursor: pointer;&quot;</span>&gt;</span></span>动态渐变<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: linear-gradient(to right bottom, rgb(0, 255, 240), rgb(92, 159, 247) 40%, rgb(211, 34, 255) 80%);text-align: center;line-height: 200px;cursor: pointer;&quot;</span>&gt;</span></span>紫蓝色渐变<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">### 渐变加图片类</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: linear-gradient(60deg, rgba(255, 165, 150, 0.5) 5%, rgba(0, 228, 255, 0.35)), url(https://ae01.alicdn.com/kf/H18a4b998752a4ae68b8e85d432a5aef0l.png),url(https://ae01.alicdn.com/kf/H21b5f6b8496141a1979a33666e1074d9x.jpg)0% 0% / cover;text-align: center;line-height: 200px;cursor: pointer; background-size: cover;&quot;</span>&gt;</span></span>紫蓝色渐变<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">### 图片类</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: url(https://api.abcyun.co/api/tool/bing/token/5d8f31cf6a8ab);text-align: center;line-height: 200px;cursor: pointer; background-size: cover;&quot;</span>&gt;</span></span>必应壁纸<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: url(https://api.abcyun.co/api/others/randacgimage/token/5d8f31cf6a8ab);text-align: center;line-height: 200px;cursor: pointer; background-size: cover;&quot;</span>&gt;</span></span>随机二次元图<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-type</span>=<span class="string">&quot;photo&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;bg_test&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;width: 200px;height:200px; background: url(https://api.abcyun.co/api/others/randacgblogbg/token/5d8f31cf6a8ab);text-align: center;line-height: 200px;cursor: pointer; background-size: cover;&quot;</span>&gt;</span></span>随机二次元背景图<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section">## 测试文章</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 春</span></span><br><span class="line"></span><br><span class="line">盼望着，盼望着，东风来了，春天的脚步近了。</span><br><span class="line"></span><br><span class="line">一切都像刚睡醒的样子，欣欣然张开了眼。山朗润起来了，水长起来了，太阳的脸红起来了。</span><br><span class="line"></span><br><span class="line">小草偷偷地从土里钻出来，嫩嫩的，绿绿的。园子里，田野里，瞧去，一大片一大片满是的。坐着，躺着，打两个滚，踢几脚球，赛几趟跑，捉几回迷藏。风轻悄悄的，草绵软软的。</span><br><span class="line"></span><br><span class="line">桃树、杏树、梨树，你不让我，我不让你，都开满了花赶趟儿。红的像火，粉的像霞，白的像雪。花里带着甜味，闭了眼，树上仿佛已经满是桃儿、杏儿、梨儿。花下成千成百的蜜蜂嗡嗡地闹着，大小的蝴蝶飞来飞去。野花遍地是：杂样儿，有名字的，没名字的，散在花丛里，像眼睛，像星星，还眨呀眨的。</span><br><span class="line"></span><br><span class="line">“吹面不寒杨柳风”，不错的，像母亲的手抚摸着你。风里带来些新翻的泥土的气息，混着青草味，还有各种花的香，都在微微润湿的空气里酝酿。鸟儿将窠巢安在繁花嫩叶当中，高兴起来了，呼朋引伴地卖弄清脆的喉咙，唱出宛转的曲子，与轻风流水应和着。牛背上牧童的短笛，这时候也成天在嘹亮地响。</span><br><span class="line"></span><br><span class="line">雨是最寻常的，一下就是三两天。可别恼。看，像牛毛，像花针，像细丝，密密地斜织着，人家屋顶上全笼着一层薄烟。树叶子却绿得发亮，小草也青得逼你的眼。傍晚时候，上灯了，一点点黄晕的光，烘托出一片这安静而和平的夜。乡下去，小路上，石桥边，撑起伞慢慢走着的人;还有地里工作的农夫，披着蓑，戴着笠的。他们的草屋，稀稀疏疏的在雨里静默着。</span><br><span class="line"></span><br><span class="line">天上风筝渐渐多了，地上孩子也多了。城里乡下，家家户户，老老小小，他们也赶趟儿似的，一个个都出来了。舒活舒活筋骨，抖擞抖擞精神，各做各的一份事去，“一年之计在于春”;刚起头儿，有的是工夫，有的是希望。</span><br><span class="line"></span><br><span class="line">春天像刚落地的娃娃，从头到脚都是新的，它生长着。</span><br><span class="line"></span><br><span class="line">春天像小姑娘，花枝招展的，笑着，走着。</span><br><span class="line"></span><br><span class="line">春天像健壮的青年，有铁一般的胳膊和腰脚，他领着我们上前去。</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 有序列表</span><br><span class="line"><span class="bullet">2.</span> 有序</span><br><span class="line"><span class="bullet">3.</span> 有</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> 无需列表</span><br><span class="line"><span class="bullet">-</span> 测试</span><br><span class="line"></span><br><span class="line">&#123;% note default icon %&#125;</span><br><span class="line">default</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary icon %&#125;</span><br><span class="line">primary</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success icon %&#125;</span><br><span class="line">success</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info icon %&#125;</span><br><span class="line">info</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning icon %&#125;</span><br><span class="line">warning</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger icon %&#125;</span><br><span class="line">danger</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon%&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">#### Primary Header<span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span>var article<span class="emphasis">_container=document.getElementById(&quot;demo_</span>style&quot;),opt=document.getElementById(&quot;opt&quot;);article<span class="emphasis">_container.addEventListener(&quot;click&quot;,function(e)&#123;var t=e.target;&quot;DIV&quot;===t.nodeName&amp;&amp;&quot;bg_</span>test&quot;===t.className&amp;&amp;(web<span class="emphasis">_bg.style.background=t.style.background,web_</span>bg.style.animation=t.style.animation),Cookies.set(&quot;bg&quot;,t.style.background,&#123;expires:1&#125;),Cookies.set(&quot;animation&quot;,t.style.animation,&#123;expires:1&#125;),Cookies.set(&quot;type&quot;,t.getAttribute(&quot;data-type&quot;),&#123;expires:1&#125;)&#125;),opt.addEventListener(&quot;click&quot;,function(e)&#123;var t=e.target;if(&quot;A&quot;===t.nodeName)&#123;var a=t.getAttribute(&quot;data-opacity&quot;);if(a)&#123;Cookies.set(&quot;opacity&quot;,a,&#123;expires:1&#125;);var n=&quot;--light<span class="emphasis">_bg_</span>color: rgb(255, 255, 255,&quot;+a+&quot;);&quot;,i=&quot;--dark<span class="emphasis">_bg_</span>color: rgba(18,18,18,&quot;+a+&quot;);&quot;;document.getElementById(&quot;content-inner&quot;).setAttribute(&quot;style&quot;,n+i)&#125;&#125;e.preventDefault()&#125;);<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="功能扩展"><a href="#功能扩展" class="headerlink" title="功能扩展"></a>功能扩展</h2><p>这里的修改主要是针对一些功能性的拓展，例如个性标签，轮播图等等。</p><blockquote><p>推荐：一次性引入除轮播图外的全部标签外挂。直接引用<a href="https://www.antmoe.com/">小康</a>的<code>tags.css</code>文件。</p><ol><li><code>https://unpkg.com/xiaokang-style/butterfly/css/tags.css</code></li><li><code>https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/tags.css</code></li></ol><p>上面两个链接任选其一即可。</p><blockquote><p>第一个链接更新速度快，只有10分钟缓存。也就是我发布后，你最多等10分钟即可使用最新的内容。缺点就是加载速度稍微慢一点</p><p>第二个链接更新速度稍微慢（可能一天、可能两天等）。有点是jsd加载比unpkg快一点。</p><p>二者内容一样，更具自己选择引入一个即可。无需两个全部引用，引用一个即可。</p></blockquote><p>引入<a href="https://www.antmoe.com/">小康</a>的<code>tags.css</code>文件（上面的链接）后，此部分除轮播图其余所有标签外挂均可参照<a href="https://www.antmoe.com/posts/3b43914f/index.html">小康的 butterfly 主题使用文档</a>进行语法、预览、新增样式等查看。</p><p>引入以上链接的好处：</p><ol><li><p>与作者保持更新，每次使用标签，查看文档即可。</p><p>理论上文档里的标签外挂都可以使用。</p><p>无需自己在手动添加样式使用新标签，因为我已经帮你做了。</p></li><li><p>更新</p><p>以下部分提供的代码不会在进行更新。但如果出现新的样式，会更新到<code>tags.css</code>文件中，因此强烈建议使用上面提供的链接。</p></li></ol></blockquote><h3 id="标签外挂"><a href="#标签外挂" class="headerlink" title="标签外挂"></a>标签外挂</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE2LzI0YWFjNmE3YTVhOTUyN2UzMDEwNmIxMzJkOTI5YTVhLnBuZw?x-oss-process=image/format,png" alt="Checkbox &amp; Radio"></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE2LzU3MWMyNmRlNWM4NGJhZjc0ZWUyYWJjYWE4OWQ4YWRiLnBuZw?x-oss-process=image/format,png" alt="富文本按钮"></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzE2Lzk3MTY3Y2E2ZDk0NDM2NzliZTBkMWZlN2UxN2Q4M2E4LnBuZw?x-oss-process=image/format,png" alt="Folding"></p><p>此部分修改来源于<a href="https://github.com/xaoxuu/hexo-theme-volantis/">Volantis主题</a>，扩展的标签分别为<code>Checkbox &amp; Radio</code>、<code>富文本按钮</code>、<code>Folding</code>、<code>fancybox</code>、<code>span</code>。</p><p>此项修改需要在源文件中添加新的文件，当然了并不会修改作者源文件。升级时只需要重新把这几个文件放入相应文件即可。文件下载地址：<a href="https://tzk.lanzous.com/b06m0pbmh">https://tzk.lanzous.com/b06m0pbmh</a>。</p><p>添加的位置为：主题目录下的<code>scripts</code>中的<code>tags</code>文件夹中。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvSGV4b1N0YXRpY0ZpbGUyQGxhdGVzdC8yMDIwLzA2LzIwLzkxNzhjY2VjZTA4NGZhMDJmNWFhM2Y5MmRlM2E1YTU2LnBuZw?x-oss-process=image/format,png" alt="image-20200620225011610"></p><p>接下来引入css即可：<a href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile/_HEXO@latest/butterfly/css/plugins.min.css">https://cdn.jsdelivr.net/gh/sviptzk/StaticFile\_HEXO@latest/butterfly/css/plugins.min.css</a></p><blockquote><p>也可将此css保存到你的文件中，如果你已经引用了<a href="https://www.antmoe.com/">小康</a>的pool的css文件，那么所有外挂的标签的css都无需引入。（<strong>CSS无需，不代表别的不需要。</strong>）</p></blockquote><blockquote><p>接下来就可以使用扩展标签了，具体语法可以参照<a href="https://volantis.js.org/v2/tag-plugins/">源主题文档</a>。</p><p><strong>注意：不是所有的标签都可以使用，请对应功能进行使用。</strong></p></blockquote><h3 id="自定义note（图标、颜色）"><a href="#自定义note（图标、颜色）" class="headerlink" title="自定义note（图标、颜色）"></a>自定义note（图标、颜色）</h3><p>此项修改引用的图标是阿里iconfont图标。并不适用于Font Awesome。且你所使用的图标需引入的css中存在。关于如何使用阿里iconfont请参考<a href="https://www.antmoe.com/posts/80c43671/index.html">Hexo博客之优雅使用阿里iconfont图标</a>。这里只介绍成功引入阿里图标后如何自定义note标签的图标及颜色。</p><p>需要在css中加入以下规则。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 自定义note */</span></span><br><span class="line"><span class="selector-class">.note</span><span class="selector-class">.custom</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f7f7f7</span>;</span><br><span class="line">    <span class="attribute">border-left-color</span>: <span class="number">#777</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.custom</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span>;</span><br><span class="line">    <span class="attribute">color</span>:<span class="built_in">var</span>(--icon-color,#<span class="number">333</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来便可以在md中直接使用HTML标签自定义图标了。</p><p>示例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note icon custom iconfont 图标名&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #f7f7f7;border-left-color: #777;--icon-color: red;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>default<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上代码中的<code>class</code>名中的图标名在项目中查找。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA3LzQxZjY5YmZlNmVjOGQwNWIzOTZkODg0ODFmY2Y3ODk3LnBuZw?x-oss-process=image/format,png"></p><ul><li><p><code>background</code></p><p>  表示note的背景，可以自行设置。当然渐变背景理论上也是可以的。</p></li><li><p><code>border-left-color</code></p><p>  左边框的颜色。</p></li><li><p><code>--icon-color</code></p><p>  图标颜色，默认为#333</p></li></ul><p>点击复制代码即可粘贴到图表名。例如以下代码效果。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note icon custom iconfont icon-QQ&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background:#f7f7f7;border-left-color:#777;--icon-color: red;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>QQ 图标<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>QQ 图标</p><p><em>因为每个人的项目图标不一样，因此可能会出现class名相同但图标不一样的效果。具体效果以图标项目仓库为准。</em></p><p>常用配色搭配</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/* default */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #f7f7f7;border-left-color: #777;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>default<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">/* success */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #eff8f0;border-left-color: #5cb85c;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>success<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">/* primary */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #f5f0fa;border-left-color: #6f42c1;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>primary<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">/* info */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #eef7fa;border-left-color: #428bca;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">/* warning */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #fdf8ea;border-left-color: #f0ad4e;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>warning<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">/* danger */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;note  icon custom iconfont icon-QQ2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background: #fcf1f2;border-left-color: #d9534f;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>danger<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="另一种风格的note和小tag标签"><a href="#另一种风格的note和小tag标签" class="headerlink" title="另一种风格的note和小tag标签"></a>另一种风格的note和小tag标签</h3><p>note效果展示：</p><p>绿色</p><p>红色</p><p>黄色</p><p>灰色</p><p>蓝色</p><p>小tag标签效果展示：</p><p>红色小标签 绿色小标签 蓝色小标签 黄色小标签 灰色小标签</p><p>实现起来也很简单，只是对简单的p标签进行修改，为了方便添加颜色，这里提供了以上五种配色的样式。css如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span><span class="selector-class">.inline-tag</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline;</span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">2em</span> .<span class="number">6em</span> .<span class="number">3em</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">90%</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">vertical-align</span>: baseline;</span><br><span class="line">    <span class="attribute">border-radius</span>: .<span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--Color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.red</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.red</span> &#123;</span><br><span class="line">    <span class="attribute">--Color</span>: <span class="built_in">rgb</span>(<span class="number">233</span>, <span class="number">30</span>, <span class="number">100</span>);</span><br><span class="line">    <span class="attribute">--ColorA</span>: <span class="built_in">rgba</span>(<span class="number">233</span>, <span class="number">30</span>, <span class="number">100</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.green</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.green</span> &#123;</span><br><span class="line">    <span class="attribute">--Color</span>: <span class="built_in">rgb</span>(<span class="number">139</span>, <span class="number">195</span>, <span class="number">74</span>);</span><br><span class="line">    <span class="attribute">--ColorA</span>: <span class="built_in">rgba</span>(<span class="number">139</span>, <span class="number">195</span>, <span class="number">74</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.blue</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.blue</span> &#123;</span><br><span class="line">    <span class="attribute">--Color</span>: <span class="built_in">rgb</span>(<span class="number">3</span>, <span class="number">169</span>, <span class="number">244</span>);</span><br><span class="line">    <span class="attribute">--ColorA</span>: <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">169</span>, <span class="number">244</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.yellow</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.yellow</span> &#123;</span><br><span class="line">    <span class="attribute">--Color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">193</span>, <span class="number">7</span>);</span><br><span class="line">    <span class="attribute">--ColorA</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">193</span>, <span class="number">7</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.grey</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.grey</span> &#123;</span><br><span class="line">    <span class="attribute">--Color</span>: <span class="built_in">rgb</span>(<span class="number">76</span>, <span class="number">76</span>, <span class="number">76</span>);</span><br><span class="line">    <span class="attribute">--ColorA</span>: <span class="built_in">rgba</span>(<span class="number">76</span>, <span class="number">76</span>, <span class="number">76</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.div-border</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--Color,#<span class="number">333</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">0.4rem</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--ColorA, transparent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">border-left-width</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">border-left-color</span>: <span class="built_in">var</span>(--Color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.bottom</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom-width</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">border-bottom-color</span>: <span class="built_in">var</span>(--Color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">border-right-width</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">border-right-color</span>: <span class="built_in">var</span>(--Color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.top</span> &#123;</span><br><span class="line">    <span class="attribute">border-top-width</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">border-top-color</span>: <span class="built_in">var</span>(--Color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用起来也会简单，为了兼容各种平台，不推荐tag标签的写法。因此只又html标签的写法。这样做的好处是即便复制到各大平台也不会出现奇奇怪怪的标签符号或者报错。</p><p>小标签参数说明：<code>&lt;p class=&#39;div-border [颜色|方向加粗]&#39;&gt;你的文字&lt;/p&gt;</code>写法如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/* note语法示例 */</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&#x27;div-border green&#x27;</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&#x27;div-border red&#x27;</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&#x27;div-border yellow&#x27;</span>&gt;</span>黄色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&#x27;div-border grey&#x27;</span>&gt;</span>灰色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&#x27;div-border blue&#x27;</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">/* 小tag标签语法示例 */</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;inline-tag red&quot;</span>&gt;</span>红色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;inline-tag green&quot;</span>&gt;</span>绿色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;inline-tag blue&quot;</span>&gt;</span>蓝色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;inline-tag yellow&quot;</span>&gt;</span>黄色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;inline-tag grey&quot;</span>&gt;</span>灰色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上代码的效果可以看本段开头处的效果（不写颜色默认为灰色）。当然了你也可以设置某个边框加粗。例如<code>&lt;p class=&#39;div-border green left right&#39;&gt;绿色&lt;/p&gt;</code></p><p>绿色</p><h3 id="渐变note"><a href="#渐变note" class="headerlink" title="渐变note"></a>渐变note</h3><p>效果展示</p><p>默认情况</p><p>success</p><p>error</p><p>warning</p><p>修改方式</p><p>css中添加如下样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tip</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#20a0ff</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left top,right top,from(#<span class="number">20</span>a0ff),<span class="built_in">to</span>(#<span class="number">20</span>b8ff));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left,#<span class="number">20</span>a0ff,#<span class="number">20</span>b8ff);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>,#<span class="number">20</span>a0ff,#<span class="number">20</span>b8ff);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">32</span>,<span class="number">160</span>,<span class="number">255</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">32</span>,<span class="number">160</span>,<span class="number">255</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">0</span><span class="meta">!important</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#20a0ff</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left bottom,left top,from(#<span class="number">0092</span>ff),<span class="built_in">to</span>(#<span class="number">20</span>b8ff));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom,#<span class="number">0092</span>ff,#<span class="number">20</span>b8ff);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>,#<span class="number">0092</span>ff,#<span class="number">20</span>b8ff);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f129&quot;</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">24.5px</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2.5px</span> <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2.5px</span> <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&quot;Font Awesome 5 Free&quot;</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span>,<span class="selector-class">.getit</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.well</span> <span class="selector-class">.tip</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2.5px</span> <span class="number">#f7f8f9</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2.5px</span> <span class="number">#f7f8f9</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span> <span class="selector-tag">ol</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.success</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#61be33</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left top,right top,from(#<span class="number">61</span>be33),<span class="built_in">to</span>(#<span class="number">8</span>fce44));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left,#<span class="number">61</span>be33,#<span class="number">8</span>fce44);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>,#<span class="number">61</span>be33,#<span class="number">8</span>fce44);</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#61be33</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">104</span>,<span class="number">195</span>,<span class="number">59</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">104</span>,<span class="number">195</span>,<span class="number">59</span>,.<span class="number">5</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.success</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left bottom,left top,from(#<span class="number">52</span>bb1d),<span class="built_in">to</span>(#<span class="number">95</span>d34b));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom,#<span class="number">52</span>bb1d,#<span class="number">95</span>d34b);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>,#<span class="number">52</span>bb1d,#<span class="number">95</span>d34b);</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f00c&quot;</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#61be33</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.warning</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ff953f</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left top,right top,from(#ff953f),<span class="built_in">to</span>(#ffb449));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left,#ff953f,#ffb449);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>,#ff953f,#ffb449);</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#ff953f</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">154</span>,<span class="number">73</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">154</span>,<span class="number">73</span>,.<span class="number">5</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.warning</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left bottom,left top,from(#ff8f35),<span class="built_in">to</span>(#ffc149));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom,#ff8f35,#ffc149);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>,#ff8f35,#ffc149);</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f12a&quot;</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#ff953f</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.error</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ff4949</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left top,right top,from(#ff4949),<span class="built_in">to</span>(#ff7849));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left,#ff4949,#ff7849);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>,#ff4949,#ff7849);</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#ff4949</span>;</span><br><span class="line">    <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">73</span>,<span class="number">73</span>,.<span class="number">5</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">73</span>,<span class="number">73</span>,.<span class="number">5</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tip</span><span class="selector-class">.error</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-gradient</span>(linear,left bottom,left top,from(#ff3838),<span class="built_in">to</span>(#ff7849));</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom,#ff3838,#ff7849);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>,#ff3838,#ff7849);</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\f00d&quot;</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="number">0</span> -<span class="number">1px</span> <span class="number">#ff4949</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*夜间适配*/</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tip</span> &#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">0.7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* snote夜间模式 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tip</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#4c4948</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用方式</p><p>因为标签外挂的语法会导致复制到其他平台不便利，因此建议使用HTML写法。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;tip&#x27;</span> &gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>默认情况<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;tip success&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>success<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;tip error&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>error<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;tip warning&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>warning<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="volantis主题的note标签"><a href="#volantis主题的note标签" class="headerlink" title="volantis主题的note标签"></a>volantis主题的note标签</h3><blockquote><p>因为标签外挂的语法会导致复制到其他平台不便利，因此只提供HTML写法。</p></blockquote><p>效果展示</p><p>默认red</p><p>quote</p><p>info</p><p>done</p><p>success</p><p>danger</p><p>error</p><p>radiation</p><p>bug</p><p>idea-yellow</p><p>link- blue</p><p>paperclip</p><p>todo</p><p>msg cyan</p><p>guide</p><p>download</p><p>up</p><p>undo</p><p>小标题</p><p>这是个引用</p><p>修改方式</p><p>css中添加如下样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* snote夜间模式 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.snote</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#4c4948</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.snote</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">0.7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.tabs</span> <span class="selector-tag">div</span><span class="selector-class">.snote</span>&#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.5rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* TAG 小标签 */</span></span><br><span class="line"><span class="selector-class">.snote</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">border</span>: initial;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f9f9f9</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: initial;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">ul</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">ol</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">table</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">pre</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">blockquote</span><span class="selector-pseudo">:first-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">img</span><span class="selector-pseudo">:first-child</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">p</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">ul</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">ol</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">table</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">pre</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">blockquote</span><span class="selector-pseudo">:last-child</span>,</span><br><span class="line"><span class="selector-class">.snote</span> <span class="selector-tag">img</span><span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-pseudo">:not(.no-icon)</span> &#123;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">45px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">13px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: larger;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;Font Awesome 5 Free&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f7f7f7</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#777</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.default</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f0a9&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f5f0fa</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.primary</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f055&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eef7fa</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#428bca</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#428bca</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.info</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f05a&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#428bca</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eff8f0</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#5cb85c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#5cb85c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.success</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f058&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#5cb85c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdf8ea</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#f0ad4e</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#f0ad4e</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.warning</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f06a&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#f0ad4e</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fcf1f2</span>;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#d9534f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#d9534f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.snote</span><span class="selector-class">.danger</span><span class="selector-pseudo">:not(.no-icon)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f056&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#d9534f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0.6rem</span> <span class="number">16px</span> <span class="number">0.5rem</span> <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="built_in">calc</span>(<span class="number">16px</span> + <span class="number">16px</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">4px</span> solid <span class="number">#767676</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">h2</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">h4</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">h5</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">h6</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: initial;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">p</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">ul</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">ol</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">blockquote</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.5rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">24px</span> * <span class="number">0.5</span>);</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;Font Awesome 5 Free&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#767676</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f054&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f054&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.quote</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e8f4fd</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.quote</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f10d&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.info</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e8f4fd</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.info</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f129&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.success</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.done</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ebf9ed</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#3dc550</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.success</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.done</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#3dc550</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f00c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff8e9</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#ffbd2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.warning</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffbd2b</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f12a&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.danger</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.error</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#feefee</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#fe5f58</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.danger</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.error</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fe5f58</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f00d&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.radiation</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f7b9&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.bug</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f188&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.idea</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f0eb&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.link</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f0c1&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.paperclip</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f0c6&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.todo</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f0ae&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.message</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f4ad&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.guide</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f277&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.download</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f019&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.up</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f102&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.undo</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f2ea&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.play</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\f144&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.clear</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: none;</span><br><span class="line">  <span class="attribute">border-color</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.light</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#aaa</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.light</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#aaa</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.gray</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#767676</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.gray</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#767676</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.red</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#feefee</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#fe5f58</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.red</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fe5f58</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.yellow</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff8e9</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#ffbd2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.yellow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffbd2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.green</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ebf9ed</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#3dc550</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.green</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#3dc550</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.cyan</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e8fafe</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#1bcdfc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.cyan</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#1bcdfc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.blue</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#e8f4fd</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.snote</span><span class="selector-class">.blue</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="主题自带隐藏按钮"><a href="#主题自带隐藏按钮" class="headerlink" title="主题自带隐藏按钮"></a>主题自带隐藏按钮</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2L2VmNGY0M2I0MGM1NTE5MDI3NTJhN2JkMjBlODIxZTU1LnBuZw?x-oss-process=image/format,png"></p><p>主题自带的隐藏按钮点击后消失，则不可以再次隐藏。修改方法很简单，一段css代码即可。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.hide-block</span>&gt;<span class="selector-tag">a</span><span class="selector-class">.hide-button</span><span class="selector-class">.open</span>, <span class="selector-class">.hide-inline</span>&gt;<span class="selector-tag">a</span><span class="selector-class">.hide-button</span><span class="selector-class">.open</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="轮播图"><a href="#轮播图" class="headerlink" title="轮播图"></a>轮播图</h3><p>轮播图的修改来源于网络（jq）的一个插件。此项修改引入js文件即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Slider</span>(<span class="params">option</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.wrap = option.wrap;</span><br><span class="line">    <span class="built_in">this</span>.imgList = option.imgList;</span><br><span class="line">    <span class="built_in">this</span>.imgNum = <span class="built_in">this</span>.imgList.length;</span><br><span class="line">    <span class="built_in">this</span>.width = option.width || $(<span class="built_in">this</span>.wrap).width();</span><br><span class="line">    <span class="built_in">this</span>.height = option.height || $(<span class="built_in">this</span>.wrap).height();</span><br><span class="line">    <span class="built_in">this</span>.isAuto = option.isAuto || <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">this</span>.moveTime = option.moveTime;</span><br><span class="line">    <span class="built_in">this</span>.direction = option.direction || <span class="string">&quot;right&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.btnWidth = option.btnWidth;</span><br><span class="line">    <span class="built_in">this</span>.btnHeight = option.btnHeight;</span><br><span class="line">    <span class="built_in">this</span>.spanWidth = option.spanWidth;</span><br><span class="line">    <span class="built_in">this</span>.spanHeight = option.spanHeight;</span><br><span class="line">    <span class="built_in">this</span>.spanColor = option.spanColor;</span><br><span class="line">    <span class="built_in">this</span>.activeSpanColor = option.activeSpanColor;</span><br><span class="line">    <span class="built_in">this</span>.btnBackgroundColor = option.btnBackgroundColor;</span><br><span class="line">    <span class="built_in">this</span>.spanRadius = option.spanRadius;</span><br><span class="line">    <span class="built_in">this</span>.spanMargin = option.spanMargin;</span><br><span class="line">    <span class="built_in">this</span>.flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">this</span>.nowIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">this</span>.createDom();</span><br><span class="line">    <span class="built_in">this</span>.initStyle();</span><br><span class="line">    <span class="built_in">this</span>.bindEvent();</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.isAuto === <span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.autoMove();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Slider.prototype.createDom = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oUl = $(<span class="string">&#x27;&lt;ul class=&quot;imgList&quot;&gt;&lt;/ul&gt;&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> Spot = $(<span class="string">&#x27;&lt;div class=&quot;spot&quot;&gt;&lt;/div&gt;&#x27;</span>);</span><br><span class="line">    <span class="built_in">this</span>.imgList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> oLi =</span><br><span class="line">        <span class="string">&#x27;&lt;li&gt;&lt;a  href=&quot; &#x27;</span> +</span><br><span class="line">        item.a +</span><br><span class="line">        <span class="string">&#x27;target=&quot;_blank&quot; &quot;&gt;&lt;img src=&quot; &#x27;</span> +</span><br><span class="line">        item.img +</span><br><span class="line">        <span class="string">&#x27; &quot;&gt;&lt;/a&gt;&lt;/li&gt;&#x27;</span>;</span><br><span class="line">      oUl.append(oLi);</span><br><span class="line">      <span class="keyword">var</span> span = <span class="string">&quot;&lt;span&gt;&lt;/span&gt;&quot;</span>;</span><br><span class="line">      Spot.append(span);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> leftBtn = $(</span><br><span class="line">      <span class="string">&#x27;&lt;div class=&quot;left-btn&quot;&gt;&lt;i class=&quot;fas fa-angle-left&quot;&gt;&lt;/i&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">var</span> rightBtn = $(</span><br><span class="line">      <span class="string">&#x27;&lt;div class=&quot;right-btn&quot;&gt;&lt;i class=&quot;fas fa-angle-right&quot;&gt;&lt;/i&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">this</span>.wrap.append(oUl).append(leftBtn).append(rightBtn).append(Spot);</span><br><span class="line">  &#125;;</span><br><span class="line">  Slider.prototype.initStyle = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">&quot;*&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123; <span class="attr">margin</span>: <span class="number">0</span>, <span class="attr">padding</span>: <span class="number">0</span>, <span class="attr">listStyle</span>: <span class="string">&quot;none&quot;</span> &#125;);</span><br><span class="line">    $(<span class="built_in">this</span>.wrap).css(&#123; <span class="attr">overflow</span>: <span class="string">&quot;hidden&quot;</span>, <span class="attr">position</span>: <span class="string">&quot;relative&quot;</span> &#125;);</span><br><span class="line">    $(<span class="string">&quot;.imgList&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123;</span><br><span class="line">      width: <span class="built_in">this</span>.width,</span><br><span class="line">      height: <span class="built_in">this</span>.height,</span><br><span class="line">      position: <span class="string">&quot;relative&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.imgList li&quot;</span>, <span class="built_in">this</span>.wrap)</span><br><span class="line">      .css(&#123;</span><br><span class="line">        width: <span class="built_in">this</span>.width,</span><br><span class="line">        height: <span class="built_in">this</span>.height,</span><br><span class="line">        position: <span class="string">&quot;absolute&quot;</span>,</span><br><span class="line">        left: <span class="number">0</span>,</span><br><span class="line">        top: <span class="number">0</span>,</span><br><span class="line">        display: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">      .eq(<span class="built_in">this</span>.nowIndex)</span><br><span class="line">      .css(&#123; <span class="attr">display</span>: <span class="string">&quot;block&quot;</span> &#125;);</span><br><span class="line">    $(<span class="string">&quot;.imgList li a, .imgList li a img&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123;</span><br><span class="line">      display: <span class="string">&quot;inline-block&quot;</span>,</span><br><span class="line">      width: <span class="built_in">this</span>.width,</span><br><span class="line">      height: <span class="built_in">this</span>.height,</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.left-btn, .right-btn&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123;</span><br><span class="line">      width: <span class="built_in">this</span>.btnWidth,</span><br><span class="line">      height: <span class="built_in">this</span>.btnHeight,</span><br><span class="line">      backgroundColor: <span class="built_in">this</span>.btnBackgroundColor,</span><br><span class="line">      color: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">      textAlign: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">      lineHeight: <span class="built_in">this</span>.btnHeight + <span class="string">&quot;px&quot;</span>,</span><br><span class="line">      position: <span class="string">&quot;absolute&quot;</span>,</span><br><span class="line">      top: <span class="string">&quot;50%&quot;</span>,</span><br><span class="line">      marginTop: -<span class="built_in">this</span>.btnHeight / <span class="number">2</span>,</span><br><span class="line">      cursor: <span class="string">&quot;pointer&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.right-btn&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123; <span class="attr">right</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    $(<span class="string">&quot;.spot&quot;</span>, <span class="built_in">this</span>.wrap).css(&#123;</span><br><span class="line">      height: <span class="built_in">this</span>.spanHeight + <span class="built_in">this</span>.spanMargin * <span class="number">2</span>,</span><br><span class="line">      position: <span class="string">&quot;absolute&quot;</span>,</span><br><span class="line">      left: <span class="string">&quot;50%&quot;</span>,</span><br><span class="line">      marginLeft: (-<span class="built_in">this</span>.imgNum * (<span class="built_in">this</span>.spanWidth + <span class="built_in">this</span>.spanMargin * <span class="number">2</span>)) / <span class="number">2</span>,</span><br><span class="line">      bottom: <span class="number">10</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.spot span&quot;</span>, <span class="built_in">this</span>.wrap)</span><br><span class="line">      .css(&#123;</span><br><span class="line">        display: <span class="string">&quot;inline-block&quot;</span>,</span><br><span class="line">        width: <span class="built_in">this</span>.spanWidth,</span><br><span class="line">        height: <span class="built_in">this</span>.spanHeight,</span><br><span class="line">        margin: <span class="built_in">this</span>.spanMargin,</span><br><span class="line">        backgroundColor: <span class="built_in">this</span>.spanColor,</span><br><span class="line">        borderRadius: <span class="built_in">this</span>.spanRadius,</span><br><span class="line">        cursor: <span class="string">&quot;pointer&quot;</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">      .eq(<span class="built_in">this</span>.nowIndex)</span><br><span class="line">      .css(&#123; <span class="attr">backgroundColor</span>: <span class="built_in">this</span>.activeSpanColor &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  Slider.prototype.bindEvent = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">    $(<span class="string">&quot;.left-btn&quot;</span>, <span class="built_in">this</span>.wrap).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      self.move(<span class="string">&quot;prev&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.right-btn&quot;</span>, <span class="built_in">this</span>.wrap).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      self.move(<span class="string">&quot;next&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.spot span&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      self.move($(<span class="built_in">this</span>).index());</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="built_in">this</span>.wrap).mouseenter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(self.time);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  Slider.prototype.move = <span class="function"><span class="keyword">function</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.flag) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.flag = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;prev&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.nowIndex === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="built_in">this</span>.nowIndex = <span class="built_in">this</span>.imgNum - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.nowIndex--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;next&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.nowIndex === <span class="built_in">this</span>.imgNum - <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="built_in">this</span>.nowIndex = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.nowIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">this</span>.nowIndex = dir;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">    $(<span class="string">&quot;.imgList li&quot;</span>, <span class="built_in">this</span>.wrap)</span><br><span class="line">      .fadeOut()</span><br><span class="line">      .eq(<span class="built_in">this</span>.nowIndex)</span><br><span class="line">      .fadeIn(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        self.flag = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    $(<span class="string">&quot;.spot  span&quot;</span>, <span class="built_in">this</span>.wrap)</span><br><span class="line">      .css(&#123; <span class="attr">backgroundColor</span>: <span class="built_in">this</span>.spanColor &#125;)</span><br><span class="line">      .eq(<span class="built_in">this</span>.nowIndex % <span class="built_in">this</span>.imgNum)</span><br><span class="line">      .css(&#123; <span class="attr">backgroundColor</span>: <span class="built_in">this</span>.activeSpanColor &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  Slider.prototype.autoMove = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">    <span class="built_in">this</span>.time = <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.direction == <span class="string">&quot;left&quot;</span>) &#123;</span><br><span class="line">        $(<span class="string">&quot;.left-btn&quot;</span>, <span class="built_in">this</span>.wrap).trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $(<span class="string">&quot;.right-btn&quot;</span>, <span class="built_in">this</span>.wrap).trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, self.moveTime);</span><br><span class="line">  &#125;;</span><br><span class="line">  $.fn.extend(&#123;</span><br><span class="line">    slider: <span class="function"><span class="keyword">function</span> (<span class="params">option</span>) </span>&#123;</span><br><span class="line">      option.wrap = <span class="built_in">this</span>;</span><br><span class="line">      <span class="keyword">new</span> Slider(option);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>使用也很简单，只要在md文章中写入以下内容即可</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="code">    function tt()&#123;</span></span><br><span class="line"><span class="code">        $(&#x27;.demo&#x27;).slider(&#123;</span></span><br><span class="line"><span class="code">    imgList: [</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            img: &#x27;https://cdn.jsdelivr.net/gh/blogimg/picbed@latest/2020/04/13/2a877ea5da1292c817cbc2a254c01c31.png&#x27;,</span></span><br><span class="line"><span class="code">            a: &#x27;跳转url地址&#x27;,</span></span><br><span class="line"><span class="code">        &#125;,</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            img: &#x27;https://cdn.jsdelivr.net/gh/blogimg/picbed@latest/2020/04/13/5005109d1aa2ffd28984c2b02b8cbfbe.png&#x27;,</span></span><br><span class="line"><span class="code">            a: &#x27;跳转url地址&#x27;,</span></span><br><span class="line"><span class="code">        &#125;,</span></span><br><span class="line"><span class="code">        &#123;</span></span><br><span class="line"><span class="code">            img: &#x27;https://cdn.jsdelivr.net/gh/blogimg/picbed@latest/2020/04/13/163a2ade4361d1ed705ed523091af67e.png&#x27;,</span></span><br><span class="line"><span class="code">            a: &#x27;跳转url地址&#x27;,</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    ], //图片的列表，a属性里面存放的是网络地址，img存放的是图片地址</span></span><br><span class="line"><span class="code">    width: &quot;100%&quot;, //图片的宽</span></span><br><span class="line"><span class="code">    height: 500, //图片的高</span></span><br><span class="line"><span class="code">    isAuto: false, //是否自动轮播</span></span><br><span class="line"><span class="code">    moveTime: 3000, //运动时间</span></span><br><span class="line"><span class="code">    direction: &#x27;right&#x27;, //轮播的方向</span></span><br><span class="line"><span class="code">    btnWidth: 30, //按钮的宽</span></span><br><span class="line"><span class="code">    btnHeight: 30, //按钮的高</span></span><br><span class="line"><span class="code">    spanWidth: 10, //span按钮的宽</span></span><br><span class="line"><span class="code">    spanHeight: 10, //span按钮的高</span></span><br><span class="line"><span class="code">    spanColor: &#x27;#fff&#x27;, //span按钮的颜色</span></span><br><span class="line"><span class="code">    activeSpanColor: &#x27;red&#x27;, //选中的span颜色</span></span><br><span class="line"><span class="code">    btnBackgroundColor: &#x27;rgba(0, 0, 0, 0.3)&#x27;, //两侧按钮的颜色</span></span><br><span class="line"><span class="code">    spanRadius: &#x27;50%&#x27;, //span按钮的圆角程度</span></span><br><span class="line"><span class="code">    spanMargin: 3, //span之间的距离</span></span><br><span class="line"><span class="code">&#125;)</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">    window.addEventListener(&#x27;DOMContentLoaded&#x27;,tt)</span></span><br><span class="line"><span class="code">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>代码解读：<code>&lt;div class=&quot;demo&quot;&gt;&lt;/div&gt;</code>用于下边JS代码定位元素用。如果改变class名，下边的JS选择器也需要做出对应的改变。</p><p>下边的Javascript代码用于生成轮播图。各项配置看注释即可。</p></blockquote><h3 id="特殊按钮"><a href="#特殊按钮" class="headerlink" title="特殊按钮"></a>特殊按钮</h3><p>只需要引入一个css即可解决。由于css过长，因此只给出一个在线链接，你可以将其下载放到自己的空间里，也可以直接引用。</p><p>地址：<a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/buttons.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/buttons.min.css</a></p><p>样式及使用请参考<a href="https://www.antmoe.com/posts/58a62380/index.html">https://www.antmoe.com/posts/58a62380/index.html</a></p><h3 id="使用阿里Iconfont图标"><a href="#使用阿里Iconfont图标" class="headerlink" title="使用阿里Iconfont图标"></a>使用阿里Iconfont图标</h3><p>参考<a href="https://www.antmoe.com/posts/80c43671/index.html">Hexo博客之优雅使用阿里iconfont图标</a></p><h2 id="评论类修改"><a href="#评论类修改" class="headerlink" title="评论类修改"></a>评论类修改</h2><p>此项修改主要是针对valine评论以及双评论。</p><h3 id="valine评论小标签"><a href="#valine评论小标签" class="headerlink" title="valine评论小标签"></a>valine评论小标签</h3><p>这里valine的修改主要是一些小标签（访客，博主等。）</p><p>可以参照：<a href="https://blog.hclonely.com/posts/409d3090/#%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE%E5%8F%8A%E5%9B%BE%E6%A0%87">HCLonely Blog的修改教程</a></p><h3 id="双评论支持"><a href="#双评论支持" class="headerlink" title="双评论支持"></a>双评论支持</h3><p>3.0主题已经集成双评论。建议更新主题以开启双评论！</p><p>双评论支持也是源于<a href="https://blog.hclonely.com/posts/57bd67ce/#%E5%8F%8C%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F">HCLonely Blog的修改教程</a>,但是他的教程需要改动三个pug模板，因此这种做法对于升级主题来说成本还是有点高的。因此我的解决方案最大限度的减少了更改pug模板的成本。但还是需要改动pug模板的。</p><ol><li><p>修改pug模板</p><p> 位置：<code>\themes\Butterfly\layout\includes\comments\index.pug</code></p><p> 修改内容：将所有的 else if 改为 if。</p><p> <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvcGljYmVkQGxhdGVzdC8yMDIwLzA1LzA2LzRkNmVkMDY5NjA3NDcwZTMyYjVlN2U1NDgyYmI4NmRlLnBuZw?x-oss-process=image/format,png"></p></li><li><p>添加JS代码</p><p> 将以下代码复制到你自己创建的JS文件中。</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">switchComment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> t =</span><br><span class="line">      <span class="string">&quot;切换为Gitalk&quot;</span> === $(<span class="string">&quot;#switch-comment&quot;</span>).attr(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">        ? <span class="string">&quot;切换为Valine&quot;</span></span><br><span class="line">        : <span class="string">&quot;切换为Gitalk&quot;</span>,</span><br><span class="line">    o = $(<span class="string">&quot;#switch-comment&gt;i&quot;</span>);</span><br><span class="line">  <span class="string">&quot;none&quot;</span> === $(<span class="string">&quot;#gitalk-container&quot;</span>).css(<span class="string">&quot;display&quot;</span>)</span><br><span class="line">    ? $(<span class="string">&quot;#vcomment&quot;</span>).slideUp(<span class="string">&quot;normal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        $(<span class="string">&quot;#gitalk-container&quot;</span>).slideDown(<span class="string">&quot;normal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          $(<span class="string">&quot;#switch-comment&quot;</span>).attr(<span class="string">&quot;title&quot;</span>, t),</span><br><span class="line">            o.hasClass(<span class="string">&quot;fa-toggle-off&quot;</span>)</span><br><span class="line">              ? o.removeClass(<span class="string">&quot;fa-toggle-off&quot;</span>).addClass(<span class="string">&quot;fa-toggle-on&quot;</span>)</span><br><span class="line">              : o.removeClass(<span class="string">&quot;fa-toggle-on&quot;</span>).addClass(<span class="string">&quot;fa-toggle-off&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;)</span><br><span class="line">    : $(<span class="string">&quot;#gitalk-container&quot;</span>).slideUp(<span class="string">&quot;normal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        $(<span class="string">&quot;#vcomment&quot;</span>).slideDown(<span class="string">&quot;normal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          $(<span class="string">&quot;#switch-comment&quot;</span>).attr(<span class="string">&quot;title&quot;</span>, t),</span><br><span class="line">            o.hasClass(<span class="string">&quot;fa-toggle-off&quot;</span>)</span><br><span class="line">              ? o.removeClass(<span class="string">&quot;fa-toggle-off&quot;</span>).addClass(<span class="string">&quot;fa-toggle-on&quot;</span>)</span><br><span class="line">              : o.removeClass(<span class="string">&quot;fa-toggle-on&quot;</span>).addClass(<span class="string">&quot;fa-toggle-off&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> commentElement = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&quot;comment_headling&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span> (commentElement != <span class="literal">undefined</span>) &#123;</span><br><span class="line">  commentElement.innerHTML +=</span><br><span class="line">    <span class="string">&#x27;&lt;a id=&quot;switch-comment&quot; href=&quot;javascript:void(0);&quot; title=&quot;切换为Gitalk&quot; target=&quot;_self&quot;&gt;&lt;i class=&quot;fa fas fa-toggle-off&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;/a&gt;&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;gitalk-container&quot;</span>).style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$(<span class="string">&quot;#switch-comment&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> switchComment(), !<span class="number">1</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>这个js脚本也提供现成的链接，<a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/switch.min.js">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/switch.min.js</a></p></blockquote><p>至此即可完成双评论的修改，只修改<code>else if</code>为<code>if</code>是不是比修改三处pug模板简单多了。<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2Jsb2dpbWcvZW1vdGlvbi9iaWxpYmlsaS9mYWNlXyVFNSU5MCU4MyVFNyU5MyU5Qy5wbmc?x-oss-process=image/format,png" alt="吃瓜-小康博客"></p><h3 id="Valine评论添加表情"><a href="#Valine评论添加表情" class="headerlink" title="Valine评论添加表情"></a>Valine评论添加表情</h3><p>参考<a href="https://www.antmoe.com/posts/284f2e1c/index.html">Valine如何添加多个表情</a></p><h3 id="Valien评论QQ、微信提醒"><a href="#Valien评论QQ、微信提醒" class="headerlink" title="Valien评论QQ、微信提醒"></a>Valien评论QQ、微信提醒</h3><p>两份方案任选其一即可。</p><p><a href="https://www.antmoe.com/posts/2380732b/index.html">Hexo博客valine评论微信、qq提醒</a>与<a href="https://blog.hclonely.com/posts/409d3090/#%E8%AF%84%E8%AE%BA%E5%BE%AE%E4%BF%A1%E9%80%9A%E7%9F%A5%E5%8F%8Aqq%E9%80%9A%E7%9F%A5">评论微信通知及qq通知</a></p><h2 id="在线css提供"><a href="#在线css提供" class="headerlink" title="在线css提供"></a>在线css提供</h2><p>以下链接不完整，更多链接请到我的<a href="https://github.com/sviptzk/HexoStaticFile">仓库</a>自行寻觅！</p><ul><li><p>背景、滚动条、鼠标三合一</p><p>  背景颜色及鼠标不单独提供，如需单独启动，请自行创建css并引用</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/custom.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/custom.min.css</a></p></li><li><p>单独页脚渐变</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/footer.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/footer.min.css</a></p></li><li><p>友链页面css</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/flink.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/flink.min.css</a></p></li><li><p>多种按钮</p><p>  <a href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/buttons.min.css">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/css/buttons.min.css</a></p></li></ul><h2 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h2><p>如果遇到什么问题例如：修改完成后样式不对、缺少文件（写文章时可能忘记加上）等问题可以在下方留言或者将问题发送到我的邮箱。我会在第一时间内帮助解决问题。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二进制的加减乘除法</title>
      <link href="c621463b2578.html"/>
      <url>c621463b2578.html</url>
      
        <content type="html"><![CDATA[<h1 id="一、二进制加法"><a href="#一、二进制加法" class="headerlink" title="一、二进制加法"></a>一、<a href="https://so.csdn.net/so/search?q=%E4%BA%8C%E8%BF%9B%E5%88%B6&spm=1001.2101.3001.7020">二进制</a>加法</h1><p>对于二进制加法和十<a href="https://so.csdn.net/so/search?q=%E8%BF%9B%E5%88%B6&spm=1001.2101.3001.7020">进制</a>的加法本质上是一样的，只是前者逢2进1，后者逢10进1。</p><p>我们以0111+1110为例：<br><img src="https://img-blog.csdnimg.cn/6e98ce3844fe4e0b84d1c9841446a7f2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5aaI5aaI6K-05oiR5pyJ5YmN6YCU,size_18,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="在这里插入图片描述"></p><h1 id="二、二进制减法"><a href="#二、二进制减法" class="headerlink" title="二、二进制减法"></a>二、二进制减法</h1><p><img src="https://img-blog.csdnimg.cn/4897d44786eb47e7b48926d3e7261f35.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5aaI5aaI6K-05oiR5pyJ5YmN6YCU,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="在这里插入图片描述"></p><h1 id="三、二进制乘法"><a href="#三、二进制乘法" class="headerlink" title="三、二进制乘法"></a>三、二进制乘法</h1><p>二进制乘法需要先消化一下二进制加法，这样会更好一点。<br><img src="https://img-blog.csdnimg.cn/a7431fce80484cc3bdba4cf9c99a9e6d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5aaI5aaI6K-05oiR5pyJ5YmN6YCU,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="在这里插入图片描述"></p><h1 id="四、二进制除法"><a href="#四、二进制除法" class="headerlink" title="四、二进制除法"></a>四、二进制除法</h1><p><img src="https://img-blog.csdnimg.cn/348e25ea3f9e4cd88268a48b56ec9acd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5aaI5aaI6K-05oiR5pyJ5YmN6YCU,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="在这里插入图片描述"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>二进制的运算和十进制是一回事，只要记住一句话就可：<br>二进制中，进位、借位时2为单位。<br>十进制中以10为单位。</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 二进制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitLab+Jenkins实现持续集成+自动化部署（转载）</title>
      <link href="d564cbe68145.html"/>
      <url>d564cbe68145.html</url>
      
        <content type="html"><![CDATA[<h1 id="一-自动化上线代码基本介绍"><a href="#一-自动化上线代码基本介绍" class="headerlink" title="一.自动化上线代码基本介绍"></a>一.自动化上线代码基本介绍</h1><h4 id="1-软件开发生命周期"><a href="#1-软件开发生命周期" class="headerlink" title="1.软件开发生命周期"></a>1.软件开发生命周期</h4><p>老板创意—产品经理—立项—开发团队—测试团队(黑白盒)—运维上线<br>产品经理—加需求—开发团队—测试团队—运维更新代码上线</p><h4 id="2-什么是环境？"><a href="#2-什么是环境？" class="headerlink" title="2.什么是环境？"></a>2.什么是环境？</h4><p>开发环境：开发自己用的电脑本地自己装的php python的开发工具等。<br>测试环境：多个人的代码合起来跑一遍，运行一次，测试mysql redis等。<br>预发布环境：直接连接线上数据库，专门的测试域名小范围内测试。<br>生产环境：线上环境 每个项目一套环境 (线下可以放一起配多域名 线上不行)。</p><h4 id="3-什么是持续集成-CI-？"><a href="#3-什么是持续集成-CI-？" class="headerlink" title="3.什么是持续集成(CI)？"></a>3.什么是持续集成(CI)？</h4><p>每天都进行一次代码合并，就是持续集成。<br>多个开发写的代码 集中起来管理 放到代码库里 (版本控制管理软件)代码库工具：svn git(多) 。（版本控制系统：类似于快照的增量备份的机制，也就是每一次版本更新，都会在原来的基础上保留变化的内容，生成一个新的版本，之前的版本也会被保留，以便快速回滚。）<br>每天都要做代码合并，防止冲突，在合并的时候会产生冲突，所以提交的时候有先后顺序，就是你先上传，然后我把你上传的拉过来和我的进行合并，排除冲突，然后我在上传到主分支。持续集成是一种软件开发实践，即团队开发成员经常集成他们的工作，通常每个成员至少集成一次，也就意味着每天可能会发生多次集成。每次集成都通过自动化的构建（包括编译、发布、自动化测试）来验证，从而尽快地发现集成错误。许多团队发现这个过程可以大大减少集成的问题，让团队能够更快的开发内聚的软件。</p><h4 id="4-什么是持续交付？"><a href="#4-什么是持续交付？" class="headerlink" title="4.什么是持续交付？"></a>4.什么是持续交付？</h4><p>开发首先进行单元测试—最后把所有代码放一起进行测试—代码质量检查。</p><h4 id="5-什么是持续部署？"><a href="#5-什么是持续部署？" class="headerlink" title="5.什么是持续部署？"></a>5.什么是持续部署？</h4><p>频繁的代码上线就是持续部署。</p><h4 id="6-没有持续集成"><a href="#6-没有持续集成" class="headerlink" title="6.没有持续集成"></a>6.没有持续集成</h4><p>项目做模块集成的时候，发现很多接口都不通==&gt;浪费大量时间<br>需要手动去编译打包最新的代码==&gt;构建过程不透明<br>发布代码，上线，基本靠手工==&gt;脚本乱飞</p><h4 id="7-持续集成最佳实践"><a href="#7-持续集成最佳实践" class="headerlink" title="7.持续集成最佳实践"></a>7.持续集成最佳实践</h4><p>维护一个单一的代码库<br>使构建自动化<br>执行测试是构建的一部分<br>集成日志及历史记录<br>使用统一的依赖包管理库<br>每天至少集成一次</p><h1 id="二-jenkins基础使用"><a href="#二-jenkins基础使用" class="headerlink" title="二.jenkins基础使用"></a>二.jenkins基础使用</h1><p>说明：如何安装Jenkins请参考文档：<a href="https://www.jianshu.com/p/343bdd43c82a">https://www.jianshu.com/p/343bdd43c82a</a><br>这里就省略安装。</p><h6 id="1-登录Jenkins-webUI界面创建一个项目"><a href="#1-登录Jenkins-webUI界面创建一个项目" class="headerlink" title="1.登录Jenkins webUI界面创建一个项目"></a>1.登录Jenkins webUI界面创建一个项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a287d2ba7cc58975.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="2-输入项目名称-free-job-并选择构建一个自由风格的软件项目"><a href="#2-输入项目名称-free-job-并选择构建一个自由风格的软件项目" class="headerlink" title="2.输入项目名称(free-job)并选择构建一个自由风格的软件项目"></a>2.输入项目名称(free-job)并选择构建一个自由风格的软件项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-2adb0148c5a8f6ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5-7天即可）"><a href="#3-上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5-7天即可）" class="headerlink" title="3.上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5~7天即可）"></a>3.上面创建完成后跳转进来后进行配置，选择丢弃旧的构建（下面保持天数一般在5~7天即可）</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-3935302285e0b972.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-接着上面选择构建，然后选择Execute-Shell-来执行shell命令"><a href="#4-接着上面选择构建，然后选择Execute-Shell-来执行shell命令" class="headerlink" title="4.接着上面选择构建，然后选择Execute Shell 来执行shell命令"></a>4.接着上面选择构建，然后选择Execute Shell 来执行shell命令</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a4d7a122be4c7a6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里"><a href="#5-既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里" class="headerlink" title="5.既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里"></a>5.既然能执行shell命令，那么我们执行一个pwd，看下默认的工作目录在哪里</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-01056822b249c761.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="6-上面保存后点击立即构建，就会在下面生成一个build-history，（出现蓝色即表示正常，若红色即表示有问题"><a href="#6-上面保存后点击立即构建，就会在下面生成一个build-history，（出现蓝色即表示正常，若红色即表示有问题" class="headerlink" title="6.上面保存后点击立即构建，就会在下面生成一个build history，（出现蓝色即表示正常，若红色即表示有问题)"></a>6.上面保存后点击立即构建，就会在下面生成一个build history，（出现蓝色即表示正常，若红色即表示有问题)</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-4e05999c5800be4d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="7-构建完成，我们可以点击build-ID下拉框选择Console-Output-来查看详细信息"><a href="#7-构建完成，我们可以点击build-ID下拉框选择Console-Output-来查看详细信息" class="headerlink" title="7.构建完成，我们可以点击build ID下拉框选择Console Output 来查看详细信息"></a>7.构建完成，我们可以点击build ID下拉框选择Console Output 来查看详细信息</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-f3263514aaf2605f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="8-通过输出信息我们可以看到Jenkins默认的工作目录在-root-jenkins-workspace-项目名称"><a href="#8-通过输出信息我们可以看到Jenkins默认的工作目录在-root-jenkins-workspace-项目名称" class="headerlink" title="8.通过输出信息我们可以看到Jenkins默认的工作目录在 /root/.jenkins/workspace/(项目名称)"></a>8.通过输出信息我们可以看到Jenkins默认的工作目录在 /root/.jenkins/workspace/(项目名称)</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9b36f97427b2c201.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="9-既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置"><a href="#9-既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置" class="headerlink" title="9.既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置"></a>9.既然能执行shell命令，那么我们创建一个文件试试；返回工作台，点击配置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-1f152a1b8ee32f9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="10-创建一个free-txt文件并保存"><a href="#10-创建一个free-txt文件并保存" class="headerlink" title="10.创建一个free.txt文件并保存"></a>10.创建一个free.txt文件并保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-5db1e86e782071f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="11-同上面一样，我们点击立即构建"><a href="#11-同上面一样，我们点击立即构建" class="headerlink" title="11.同上面一样，我们点击立即构建"></a>11.同上面一样，我们点击立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-e2988a3a78150fd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="12-同样查看构建后的控制台输出，可以看到构建成功"><a href="#12-同样查看构建后的控制台输出，可以看到构建成功" class="headerlink" title="12.同样查看构建后的控制台输出，可以看到构建成功"></a>12.同样查看构建后的控制台输出，可以看到构建成功</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-d2676c3d8845048d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="13-既然构建成功，那么我们进入服务器进行验证是否创建成功"><a href="#13-既然构建成功，那么我们进入服务器进行验证是否创建成功" class="headerlink" title="13.既然构建成功，那么我们进入服务器进行验证是否创建成功"></a>13.既然构建成功，那么我们进入服务器进行验证是否创建成功</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]<span class="meta"># cd /var/lib/jenkins/workspace/free-job/</span></span><br><span class="line">[root@jenkins /var/lib/jenkins/workspace/<span class="built_in">free</span>-job]<span class="meta"># ls</span></span><br><span class="line"><span class="built_in">free</span>.txt</span><br></pre></td></tr></table></figure><h1 id="三-GitLab-Jenkins自动化部署及更新"><a href="#三-GitLab-Jenkins自动化部署及更新" class="headerlink" title="三.GitLab+Jenkins自动化部署及更新"></a>三.GitLab+Jenkins自动化部署及更新</h1><p><strong>流程图如下：</strong>  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-834f444e13df92e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1067/format/webp"></p><p>说明：通过gitlab+Jenkins实现代码的自动更新同步代码到web服务器站点目录。此处示例后端web服务器使用nginx。<br><strong>环境规划以及ip分配如下表：</strong>  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-fb6ed0a0bc780d1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/348/format/webp"></p><p>注意：开发环境这里直接放在gitlab服务器上这里将git也部署在gitlab服务器上。git基本使用请参考：<a href="https://www.jianshu.com/p/96c4a6d0c587">https://www.jianshu.com/p/96c4a6d0c587</a></p><h4 id="3-1gitlab-配置"><a href="#3-1gitlab-配置" class="headerlink" title="3.1gitlab 配置"></a>3.1gitlab 配置</h4><p>说明：首先在gitlab上面创建一个群组，并创建一个项目，将代码push 到代码仓库中（项目）。创建一个开发用户（用于提交代码等），同时在Jenkins服务器上面生成ssh秘钥并将key添加到新建用户的ssh认证下面。</p><h6 id="1-登录gitlab点击项目，然后点击创建一个群组"><a href="#1-登录gitlab点击项目，然后点击创建一个群组" class="headerlink" title="1.登录gitlab点击项目，然后点击创建一个群组"></a>1.登录gitlab点击项目，然后点击创建一个群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9c5feed5943c278e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="2-点击新建群组"><a href="#2-点击新建群组" class="headerlink" title="2.点击新建群组"></a>2.点击新建群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9d45f29e57affb83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-输入新建群组的相关信息并点击创建"><a href="#3-输入新建群组的相关信息并点击创建" class="headerlink" title="3.输入新建群组的相关信息并点击创建"></a>3.输入新建群组的相关信息并点击创建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7328687ce393e424.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-cf5a88ead554872b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-29416ea87d2b2928.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-新建一个项目"><a href="#4-新建一个项目" class="headerlink" title="4.新建一个项目"></a>4.新建一个项目</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-76caee6af95d3769.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-a3f535c71eaf882f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-f90bab31319fd9dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-设置秘钥"><a href="#5-设置秘钥" class="headerlink" title="5.设置秘钥"></a>5.设置秘钥</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># ssh-keygen -t rsa</span></span><br><span class="line">Generating <span class="keyword">public</span>/<span class="keyword">private</span> rsa key pair.</span><br><span class="line"><span class="function">Enter file <span class="keyword">in</span> which to save the <span class="title">key</span> (<span class="params">/root/.ssh/id_rsa</span>): </span></span><br><span class="line"><span class="function">Created directory &#x27;/root/.ssh&#x27;.</span></span><br><span class="line"><span class="function">Enter <span class="title">passphrase</span> (<span class="params">empty <span class="keyword">for</span> no passphrase</span>): </span></span><br><span class="line"><span class="function">Enter same passphrase again: </span></span><br><span class="line"><span class="function">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span></span><br><span class="line"><span class="function">Your <span class="keyword">public</span> key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span></span><br><span class="line"><span class="function">The key fingerprint <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">SHA256:WyI0C3MBpUdsAKQsDkEf99WmtCUvcXUoxWL+NgF2R0I root@gitlab</span></span><br><span class="line"><span class="function">The key&#x27;s randomart image <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">+---[RSA 2048]----+</span></span><br><span class="line"><span class="function">|ooooo*+  ..</span> =Eoo |</span><br><span class="line">|.o. oo+..+ @ +o. |</span><br><span class="line">|+. .+.=.. &amp; = .  |</span><br><span class="line">|+    * o + o .   |</span><br><span class="line">| .    o S o . .  |</span><br><span class="line">|       . +   +   |</span><br><span class="line">|        .   . .  |</span><br><span class="line">|                 |</span><br><span class="line">|                 |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># cat .ssh/id_rsa.pub </span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDnnyT5IRLN2AzknCPE3pLnLhH0Vq6jGJsYsjDaLKBQNkBD4coTMW47PJpjxL/pjwyV9KaQ3BuEqam8jQlpaDYUQVBK++<span class="number">0</span>ALFAObGTyTPThRVKhW7X3kjSkInkwAZVj2dLdU0oIinzEuCjldhOe3BF2FYHRgcbnklEFIVpK3quTJbKxcF4h8SMbihRbXor0AIsOupWd0z2skqqvr4xSDNPAb4t+Ypd0MnGPRJYb8DTs+Ign+gn6L7a48RWqqIhBjVjgDLHiitMeEKA6FCS4cEHvcbHhXtrLswfF2ocA+mjfb5WGfP73d959fSPfvraRhhxXqBMqM309DmO3DGtS2e1j root@gitlab</span><br></pre></td></tr></table></figure><h6 id="6-塞key操作，方便源码上传下载"><a href="#6-塞key操作，方便源码上传下载" class="headerlink" title="6.塞key操作，方便源码上传下载"></a>6.塞key操作，方便源码上传下载</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-60ec72f29fad364e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="7-点击头像查看创建项目的结果"><a href="#7-点击头像查看创建项目的结果" class="headerlink" title="7.点击头像查看创建项目的结果"></a>7.点击头像查看创建项目的结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-2dc066a5f3995902.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-caf14bb024770513.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="8-查看项目根据提示配置初始化"><a href="#8-查看项目根据提示配置初始化" class="headerlink" title="8.查看项目根据提示配置初始化"></a>8.查看项目根据提示配置初始化</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-fef4277cd6f8e322.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-cb0b1b094c67aac0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="9-模拟开发建立git本地工作目录和本地仓库"><a href="#9-模拟开发建立git本地工作目录和本地仓库" class="headerlink" title="9.模拟开发建立git本地工作目录和本地仓库"></a>9.模拟开发建立git本地工作目录和本地仓库</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#这里的源码使用的码云上源码，你可以自行下载使用即可。</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git config --global user.name &quot;Administrator&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git config --global user.email &quot;admin@example.com&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git init</span></span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /root/yiliaoqixie/.git/</span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git commit -m &quot;第一次提交项目&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git remote add origin git@10.0.0.55:yiliao/yiliao.git</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure><h5 id="10-查看上传的结果"><a href="#10-查看上传的结果" class="headerlink" title="10.查看上传的结果"></a>10.查看上传的结果</h5><p><img src="//upload-images.jianshu.io/upload_images/19901269-f48caa199901c898.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="11-点击设置选择新建用户"><a href="#11-点击设置选择新建用户" class="headerlink" title="11.点击设置选择新建用户"></a>11.点击设置选择新建用户</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-bf376a1c2e0f11ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="12-输入账号相关信息并点击创建用户"><a href="#12-输入账号相关信息并点击创建用户" class="headerlink" title="12.输入账号相关信息并点击创建用户"></a>12.输入账号相关信息并点击创建用户</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-01abf88d15a779f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-04d351fdec1043af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="13-点击编辑，为上面新创建的用户设置密码"><a href="#13-点击编辑，为上面新创建的用户设置密码" class="headerlink" title="13.点击编辑，为上面新创建的用户设置密码"></a>13.点击编辑，为上面新创建的用户设置密码</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-0bdccd453ea8bdb9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="14-给这个账号设置密码并保存"><a href="#14-给这个账号设置密码并保存" class="headerlink" title="14.给这个账号设置密码并保存"></a>14.给这个账号设置密码并保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7848ede10c6052aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-decd77c763d152b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="15-将上面创建的用户添加到devops组中并给与开发者权限"><a href="#15-将上面创建的用户添加到devops组中并给与开发者权限" class="headerlink" title="15.将上面创建的用户添加到devops组中并给与开发者权限"></a>15.将上面创建的用户添加到devops组中并给与开发者权限</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-8ee57e9f62b3954f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="16-找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组"><a href="#16-找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组" class="headerlink" title="16.找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组"></a>16.找到刚刚创建的dev用户并给予开发人员权限，然后增加用户到群组</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-1f58d023dcc17794.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h2 id="3-2Jenkins配置"><a href="#3-2Jenkins配置" class="headerlink" title="3.2Jenkins配置"></a>3.2Jenkins配置</h2><h6 id="1-在Jenkins的服务器上生成秘钥"><a href="#1-在Jenkins的服务器上生成秘钥" class="headerlink" title="1.在Jenkins的服务器上生成秘钥"></a>1.在Jenkins的服务器上生成秘钥</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># ssh-keygen -t rsa</span></span><br><span class="line">Generating <span class="keyword">public</span>/<span class="keyword">private</span> rsa key pair.</span><br><span class="line"><span class="function">Enter file <span class="keyword">in</span> which to save the <span class="title">key</span> (<span class="params">/root/.ssh/id_rsa</span>): </span></span><br><span class="line"><span class="function">Created directory &#x27;/root/.ssh&#x27;.</span></span><br><span class="line"><span class="function">Enter <span class="title">passphrase</span> (<span class="params">empty <span class="keyword">for</span> no passphrase</span>): </span></span><br><span class="line"><span class="function">Enter same passphrase again: </span></span><br><span class="line"><span class="function">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span></span><br><span class="line"><span class="function">Your <span class="keyword">public</span> key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span></span><br><span class="line"><span class="function">The key fingerprint <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">SHA256:Y/nVt2+ldZc+h4VrsormDhSXKj3ryP/LlLkpIU95xjA root@jenkins</span></span><br><span class="line"><span class="function">The key&#x27;s randomart image <span class="keyword">is</span>:</span></span><br><span class="line"><span class="function">+---[RSA 2048]----+</span></span><br><span class="line"><span class="function">|                 |</span></span><br><span class="line"><span class="function">|         .       |</span></span><br><span class="line"><span class="function">|      . o        |</span></span><br><span class="line"><span class="function">|     .E+ .   .   |</span></span><br><span class="line"><span class="function">|    .</span> ==S   . ..o|</span><br><span class="line">|    .o+++= .  .oB|</span><br><span class="line">|     +o++ .   .B+|</span><br><span class="line">|   . oo+.+  . =o+|</span><br><span class="line">|    o.o*X....+ .+|</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># cat ./.ssh/id_rsa</span></span><br><span class="line">id_rsa      id_rsa.pub  </span><br><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># cat ./.ssh/id_rsa.pub </span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCssc5KGRIvHV64Md3HR3SdT0w4twdrAIbxWSSo3tvfrauMdSk2ptmxvgzPqfGEQUgHfPsZY10eN0bpvaFARLBDytyRLbgdSo6gts+J0nGhy0hcjOhu4xJgygt8hN53UCUbdy7DhUnwxIfOuzENFYLS7ZW/Uk4N1FrNNuZK0X5aVNsV5r9H+fUeOfMJ4YLjLhFn6C94q4XmS9OfAW0aCSUfBbCT9LnRmeU/FoQMGdujBZ+Koc9289IVNHkVL+vEW6ZTxLPMEoRaB0RlLxfZF86LMsjsqx6ABBHNpV5FZWl0OYnnEn3jKHRNStfxx2g5Hz9e7eRguBubBis75OfHf2br root@jenkins</span><br></pre></td></tr></table></figure><h6 id="2-回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置"><a href="#2-回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置" class="headerlink" title="2.回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置"></a>2.回到gitlab服务器上面使用maliu用户登录，然后点击头像选择设置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-65eeefdfa3b423f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-上面的设置点进来后，选择SSH-秘钥，-然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥"><a href="#3-上面的设置点进来后，选择SSH-秘钥，-然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥" class="headerlink" title="3.上面的设置点进来后，选择SSH 秘钥， 然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥"></a>3.上面的设置点进来后，选择SSH 秘钥， 然后复制Jenkins服务器上生成的秘钥然后点击增加秘钥</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-cb62a56dc0f15837.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-21869ebbc48f29bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-8f40b346d767b6c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-新建任务"><a href="#4-新建任务" class="headerlink" title="4.新建任务"></a>4.新建任务</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-80ad5c7275c9baa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-78da6fa9e19e318f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-点击项目名称开始配置"><a href="#5-点击项目名称开始配置" class="headerlink" title="5.点击项目名称开始配置"></a>5.点击项目名称开始配置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-4813ed392f3dd230.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="6-选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存"><a href="#6-选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存" class="headerlink" title="6.选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存"></a>6.选择源码管理，选Git，输入仓库URL地址（如果下方出现红色及表示出错了），然后选择保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-bfe5b72ed06082f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="7-立即构建"><a href="#7-立即构建" class="headerlink" title="7.立即构建"></a>7.立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-312d586dd877b0a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="8-查看构建信息"><a href="#8-查看构建信息" class="headerlink" title="8.查看构建信息"></a>8.查看构建信息</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-efa9030643b3111d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="9-服务端查看"><a href="#9-服务端查看" class="headerlink" title="9.服务端查看"></a>9.服务端查看</h6><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@jenkins /var/lib/jenkins/workspace/yiliao]</span># <span class="selector-tag">ls</span></span><br><span class="line"><span class="selector-tag">about</span><span class="selector-class">.html</span>           <span class="selector-tag">article</span><span class="selector-class">.html</span>                         <span class="selector-tag">contact</span><span class="selector-class">.html</span>  <span class="selector-tag">index</span><span class="selector-class">.html</span>           <span class="selector-tag">product</span><span class="selector-class">.html</span></span><br><span class="line"><span class="selector-tag">album</span><span class="selector-class">.html</span>           <span class="selector-tag">Bootstrap</span>医疗器械公司响应式网站模板  <span class="selector-tag">css</span>           <span class="selector-tag">js</span></span><br><span class="line"><span class="selector-tag">article_detail</span><span class="selector-class">.html</span>  <span class="selector-tag">comment</span><span class="selector-class">.html</span>                         <span class="selector-tag">images</span>        <span class="selector-tag">product_detail</span><span class="selector-class">.html</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-3实现自动部署"><a href="#3-3实现自动部署" class="headerlink" title="3.3实现自动部署"></a>3.3实现自动部署</h2><p>上面已经完成了Jenkins从gitlab上拉取代码，现在需要实现如何将源码自动部署到web服务器上，这里使用脚本的方式来实现，Jenkins支持执行脚本的功能。</p><h6 id="1-在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证"><a href="#1-在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证" class="headerlink" title="1.在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证"></a>1.在Jenkins服务器上面编写同步脚本，由于是通过脚本拷贝到web服务器的站点目录，所以需要先做一个ssh秘钥认证</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@jenkins ~]<span class="comment"># ssh-copy-id -i 10.0.0.7</span></span><br><span class="line">[root@jenkins ~]<span class="comment"># ssh-copy-id -i 10.0.0.8</span></span><br><span class="line">[root@jenkins /server/scripts]<span class="comment"># vim deploy.sh </span></span><br><span class="line"><span class="comment">#项目目录</span></span><br><span class="line">CODE_DIR=/var/lib/jenkins/workspace/yiliao/</span><br><span class="line"><span class="comment">#时间格式</span></span><br><span class="line">DATE_TIME=`date +%Y-%m-%d-%H-%M-%S`</span><br><span class="line"><span class="comment">#打包后的名字</span></span><br><span class="line">TAR_NAME=web-<span class="variable">$&#123;DATE_TIME&#125;</span>.tar.gz</span><br><span class="line"><span class="comment">#web服务器站点目录的上一级 &quot;/usr/share/nginx/html&quot;</span></span><br><span class="line">WEB_DIR=/usr/share/nginx/</span><br><span class="line"><span class="comment">#web服务器新建的站点目录名字</span></span><br><span class="line">WEB_NEWDIR_NAME=web-<span class="variable">$&#123;DATE_TIME&#125;</span></span><br><span class="line"><span class="comment">#进入到项目目录上一级打包代码</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$CODE_DIR</span> &amp;&amp; tar czf /opt/<span class="variable">$TAR_NAME</span> ./*</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;7,8&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="comment">#拷贝到web服务器的站点目录的上一级</span></span><br><span class="line">    scp /opt/<span class="variable">$TAR_NAME</span> 10.0.0.<span class="variable">$&#123;i&#125;</span>:<span class="variable">$WEB_DIR</span></span><br><span class="line"><span class="comment">#连接web服务器进行解压压缩包到新的一个已时间命名的站点目录</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; mkdir <span class="variable">$WEB_NEWDIR_NAME</span> &amp;&amp; tar xf <span class="variable">$TAR_NAME</span> -C <span class="variable">$WEB_NEWDIR_NAME</span>&quot;</span></span><br><span class="line"><span class="comment">#将新建的站点目录与html站点目录做一个软链接</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; rm -rf html &amp;&amp; ln -s <span class="variable">$WEB_NEWDIR_NAME</span> html&quot;</span></span><br><span class="line">    ssh 10.0.0.<span class="variable">$i</span> <span class="string">&quot;cd <span class="variable">$WEB_DIR</span> &amp;&amp; rm -rf <span class="variable">$TAR_NAME</span>&quot;</span></span><br><span class="line">    sleep 3</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h6 id="2-配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）"><a href="#2-配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）" class="headerlink" title="2.配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）"></a>2.配置Jenkins，使用Jenkins调用部署脚本（此处写脚本全路径脚本名称）</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-8c8726bbf2777a43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-立即构建"><a href="#3-立即构建" class="headerlink" title="3.立即构建"></a>3.立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-56ae6962a19eaa34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-查看输出结果"><a href="#4-查看输出结果" class="headerlink" title="4.查看输出结果"></a>4.查看输出结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-848814b9bedb872b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-测试访问结果"><a href="#5-测试访问结果" class="headerlink" title="5.测试访问结果"></a>5.测试访问结果</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-7fd0ba8900f2b980.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h2 id="3-4自动更新"><a href="#3-4自动更新" class="headerlink" title="3.4自动更新"></a>3.4自动更新</h2><h6 id="1-配置自动触发构建、需要设置安全令牌Secret-token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build-when-a-chang上面提示的URL地址（-http-10-0-0-57-8080-project-yiliao）"><a href="#1-配置自动触发构建、需要设置安全令牌Secret-token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build-when-a-chang上面提示的URL地址（-http-10-0-0-57-8080-project-yiliao）" class="headerlink" title="1.配置自动触发构建、需要设置安全令牌Secret token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build when a chang上面提示的URL地址（ http://10.0.0.57:8080/project/yiliao）"></a>1.配置自动触发构建、需要设置安全令牌Secret token，进入项目选择配置，设置相关信息，然后生成token，复制token（需要填写到gitlab上面）和Build when a chang上面提示的URL地址（ <a href="https://links.jianshu.com/go?to=http://10.0.0.57:8080/project/yiliao">http://10.0.0.57:8080/project/yiliao</a>）</h6><p>选择构建触发器，然后选择build when a change is ….,下方有个高级选项后然后选择Filter branches byname,然后输入master分支，再点击下面的Generate生成token,然后点击保存。</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-c98832fb2e89a63c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="2-配置gitlab，添加token"><a href="#2-配置gitlab，添加token" class="headerlink" title="2.配置gitlab，添加token"></a>2.配置gitlab，添加token</h6><p>点击项目→设置→设置→集成，然后输入Jenkins上面提示的URL地址和和生成的token，点击增加web钩子。</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-a39d98d7f47b447f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-测试Web钩子"><a href="#3-测试Web钩子" class="headerlink" title="3.测试Web钩子"></a>3.测试Web钩子</h6><p>添加完钩子完成后可以测试，选择Push event,执行完会显示上面的提示。</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-5ca93f8e5cfda33d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面，-这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。"><a href="#4-上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面，-这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。" class="headerlink" title="4.上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面， 这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。"></a>4.上面已经配置完成，接下来就是测试，我们知道目前web服务站点访问得到结果如上面， 这里gitlab服务器下载的代码并进行修改，然后推送gitlab仓库。这里去除首页的右上角的English版本。</h6><p>修改首页内容：</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-b74a0431f18f3756.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-推送新的修改源码"><a href="#5-推送新的修改源码" class="headerlink" title="5.推送新的修改源码"></a>5.推送新的修改源码</h6><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git commit -m &quot;第二次提交&quot;</span></span><br><span class="line">[<span class="meta">master 4b8d377</span>] 第二次提交</span><br><span class="line">[<span class="meta">root@gitlab ~/yiliaoqixie</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure><h6 id="6-测试访问"><a href="#6-测试访问" class="headerlink" title="6.测试访问"></a>6.测试访问</h6><p>之前的结果如下图：</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-e41db0597803a470.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>现在的结果：</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-397919621c4700f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h2 id="3-5配置构建Jenkins返回构建状态gitlab"><a href="#3-5配置构建Jenkins返回构建状态gitlab" class="headerlink" title="3.5配置构建Jenkins返回构建状态gitlab"></a>3.5配置构建Jenkins返回构建状态gitlab</h2><h6 id="1-现在gotlab上面生成访问令牌token，点击用户处的设置"><a href="#1-现在gotlab上面生成访问令牌token，点击用户处的设置" class="headerlink" title="1.现在gotlab上面生成访问令牌token，点击用户处的设置"></a>1.现在gotlab上面生成访问令牌token，点击用户处的设置</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-59e6db3363db43db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="2-访问令牌——-gt-输入名称——-gt-选择范围为api——-gt-创建个人访问令牌，将生成的令牌token复制"><a href="#2-访问令牌——-gt-输入名称——-gt-选择范围为api——-gt-创建个人访问令牌，将生成的令牌token复制" class="headerlink" title="2.访问令牌——&gt;输入名称——&gt;选择范围为api——&gt;创建个人访问令牌，将生成的令牌token复制"></a>2.访问令牌——&gt;输入名称——&gt;选择范围为api——&gt;创建个人访问令牌，将生成的令牌token复制</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-fd2d81d235808feb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="3-登录Jenkins———-gt-选择系统管理——-gt-选择系统设置——-gt-选择Gitlab——-gt-输入名字——-gt-输入URL———-gt-点击Add"><a href="#3-登录Jenkins———-gt-选择系统管理——-gt-选择系统设置——-gt-选择Gitlab——-gt-输入名字——-gt-输入URL———-gt-点击Add" class="headerlink" title="3.登录Jenkins———&gt;选择系统管理——&gt;选择系统设置——&gt;选择Gitlab——&gt;输入名字——&gt;输入URL———&gt;点击Add"></a>3.登录Jenkins———&gt;选择系统管理——&gt;选择系统设置——&gt;选择Gitlab——&gt;输入名字——&gt;输入URL———&gt;点击Add</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-c03148b9f513a509.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="4-上面点击Add进来后，kind处选择Gitlab-API-token，粘贴上面复制的token，自定义ID和描述"><a href="#4-上面点击Add进来后，kind处选择Gitlab-API-token，粘贴上面复制的token，自定义ID和描述" class="headerlink" title="4.上面点击Add进来后，kind处选择Gitlab API token，粘贴上面复制的token，自定义ID和描述"></a>4.上面点击Add进来后，kind处选择Gitlab API token，粘贴上面复制的token，自定义ID和描述</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-157415e4f2e03ca7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="5-上面添加后，回到这里选择刚刚生成的这个token。然后点击保存"><a href="#5-上面添加后，回到这里选择刚刚生成的这个token。然后点击保存" class="headerlink" title="5.上面添加后，回到这里选择刚刚生成的这个token。然后点击保存"></a>5.上面添加后，回到这里选择刚刚生成的这个token。然后点击保存</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-834c171ea982d8c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="6-上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish-…-to-…Gitlab，选择后直接保存就ok"><a href="#6-上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish-…-to-…Gitlab，选择后直接保存就ok" class="headerlink" title="6.上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish … to …Gitlab，选择后直接保存就ok"></a>6.上面保存后，进入到项目里选择配置，配置构建后操作，选择Publish … to …Gitlab，选择后直接保存就ok</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-441d390b5e4ef93b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="7-测试，点击立即构建"><a href="#7-测试，点击立即构建" class="headerlink" title="7.测试，点击立即构建"></a>7.测试，点击立即构建</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-70653c07bb9f21e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="8-回到gitlab上面查看，那里生成了一个对号"><a href="#8-回到gitlab上面查看，那里生成了一个对号" class="headerlink" title="8.回到gitlab上面查看，那里生成了一个对号"></a>8.回到gitlab上面查看，那里生成了一个对号</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-c229b9b4fc197a5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="9-点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。"><a href="#9-点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。" class="headerlink" title="9.点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。"></a>9.点击对号，进来后可以看到流水线，下面一些信息，比如状态，提交等。</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-b9b2e6898e943674.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="10-点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success"><a href="#10-点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success" class="headerlink" title="10.点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success"></a>10.点击上面Status下面的对号，可以看到如下图一样的有个jenkins-success</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-9f13e24bff75ac92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h6 id="11-再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。"><a href="#11-再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。" class="headerlink" title="11.再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。"></a>11.再点击jenkins就跳转到jenkins上面去了，也可以查看输出，还可以查看工作空间，可以查看到所有代码，返回的话只能选择后退。</h6><p><img src="//upload-images.jianshu.io/upload_images/19901269-a77eca688ec6f4b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-ebdd57bd444800b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-860256818c23d065.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><h1 id="四-java项目代码上线"><a href="#四-java项目代码上线" class="headerlink" title="四.java项目代码上线"></a>四.java项目代码上线</h1><p>1）最终目标：对JAVA项目实现CI/CD<br>2）把代码存到GitLab<br>3）使用Maven编译并打包源码<br>4）将war包部署到Tomcat</p><h5 id="4-1安装maven"><a href="#4-1安装maven" class="headerlink" title="4.1安装maven"></a>4.1安装maven</h5><p>请参考链接文档进行安装：<a href="https://www.jianshu.com/p/b7dfc7c357ca">https://www.jianshu.com/p/b7dfc7c357ca</a></p><h5 id="4-2在jenkins中调用maven"><a href="#4-2在jenkins中调用maven" class="headerlink" title="4.2在jenkins中调用maven"></a>4.2在jenkins中调用maven</h5><p>点击系统管理→全局工具配置</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-2a26fc52439e3c50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>在Maven 配置这里分别设置默认和默认全局settings提供</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-3e1f198b2869fdea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>下拉到Maven，点击“新增Maven”，Name这里自定义即可，然后把“自动安装”前面方框里的对勾取消，填写MAVEN HOME为/usr/local/maven</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-2f26eea74c828813.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>配置JDK</p><p>之所以要配置JDK是因为后续的Maven操作需要设置JAVA_HOME这个变量。点击“系统管理”、“全局工具配置”，下拉到JDK，点击“JDK安装”，“别名”设置为jdk，“JAVA_HOME”设置为/usr/java/jdk</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-0ff169a4ae2200d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1032/format/webp"></p><p>这个JAVA_HOME路径其实就是你的JDK安装路径，如果用yum安装的openjdk，则在/usr/lib/jvm/java-xxxx（这里的xxxx是jdk版本）。</p><h5 id="4-3用Jenkins部署JAVA项目"><a href="#4-3用Jenkins部署JAVA项目" class="headerlink" title="4.3用Jenkins部署JAVA项目"></a>4.3用Jenkins部署JAVA项目</h5><p><strong>4.3.1安装插件</strong><br>首先需要安装Maven Integration plugin 和 Deploy to container Plugin。<br>到Jenkins逐次点击系统管理、插件管理、可选插件，在右上角的“过滤”文本框里输入“integration”，会出现两个插件，选择下面的插件，点击直接安装。  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-d25622cc8af855dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><img src="//upload-images.jianshu.io/upload_images/19901269-d168f836d2053ee3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>等它安装完后，用同样的方式再安装Deploy to container。</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-dc82dd84e9ef80c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>两个插件完成安装后，重启一下Jenkins服务</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@jenkins ~</span>]<span class="meta"># systemctl restart jenkins</span></span><br></pre></td></tr></table></figure><p><strong>4.3.2模拟开发建立git本地工作目录和本地仓库</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#这里的源码使用的码云上源码，你可以自行下载使用即可。</span></span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># mkdir /jeesns</span></span><br><span class="line">[<span class="meta">root@gitlab ~</span>]<span class="meta"># cd /jeesns/</span></span><br><span class="line">[<span class="meta">root@gitlab /jeesns</span>]<span class="meta">#</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git config --global user.name &quot;Administrator&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git config --global user.email &quot;admin@example.com&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git init</span></span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /jeesns/.git/</span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git add .</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git commit -m &quot;第一次提交项目&quot;</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git remote add origin git@10.0.0.56:jeesns/jeesns.git</span></span><br><span class="line">[<span class="meta">root@gitlab ~/jeesns</span>]<span class="meta"># git push -u origin --all</span></span><br></pre></td></tr></table></figure><p>web界面查看项目</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-f67cf86806744cf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><strong>4.3.3新建任务</strong><br>重启完成后，再次访问Jenkins的WEB界面，点击左侧的“新建任务”，任务名称自定义（jeesns），选择“构建一个maven项目”  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-c474d7cf2b250cf7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p>点击左下角的“确定”按钮后，进入配置页，下拉到“源码管理”，点击”git”，“Repositories”填写GitLab的jeesns项目地址  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-b6bddbcbca88ad6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1180/format/webp"></p><p>这里需要如之前的一样将Jenkins的服务器上生成秘钥的公钥塞到gitlab的用户的sshkey下，也可以点击“添加”按钮，紧接着点击“Jenkins”进入如下页面  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-05a158b2ffa22fb3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1065/format/webp"></p><p>类型选择“SSH Username with private key”，username填写git，Private Key右侧小圆点点击一下，把在git客户端生成的私钥（/root/.ssh/id_rsa）粘贴到此处，最后点“添加”，返回到刚才的页面，Credentials这里选择刚刚添加的“git”  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-82ade542c9e41207.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1173/format/webp"></p><p>Pre Steps设置，这里可以设置切换数据库，生产中可以用于切换测试库和生产库</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-cfc6ed9b14331e9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/976/format/webp"></p><p>build 构建设置，这里设置源码编译的参数</p><p><img src="//upload-images.jianshu.io/upload_images/19901269-2e1a992b1204b0c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/980/format/webp"></p><p>Post Steps设置，这里在源码包编译完成后通过ansible实现代码的批量上线  </p><p><img src="//upload-images.jianshu.io/upload_images/19901269-6ebf859b4b554538.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/976/format/webp"></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java多线程</title>
      <link href="c7ae4151bb65.html"/>
      <url>c7ae4151bb65.html</url>
      
        <content type="html"><![CDATA[<p>随着计算机行业的飞速发展，摩尔定律逐渐失效，多核 CPU 成为主流。使用多线程并行计算逐渐成为开发人员提升服务器性能的基本武器。J.U.C 提供的线程池：ThreadPoolExecutor 类，帮助开发人员管理线程并方便地执行并行任务。了解并合理使用线程池，是一个开发人员必修的基本功。</p><p>本文开篇简述线程池概念和用途，接着结合线程池的源码，帮助读者领略线程池的设计思路，最后回归实践，通过案例讲述使用线程池遇到的问题，并给出了一种动态化线程池解决方案。</p><h2 id="一、写在前面"><a href="#一、写在前面" class="headerlink" title="一、写在前面"></a>一、写在前面</h2><h3 id="1-1-线程池是什么"><a href="#1-1-线程池是什么" class="headerlink" title="1.1 线程池是什么"></a>1.1 线程池是什么</h3><p>线程池（Thread Pool）是一种基于池化思想管理线程的工具，经常出现在多线程服务器中，如 MySQL。</p><p>线程过多会带来额外的开销，其中包括创建销毁线程的开销、调度线程的开销等等，同时也降低了计算机的整体性能。线程池维护多个线程，等待监督管理者分配可并发执行的任务。这种做法，一方面避免了处理任务时创建销毁线程开销的代价，另一方面避免了线程数量膨胀导致的过分调度问题，保证了对内核的充分利用。</p><p>而本文描述线程池是 JDK 中提供的 ThreadPoolExecutor 类。</p><p>当然，使用线程池可以带来一系列好处：</p><ul><li><strong>降低资源消耗</strong>：通过池化技术重复利用已创建的线程，降低线程创建和销毁造成的损耗。</li><li><strong>提高响应速度</strong>：任务到达时，无需等待线程创建即可立即执行。</li><li><strong>提高线程的可管理性</strong>：线程是稀缺资源，如果无限制创建，不仅会消耗系统资源，还会因为线程的不合理分布导致资源调度失衡，降低系统的稳定性。使用线程池可以进行统一的分配、调优和监控。</li><li><strong>提供更多更强大的功能</strong>：线程池具备可拓展性，允许开发人员向其中增加更多的功能。比如延时定时线程池 ScheduledThreadPoolExecutor，就允许任务延期执行或定期执行。</li></ul><h3 id="1-2-线程池解决的问题是什么"><a href="#1-2-线程池解决的问题是什么" class="headerlink" title="1.2 线程池解决的问题是什么"></a>1.2 线程池解决的问题是什么</h3><p>线程池解决的核心问题就是资源管理问题。在并发环境下，系统不能够确定在任意时刻中，有多少任务需要执行，有多少资源需要投入。这种不确定性将带来以下若干问题：</p><ol><li>频繁申请/销毁资源和调度资源，将带来额外的消耗，可能会非常巨大。</li><li>对资源无限申请缺少抑制手段，易引发系统资源耗尽的风险。</li><li>系统无法合理管理内部的资源分布，会降低系统的稳定性。</li></ol><p>为解决资源分配这个问题，线程池采用了“池化”（Pooling）思想。池化，顾名思义，是为了最大化收益并最小化风险，而将资源统一在一起管理的一种思想。</p><blockquote><p>Pooling is the grouping together of resources (assets, equipment, personnel, effort, etc.) for the purposes of maximizing advantage or minimizing risk to the users. The term is used in finance, computing and equipment management.——wikipedia</p></blockquote><p>“池化”思想不仅仅能应用在计算机领域，在金融、设备、人员管理、工作管理等领域也有相关的应用。</p><p>在计算机领域中的表现为：统一管理 IT 资源，包括服务器、存储、和网络资源等等。通过共享资源，使用户在低投入中获益。除去线程池，还有其他比较典型的几种使用策略包括：</p><ol><li>内存池(Memory Pooling)：预先申请内存，提升申请内存速度，减少内存碎片。</li><li>连接池(Connection Pooling)：预先申请数据库连接，提升申请连接的速度，降低系统的开销。</li><li>实例池(Object Pooling)：循环使用对象，减少资源在初始化和释放时的昂贵损耗。</li></ol><p>在了解完“是什么”和“为什么”之后，下面我们来一起深入一下线程池的内部实现原理。</p><h2 id="二、线程池核心设计与实现"><a href="#二、线程池核心设计与实现" class="headerlink" title="二、线程池核心设计与实现"></a>二、线程池核心设计与实现</h2><p>在前文中，我们了解到：线程池是一种通过“池化”思想，帮助我们管理线程而获取并发性的工具，在 Java 中的体现是 ThreadPoolExecutor 类。那么它的的详细设计与实现是什么样的呢？我们会在本章进行详细介绍。</p><h3 id="2-1-总体设计"><a href="#2-1-总体设计" class="headerlink" title="2.1 总体设计"></a>2.1 总体设计</h3><p>Java 中的线程池核心实现类是 ThreadPoolExecutor，本章基于 JDK 1.8 的源码来分析 Java 线程池的核心设计与实现。我们首先来看一下 ThreadPoolExecutor 的 UML 类图，了解下 ThreadPoolExecutor 的继承关系。</p><p><a href="https://p1.meituan.net/travelcube/912883e51327e0c7a9d753d11896326511272.png"><img src="https://p1.meituan.net/travelcube/912883e51327e0c7a9d753d11896326511272.png" alt="图1 ThreadPoolExecutor UML 类图"></a>图1 ThreadPoolExecutor UML 类图</p><p>ThreadPoolExecutor 实现的顶层接口是 Executor，顶层接口 Executor 提供了一种思想：将任务提交和任务执行进行解耦。用户无需关注如何创建线程，如何调度线程来执行任务，用户只需提供 Runnable 对象，将任务的运行逻辑提交到执行器(Executor)中，由 Executor 框架完成线程的调配和任务的执行部分。ExecutorService 接口增加了一些能力：</p><ol><li>扩充执行任务的能力，补充可以为一个或一批异步任务生成 Future 的方法；</li><li>提供了管控线程池的方法，比如停止线程池的运行。AbstractExecutorService 则是上层的抽象类，将执行任务的流程串联了起来，保证下层的实现只需关注一个执行任务的方法即可。最下层的实现类 ThreadPoolExecutor 实现最复杂的运行部分，ThreadPoolExecutor 将会一方面维护自身的生命周期，另一方面同时管理线程和任务，使两者良好的结合从而执行并行任务。</li></ol><p>ThreadPoolExecutor 是如何运行，如何同时维护线程和执行任务的呢？其运行机制如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/77441586f6b312a54264e3fcf5eebe2663494.png"><img src="https://p0.meituan.net/travelcube/77441586f6b312a54264e3fcf5eebe2663494.png" alt="图2 ThreadPoolExecutor 运行流程"></a>图2 ThreadPoolExecutor 运行流程</p><p>线程池在内部实际上构建了一个生产者消费者模型，将线程和任务两者解耦，并不直接关联，从而良好的缓冲任务，复用线程。线程池的运行主要分成两部分：任务管理、线程管理。任务管理部分充当生产者的角色，当任务提交后，线程池会判断该任务后续的流转：</p><ol><li>直接申请线程执行该任务；</li><li>缓冲到队列中等待线程执行；</li><li>拒绝该任务。线程管理部分是消费者，它们被统一维护在线程池内，根据任务请求进行线程的分配，当线程执行完任务后则会继续获取新的任务去执行，最终当线程获取不到任务的时候，线程就会被回收。</li></ol><p>接下来，我们会按照以下三个部分去详细讲解线程池运行机制：</p><ol><li>线程池如何维护自身状态。</li><li>线程池如何管理任务。</li><li>线程池如何管理线程。</li></ol><h3 id="2-2-生命周期管理"><a href="#2-2-生命周期管理" class="headerlink" title="2.2 生命周期管理"></a>2.2 生命周期管理</h3><p>线程池运行的状态，并不是用户显式设置的，而是伴随着线程池的运行，由内部来维护。线程池内部使用一个变量维护两个值：运行状态(runState)和线程数量 (workerCount)。在具体实现中，线程池将运行状态(runState)、线程数量 (workerCount)两个关键参数的维护放在了一起，如下代码所示：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COPYprivate <span class="keyword">final</span> AtomicInteger ctl = <span class="keyword">new</span> AtomicInteger(ctlOf(RUNNING, <span class="number">0</span>));</span><br></pre></td></tr></table></figure><p><code>ctl</code>这个 AtomicInteger 类型，是对线程池的运行状态和线程池中有效线程的数量进行控制的一个字段， 它同时包含两部分的信息：线程池的运行状态 (runState) 和线程池内有效线程的数量 (workerCount)，高3位保存 runState，低 29 位保存 workerCount，两个变量之间互不干扰。用一个变量去存储两个值，可避免在做相关决策时，出现不一致的情况，不必为了维护两者的一致，而占用锁资源。通过阅读线程池源代码也可以发现，经常出现要同时判断线程池运行状态和线程数量的情况。线程池也提供了若干方法去供用户获得线程池当前的运行状态、线程个数。这里都使用的是位运算的方式，相比于基本运算，速度也会快很多。</p><p>关于内部封装的获取生命周期状态、获取线程池线程数量的计算方法如以下代码所示：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">COPYprivate <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">runStateOf</span><span class="params">(<span class="keyword">int</span> c)</span>     </span>&#123; <span class="keyword">return</span> c &amp; ~CAPACITY; &#125; <span class="comment">//计算当前运行状态</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">workerCountOf</span><span class="params">(<span class="keyword">int</span> c)</span>  </span>&#123; <span class="keyword">return</span> c &amp; CAPACITY; &#125;  <span class="comment">//计算当前线程数量</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">ctlOf</span><span class="params">(<span class="keyword">int</span> rs, <span class="keyword">int</span> wc)</span> </span>&#123; <span class="keyword">return</span> rs | wc; &#125;   <span class="comment">//通过状态和线程数生成 ctl</span></span><br></pre></td></tr></table></figure><p>ThreadPoolExecutor 的运行状态有 5 种，分别为：</p><table><thead><tr><th>运行状态</th><th>状态描述</th></tr></thead><tbody><tr><td>RUNNING</td><td>能接受新提交的任务，并且也能处理阻塞队列中的任务。</td></tr><tr><td>SHUTDOWN</td><td>关闭状态，不再接受新提交的任务，但却可以继续处理阻塞队列中已保存的任务。</td></tr><tr><td>STOP</td><td>不能接受新任务，也不处理队列中的任务，会中断正在处理任务的线程。</td></tr><tr><td>TIDYING</td><td>所有的任务都已终止了，workerCount (有效线程数)为0。</td></tr><tr><td>TERMINATED</td><td>在 terminated() 方法执行完后进入该状态。</td></tr></tbody></table><p>其生命周期转换如下入所示：</p><p><a href="https://p0.meituan.net/travelcube/582d1606d57ff99aa0e5f8fc59c7819329028.png"><img src="https://p0.meituan.net/travelcube/582d1606d57ff99aa0e5f8fc59c7819329028.png" alt="图3 线程池生命周期"></a>图3 线程池生命周期</p><h3 id="2-3-任务执行机制"><a href="#2-3-任务执行机制" class="headerlink" title="2.3 任务执行机制"></a>2.3 任务执行机制</h3><h4 id="2-3-1-任务调度"><a href="#2-3-1-任务调度" class="headerlink" title="2.3.1 任务调度"></a>2.3.1 任务调度</h4><p>任务调度是线程池的主要入口，当用户提交了一个任务，接下来这个任务将如何执行都是由这个阶段决定的。了解这部分就相当于了解了线程池的核心运行机制。</p><p>首先，所有任务的调度都是由 execute 方法完成的，这部分完成的工作是：检查现在线程池的运行状态、运行线程数、运行策略，决定接下来执行的流程，是直接申请线程执行，或是缓冲到队列中执行，亦或是直接拒绝该任务。其执行过程如下：</p><ol><li>首先检测线程池运行状态，如果不是 RUNNING，则直接拒绝，线程池要保证在 RUNNING 的状态下执行任务。</li><li>如果 workerCount &lt; corePoolSize，则创建并启动一个线程来执行新提交的任务。</li><li>如果 workerCount &gt;= corePoolSize，且线程池内的阻塞队列未满，则将任务添加到该阻塞队列中。</li><li>如果 workerCount &gt;= corePoolSize &amp;&amp; workerCount &lt; maximumPoolSize，且线程池内的阻塞队列已满，则创建并启动一个线程来执行新提交的任务。</li><li>如果 workerCount &gt;= maximumPoolSize，并且线程池内的阻塞队列已满, 则根据拒绝策略来处理该任务, 默认的处理方式是直接抛异常。</li></ol><p>其执行流程如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/31bad766983e212431077ca8da92762050214.png"><img src="https://p0.meituan.net/travelcube/31bad766983e212431077ca8da92762050214.png" alt="图4 任务调度流程"></a>图4 任务调度流程</p><h4 id="2-3-2-任务缓冲"><a href="#2-3-2-任务缓冲" class="headerlink" title="2.3.2 任务缓冲"></a>2.3.2 任务缓冲</h4><p>任务缓冲模块是线程池能够管理任务的核心部分。线程池的本质是对任务和线程的管理，而做到这一点最关键的思想就是将任务和线程两者解耦，不让两者直接关联，才可以做后续的分配工作。线程池中是以生产者消费者模式，通过一个阻塞队列来实现的。阻塞队列缓存任务，工作线程从阻塞队列中获取任务。</p><p>阻塞队列(BlockingQueue)是一个支持两个附加操作的队列。这两个附加的操作是：在队列为空时，获取元素的线程会等待队列变为非空。当队列满时，存储元素的线程会等待队列可用。阻塞队列常用于生产者和消费者的场景，生产者是往队列里添加元素的线程，消费者是从队列里拿元素的线程。阻塞队列就是生产者存放元素的容器，而消费者也只从容器里拿元素。</p><p>下图中展示了线程 1 往阻塞队列中添加元素，而线程 2 从阻塞队列中移除元素：</p><p><a href="https://p1.meituan.net/travelcube/f4d89c87acf102b45be8ccf3ed83352a9497.png"><img src="https://p1.meituan.net/travelcube/f4d89c87acf102b45be8ccf3ed83352a9497.png" alt="图5 阻塞队列"></a>图5 阻塞队列</p><p>使用不同的队列可以实现不一样的任务存取策略。在这里，我们可以再介绍下阻塞队列的成员：</p><p><a href="https://p0.meituan.net/travelcube/725a3db5114d95675f2098c12dc331c3316963.png"><img src="https://p0.meituan.net/travelcube/725a3db5114d95675f2098c12dc331c3316963.png" alt="img"></a>img</p><h4 id="2-3-3-任务申请"><a href="#2-3-3-任务申请" class="headerlink" title="2.3.3 任务申请"></a>2.3.3 任务申请</h4><p>由上文的任务分配部分可知，任务的执行有两种可能：一种是任务直接由新创建的线程执行。另一种是线程从任务队列中获取任务然后执行，执行完任务的空闲线程会再次去从队列中申请任务再去执行。第一种情况仅出现在线程初始创建的时候，第二种是线程获取任务绝大多数的情况。</p><p>线程需要从任务缓存模块中不断地取任务执行，帮助线程从阻塞队列中获取任务，实现线程管理模块和任务管理模块之间的通信。这部分策略由 getTask 方法实现，其执行流程如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/49d8041f8480aba5ef59079fcc7143b996706.png"><img src="https://p0.meituan.net/travelcube/49d8041f8480aba5ef59079fcc7143b996706.png" alt="图6 获取任务流程图"></a>图6 获取任务流程图</p><p>getTask 这部分进行了多次判断，为的是控制线程的数量，使其符合线程池的状态。如果线程池现在不应该持有那么多线程，则会返回 null 值。工作线程 Worker 会不断接收新任务去执行，而当工作线程 Worker 接收不到任务的时候，就会开始被回收。</p><h4 id="2-3-4-任务拒绝"><a href="#2-3-4-任务拒绝" class="headerlink" title="2.3.4 任务拒绝"></a>2.3.4 任务拒绝</h4><p>任务拒绝模块是线程池的保护部分，线程池有一个最大的容量，当线程池的任务缓存队列已满，并且线程池中的线程数目达到 maximumPoolSize 时，就需要拒绝掉该任务，采取任务拒绝策略，保护线程池。</p><p>拒绝策略是一个接口，其设计如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">COPYpublic <span class="class"><span class="keyword">interface</span> <span class="title">RejectedExecutionHandler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rejectedExecution</span><span class="params">(Runnable r, ThreadPoolExecutor executor)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用户可以通过实现这个接口去定制拒绝策略，也可以选择 JDK 提供的四种已有拒绝策略，其特点如下：</p><p><a href="https://p0.meituan.net/travelcube/9ffb64cc4c64c0cb8d38dac01c89c905178456.png"><img src="https://p0.meituan.net/travelcube/9ffb64cc4c64c0cb8d38dac01c89c905178456.png" alt="img"></a>img</p><h3 id="2-4-Worker-线程管理"><a href="#2-4-Worker-线程管理" class="headerlink" title="2.4 Worker 线程管理"></a>2.4 Worker 线程管理</h3><h4 id="2-4-1-Worker-线程"><a href="#2-4-1-Worker-线程" class="headerlink" title="2.4.1 Worker 线程"></a>2.4.1 Worker 线程</h4><p>线程池为了掌握线程的状态并维护线程的生命周期，设计了线程池内的工作线程 Worker。我们来看一下它的部分代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">COPYprivate <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">extends</span> <span class="title">AbstractQueuedSynchronizer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Thread thread;<span class="comment">//Worker 持有的线程</span></span><br><span class="line">    Runnable firstTask;<span class="comment">//初始化的任务，可以为 null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Worker 这个工作线程，实现了 Runnable 接口，并持有一个线程 thread，一个初始化的任务 firstTask。thread 是在调用构造方法时通过 ThreadFactory 来创建的线程，可以用来执行任务；firstTask 用它来保存传入的第一个任务，这个任务可以有也可以为 null。如果这个值是非空的，那么线程就会在启动初期立即执行这个任务，也就对应核心线程创建时的情况；如果这个值是 null，那么就需要创建一个线程去执行任务列表（workQueue）中的任务，也就是非核心线程的创建。</p><p>Worker 执行任务的模型如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/03268b9dc49bd30bb63064421bb036bf90315.png"><img src="https://p0.meituan.net/travelcube/03268b9dc49bd30bb63064421bb036bf90315.png" alt="图7 Worker 执行任务"></a>图7 Worker 执行任务</p><p>线程池需要管理线程的生命周期，需要在线程长时间不运行的时候进行回收。线程池使用一张 Hash 表去持有线程的引用，这样可以通过添加引用、移除引用这样的操作来控制线程的生命周期。这个时候重要的就是如何判断线程是否在运行。</p><p>Worker 是通过继承 AQS，使用 AQS 来实现独占锁这个功能。没有使用可重入锁 ReentrantLock，而是使用 AQS，为的就是实现不可重入的特性去反应线程现在的执行状态。</p><ol><li>lock 方法一旦获取了独占锁，表示当前线程正在执行任务中。</li><li>如果正在执行任务，则不应该中断线程。</li><li>如果该线程现在不是独占锁的状态，也就是空闲的状态，说明它没有在处理任务，这时可以对该线程进行中断。</li><li>线程池在执行 shutdown 方法或 tryTerminate 方法时会调用 interruptIdleWorkers 方法来中断空闲的线程，interruptIdleWorkers 方法会使用 tryLock 方法来判断线程池中的线程是否是空闲状态；如果线程是空闲状态则可以安全回收。</li></ol><p>在线程回收过程中就使用到了这种特性，回收过程如下图所示：</p><p><a href="https://p1.meituan.net/travelcube/9d8dc9cebe59122127460f81a98894bb34085.png"><img src="https://p1.meituan.net/travelcube/9d8dc9cebe59122127460f81a98894bb34085.png" alt="图8 线程池回收过程"></a>图8 线程池回收过程</p><h4 id="2-4-2-Worker-线程增加"><a href="#2-4-2-Worker-线程增加" class="headerlink" title="2.4.2 Worker 线程增加"></a>2.4.2 Worker 线程增加</h4><p>增加线程是通过线程池中的 addWorker 方法，该方法的功能就是增加一个线程，该方法不考虑线程池是在哪个阶段增加的该线程，这个分配线程的策略是在上个步骤完成的，该步骤仅仅完成增加线程，并使它运行，最后返回是否成功这个结果。addWorker 方法有两个参数：firstTask、core。firstTask 参数用于指定新增的线程执行的第一个任务，该参数可以为空；core 参数为 true 表示在新增线程时会判断当前活动线程数是否少于 corePoolSize，false 表示新增线程前需要判断当前活动线程数是否少于 maximumPoolSize，其执行流程如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/49527b1bb385f0f43529e57b614f59ae145454.png"><img src="https://p0.meituan.net/travelcube/49527b1bb385f0f43529e57b614f59ae145454.png" alt="图9 申请线程执行流程图"></a>图9 申请线程执行流程图</p><h4 id="2-4-3-Worker-线程回收"><a href="#2-4-3-Worker-线程回收" class="headerlink" title="2.4.3 Worker 线程回收"></a>2.4.3 Worker 线程回收</h4><p>线程池中线程的销毁依赖 JVM 自动的回收，线程池做的工作是根据当前线程池的状态维护一定数量的线程引用，防止这部分线程被 JVM 回收，当线程池决定哪些线程需要回收时，只需要将其引用消除即可。Worker 被创建出来后，就会不断地进行轮询，然后获取任务去执行，核心线程可以无限等待获取任务，非核心线程要限时获取任务。当 Worker 无法获取到任务，也就是获取的任务为空时，循环会结束，Worker 会主动消除自身在线程池内的引用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">COPYtry &#123;</span><br><span class="line">  <span class="keyword">while</span> (task != <span class="keyword">null</span> || (task = getTask()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">//执行任务</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  processWorkerExit(w, completedAbruptly);<span class="comment">//获取不到任务时，主动回收自己</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>线程回收的工作是在 processWorkerExit 方法完成的。</p><p><a href="https://p0.meituan.net/travelcube/90ea093549782945f2c968403fdc39d415386.png"><img src="https://p0.meituan.net/travelcube/90ea093549782945f2c968403fdc39d415386.png" alt="图10 线程销毁流程"></a>图10 线程销毁流程</p><p>事实上，在这个方法中，将线程引用移出线程池就已经结束了线程销毁的部分。但由于引起线程销毁的可能性有很多，线程池还要判断是什么引发了这次销毁，是否要改变线程池的现阶段状态，是否要根据新状态，重新分配线程。</p><h4 id="2-4-4-Worker-线程执行任务"><a href="#2-4-4-Worker-线程执行任务" class="headerlink" title="2.4.4 Worker 线程执行任务"></a>2.4.4 Worker 线程执行任务</h4><p>在 Worker 类中的 run 方法调用了 runWorker 方法来执行任务，runWorker 方法的执行过程如下：</p><ol><li>while 循环不断地通过 getTask()方法获取任务。</li><li>getTask()方法从阻塞队列中取任务。</li><li>如果线程池正在停止，那么要保证当前线程是中断状态，否则要保证当前线程不是中断状态。</li><li>执行任务。</li><li>如果 getTask 结果为 null 则跳出循环，执行 processWorkerExit()方法，销毁线程。</li></ol><p>执行流程如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/879edb4f06043d76cea27a3ff358cb1d45243.png"><img src="https://p0.meituan.net/travelcube/879edb4f06043d76cea27a3ff358cb1d45243.png" alt="图11 执行任务流程"></a>图11 执行任务流程</p><h2 id="三、线程池在业务中的实践"><a href="#三、线程池在业务中的实践" class="headerlink" title="三、线程池在业务中的实践"></a>三、线程池在业务中的实践</h2><h3 id="3-1-业务背景"><a href="#3-1-业务背景" class="headerlink" title="3.1 业务背景"></a>3.1 业务背景</h3><p>在当今的互联网业界，为了最大程度利用 CPU 的多核性能，并行运算的能力是不可或缺的。通过线程池管理线程获取并发性是一个非常基础的操作，让我们来看两个典型的使用线程池获取并发性的场景。</p><p><strong>场景1：快速响应用户请求</strong></p><p><strong>描述</strong>：用户发起的实时请求，服务追求响应时间。比如说用户要查看一个商品的信息，那么我们需要将商品维度的一系列信息如商品的价格、优惠、库存、图片等等聚合起来，展示给用户。</p><p><strong>分析</strong>：从用户体验角度看，这个结果响应的越快越好，如果一个页面半天都刷不出，用户可能就放弃查看这个商品了。而面向用户的功能聚合通常非常复杂，伴随着调用与调用之间的级联、多级级联等情况，业务开发同学往往会选择使用线程池这种简单的方式，将调用封装成任务并行的执行，缩短总体响应时间。另外，使用线程池也是有考量的，这种场景最重要的就是获取最大的响应速度去满足用户，所以应该不设置队列去缓冲并发任务，调高 corePoolSize 和 maxPoolSize 去尽可能创造多的线程快速执行任务。</p><p><a href="https://p0.meituan.net/travelcube/e9a363c8577f211577e4962e9110cb0226733.png"><img src="https://p0.meituan.net/travelcube/e9a363c8577f211577e4962e9110cb0226733.png" alt="图12 并行执行任务提升任务响应速度"></a>图12 并行执行任务提升任务响应速度</p><p><strong>场景2：快速处理批量任务</strong></p><p><strong>描述</strong>：离线的大量计算任务，需要快速执行。比如说，统计某个报表，需要计算出全国各个门店中有哪些商品有某种属性，用于后续营销策略的分析，那么我们需要查询全国所有门店中的所有商品，并且记录具有某属性的商品，然后快速生成报表。</p><p><strong>分析</strong>：这种场景需要执行大量的任务，我们也会希望任务执行的越快越好。这种情况下，也应该使用多线程策略，并行计算。但与响应速度优先的场景区别在于，这类场景任务量巨大，并不需要瞬时的完成，而是关注如何使用有限的资源，尽可能在单位时间内处理更多的任务，也就是吞吐量优先的问题。所以应该设置队列去缓冲并发任务，调整合适的 corePoolSize 去设置处理任务的线程数。在这里，设置的线程数过多可能还会引发线程上下文切换频繁的问题，也会降低处理任务的速度，降低吞吐量。</p><p><a href="https://p1.meituan.net/travelcube/1a1746f33bfdcb03da074d8539ebb2f367563.png"><img src="https://p1.meituan.net/travelcube/1a1746f33bfdcb03da074d8539ebb2f367563.png" alt="图13 并行执行任务提升批量任务执行速度"></a>图13 并行执行任务提升批量任务执行速度</p><h3 id="3-2-实际问题及方案思考"><a href="#3-2-实际问题及方案思考" class="headerlink" title="3.2 实际问题及方案思考"></a>3.2 实际问题及方案思考</h3><p>线程池使用面临的核心的问题在于：<strong>线程池的参数并不好配置</strong>。一方面线程池的运行机制不是很好理解，配置合理需要强依赖开发人员的个人经验和知识；另一方面，线程池执行的情况和任务类型相关性较大，IO 密集型和 CPU 密集型的任务运行起来的情况差异非常大，这导致业界并没有一些成熟的经验策略帮助开发人员参考。</p><p>关于线程池配置不合理引发的故障，公司内部有较多记录，下面举一些例子：</p><p><strong>Case1</strong>：2018年 XX 页面展示接口大量调用降级：</p><p><strong>事故描述</strong>：XX 页面展示接口产生大量调用降级，数量级在几十到上百。</p><p><strong>事故原因</strong>：该服务展示接口内部逻辑使用线程池做并行计算，由于没有预估好调用的流量，导致最大核心数设置偏小，大量抛出 RejectedExecutionException，触发接口降级条件，示意图如下：</p><p><a href="https://p0.meituan.net/travelcube/1df932840b31f41931bb69e16be2932844240.png"><img src="https://p0.meituan.net/travelcube/1df932840b31f41931bb69e16be2932844240.png" alt="图14 线程数核心设置过小引发 RejectExecutionException"></a>图14 线程数核心设置过小引发 RejectExecutionException</p><p><strong>Case2</strong>：2018年 XX 业务服务不可用 S2级故障</p><p><strong>事故描述</strong>：XX 业务提供的服务执行时间过长，作为上游服务整体超时，大量下游服务调用失败。</p><p><strong>事故原因</strong>：该服务处理请求内部逻辑使用线程池做资源隔离，由于队列设置过长，最大线程数设置失效，导致请求数量增加时，大量任务堆积在队列中，任务执行时间过长，最终导致下游服务的大量调用超时失败。示意图如下：</p><p><a href="https://p1.meituan.net/travelcube/668e3c90f4b918bfcead2f4280091e9757284.png"><img src="https://p1.meituan.net/travelcube/668e3c90f4b918bfcead2f4280091e9757284.png" alt="图15 线程池队列长度设置过长、corePoolSize 设置过小导致任务执行速度低"></a>图15 线程池队列长度设置过长、corePoolSize 设置过小导致任务执行速度低</p><p>业务中要使用线程池，而使用不当又会导致故障，那么我们怎样才能更好地使用线程池呢？针对这个问题，我们下面延展几个方向：</p><h4 id="3-2-1-能否不用线程池"><a href="#3-2-1-能否不用线程池" class="headerlink" title="3.2.1 能否不用线程池?"></a>3.2.1 能否不用线程池?</h4><p>回到最初的问题，业务使用线程池是为了获取并发性，对于获取并发性，是否可以有什么其他的方案呢替代？我们尝试进行了一些其他方案的调研：</p><p><a href="https://p0.meituan.net/travelcube/56ab763273b2c03b2f1c37db7b150338414771.png"><img src="https://p0.meituan.net/travelcube/56ab763273b2c03b2f1c37db7b150338414771.png" alt="img"></a></p><p>综合考虑，这些新的方案都能在某种情况下提升并行任务的性能，然而本次重点解决的问题是如何更简易、更安全地获得的并发性。另外，Actor 模型的应用实际上甚少，只在 Scala 中使用广泛，协程框架在 Java 中维护的也不成熟。这三者现阶段都不是足够的易用，也并不能解决业务上现阶段的问题。</p><h4 id="3-2-1-追求参数设置合理性？"><a href="#3-2-1-追求参数设置合理性？" class="headerlink" title="3.2.1 追求参数设置合理性？"></a>3.2.1 追求参数设置合理性？</h4><p>有没有一种计算公式，能够让开发同学很简易地计算出某种场景中的线程池应该是什么参数呢？</p><p>带着这样的疑问，我们调研了业界的一些线程池参数配置方案：</p><p><a href="https://p0.meituan.net/travelcube/23a44974ff68a08261fb675242b83648181953.png"><img src="https://p0.meituan.net/travelcube/23a44974ff68a08261fb675242b83648181953.png" alt="img"></a></p><p>调研了以上业界方案后，我们并没有得出通用的线程池计算方式。并发任务的执行情况和任务类型相关，IO 密集型和 CPU 密集型的任务运行起来的情况差异非常大，但这种占比是较难合理预估的，这导致很难有一个简单有效的通用公式帮我们直接计算出结果。</p><h4 id="3-2-3-线程池参数动态化？"><a href="#3-2-3-线程池参数动态化？" class="headerlink" title="3.2.3 线程池参数动态化？"></a>3.2.3 线程池参数动态化？</h4><p>尽管经过谨慎的评估，仍然不能够保证一次计算出来合适的参数，那么我们是否可以将修改线程池参数的成本降下来，这样至少可以发生故障的时候可以快速调整从而缩短故障恢复的时间呢？基于这个思考，我们是否可以将线程池的参数<br>从代码中迁移到分布式配置中心上，实现线程池参数可动态配置和即时生效，线程池参数动态化前后的参数修改流程对比如下：</p><p><a href="https://p0.meituan.net/travelcube/c6caa5be64f39758ada0593b995d65fd25982.png"><img src="https://p0.meituan.net/travelcube/c6caa5be64f39758ada0593b995d65fd25982.png" alt="图16 动态修改线程池参数新旧流程对比"></a>图16 动态修改线程池参数新旧流程对比</p><p>基于以上三个方向对比，我们可以看出参数动态化方向简单有效。</p><h3 id="3-3-动态化线程池"><a href="#3-3-动态化线程池" class="headerlink" title="3.3 动态化线程池"></a>3.3 动态化线程池</h3><h4 id="3-3-1-整体设计"><a href="#3-3-1-整体设计" class="headerlink" title="3.3.1 整体设计"></a>3.3.1 整体设计</h4><p>动态化线程池的核心设计包括以下三个方面：</p><ol><li>简化线程池配置：线程池构造参数有8个，但是最核心的是3个：corePoolSize、maximumPoolSize，workQueue，它们最大程度地决定了线程池的任务分配和线程分配策略。考虑到在实际应用中我们获取并发性的场景主要是两种：</li></ol><ul><li>并行执行子任务，提高响应速度。这种情况下，应该使用同步队列，没有什么任务应该被缓存下来，而是应该立即执行。</li><li>并行执行大批次任务，提升吞吐量。这种情况下，应该使用有界队列，使用队列去缓冲大批量的任务，队列容量必须声明，防止任务无限制堆积。所以线程池只需要提供这三个关键参数的配置，并且提供两种队列的选择，就可以满足绝大多数的业务需求，Less is More。</li></ul><ol><li>参数可动态修改：为了解决参数不好配，修改参数成本高等问题。在 Java 线程池留有高扩展性的基础上，封装线程池，允许线程池监听同步外部的消息，根据消息进行修改配置。将线程池的配置放置在平台侧，允许开发同学简单的查看、修改线程池配置。</li><li>增加线程池监控：对某事物缺乏状态的观测，就对其改进无从下手。在线程池执行任务的生命周期添加监控能力，帮助开发同学了解线程池状态。</li></ol><p><a href="https://p1.meituan.net/travelcube/4d5c410ad23782350cc9f980787151fd54144.png"><img src="https://p1.meituan.net/travelcube/4d5c410ad23782350cc9f980787151fd54144.png" alt="图17 动态化线程池整体设计"></a>图17 动态化线程池整体设计</p><h4 id="3-3-2-功能架构"><a href="#3-3-2-功能架构" class="headerlink" title="3.3.2 功能架构"></a>3.3.2 功能架构</h4><p>动态化线程池提供如下功能：</p><p><strong>动态调参</strong>：支持线程池参数动态调整、界面化操作；包括修改线程池核心大小、最大核心大小、队列长度等；参数修改后及时生效。</p><p><strong>任务监控</strong>：支持应用粒度、线程池粒度、任务粒度的 Transaction 监控；可以看到线程池的任务执行情况、最大任务执行时间、平均任务执行时间、95/99线等。</p><p><strong>负载告警</strong>：线程池队列任务积压到一定值的时候会通过大象（美团内部通讯工具）告知应用开发负责人；当线程池负载数达到一定阈值的时候会通过大象告知应用开发负责人。</p><p><strong>操作监控</strong>：创建/修改和删除线程池都会通知到应用的开发负责人。</p><p><strong>操作日志</strong>：可以查看线程池参数的修改记录，谁在什么时候修改了线程池参数、修改前的参数值是什么。</p><p><strong>权限校验</strong>：只有应用开发负责人才能够修改应用的线程池参数。</p><p><a href="https://p0.meituan.net/travelcube/6c0091e92e90f50f89fd83f3b9eb5472135718.png"><img src="https://p0.meituan.net/travelcube/6c0091e92e90f50f89fd83f3b9eb5472135718.png" alt="图18 动态化线程池功能架构"></a>图18 动态化线程池功能架构</p><h4 id="3-2-3-参数动态化"><a href="#3-2-3-参数动态化" class="headerlink" title="3.2.3 参数动态化"></a>3.2.3 参数动态化</h4><p>JDK 原生线程池 ThreadPoolExecutor 提供了如下几个 public 的 setter 方法，如下图所示：</p><p><a href="https://p1.meituan.net/travelcube/efd32f1211e9cf0a3ca9d35b0dc5de8588353.png"><img src="https://p1.meituan.net/travelcube/efd32f1211e9cf0a3ca9d35b0dc5de8588353.png" alt="图19 JDK 线程池参数设置接口"></a>图19 JDK 线程池参数设置接口</p><p>JDK 允许线程池使用方通过 ThreadPoolExecutor 的实例来动态设置线程池的核心策略，以 setCorePoolSize 为方法例，在运行期线程池使用方调用此方法设置 corePoolSize 之后，线程池会直接覆盖原来的 corePoolSize 值，并且基于当前值和原始值的比较结果采取不同的处理策略。对于当前值小于当前工作线程数的情况，说明有多余的 worker 线程，此时会向当前 idle 的 worker 线程发起中断请求以实现回收，多余的 worker 在下次 idel 的时候也会被回收；对于当前值大于原始值且当前队列中有待执行任务，则线程池会创建新的 worker 线程来执行队列任务，setCorePoolSize 具体流程如下：</p><p><a href="https://p0.meituan.net/travelcube/9379fe1666818237f842138812bf63bd85645.png"><img src="https://p0.meituan.net/travelcube/9379fe1666818237f842138812bf63bd85645.png" alt="图20 setCorePoolSize 方法执行流程"></a>图20 setCorePoolSize 方法执行流程</p><p>线程池内部会处理好当前状态做到平滑修改，其他几个方法限于篇幅，这里不一一介绍。重点是基于这几个 public 方法，我们只需要维护 ThreadPoolExecutor 的实例，并且在需要修改的时候拿到实例修改其参数即可。基于以上的思路，我们实现了线程池参数的动态化、线程池参数在管理平台可配置可修改，其效果图如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/414ba7f3abd11e5f805c58635ae10988166121.png"><img src="https://p0.meituan.net/travelcube/414ba7f3abd11e5f805c58635ae10988166121.png" alt="图21 可动态修改线程池参数"></a>图21 可动态修改线程池参数</p><p>用户可以在管理平台上通过线程池的名字找到指定的线程池，然后对其参数进行修改，保存后会实时生效。目前支持的动态参数包括核心数、最大值、队列长度等。除此之外，在界面中，我们还能看到用户可以配置是否开启告警、队列等待任务告警阈值、活跃度告警等等。关于监控和告警，我们下面一节会对齐进行介绍。</p><h4 id="3-2-4-线程池监控"><a href="#3-2-4-线程池监控" class="headerlink" title="3.2.4 线程池监控"></a>3.2.4 线程池监控</h4><p>除了参数动态化之外，为了更好地使用线程池，我们需要对线程池的运行状况有感知，比如当前线程池的负载是怎么样的？分配的资源够不够用？任务的执行情况是怎么样的？是长任务还是短任务？基于对这些问题的思考，动态化线程池提供了多个维度的监控和告警能力，包括：线程池活跃度、任务的执行 Transaction（频率、耗时）、Reject 异常、线程池内部统计信息等等，既能帮助用户从多个维度分析线程池的使用情况，又能在出现问题第一时间通知到用户，从而避免故障或加速故障恢复。</p><h4 id="3-2-5-负载监控和告警"><a href="#3-2-5-负载监控和告警" class="headerlink" title="3.2.5 负载监控和告警"></a>3.2.5 负载监控和告警</h4><p>线程池负载关注的核心问题是：基于当前线程池参数分配的资源够不够。对于这个问题，我们可以从事前和事中两个角度来看。事前，线程池定义了“活跃度”这个概念，来让用户在发生 Reject 异常之前能够感知线程池负载问题，线程池活跃度计算公式为：线程池活跃度 = activeCount/maximumPoolSize。这个公式代表当活跃线程数趋向于 maximumPoolSize 的时候，代表线程负载趋高。事中，也可以从两方面来看线程池的过载判定条件，一个是发生了 Reject 异常，一个是队列中有等待任务（支持定制阈值）。以上两种情况发生了都会触发告警，告警信息会通过大象推送给服务所关联的负责人。</p><p><a href="https://p0.meituan.net/travelcube/04e73f7186a91d99181e1b5615ce9e4a318600.png"><img src="https://p0.meituan.net/travelcube/04e73f7186a91d99181e1b5615ce9e4a318600.png" alt="图22 大象告警通知"></a>图22 大象告警通知</p><h4 id="3-2-6-任务级精细化监控"><a href="#3-2-6-任务级精细化监控" class="headerlink" title="3.2.6 任务级精细化监控"></a>3.2.6 任务级精细化监控</h4><p>在传统的线程池应用场景中，线程池中的任务执行情况对于用户来说是透明的。比如在一个具体的业务场景中，业务开发申请了一个线程池同时用于执行两种任务，一个是发消息任务、一个是发短信任务，这两类任务实际执行的频率和时长对于用户来说没有一个直观的感受，很可能这两类任务不适合共享一个线程池，但是由于用户无法感知，因此也无从优化。动态化线程池内部实现了任务级别的埋点，且允许为不同的业务任务指定具有业务含义的名称，线程池内部基于这个名称做 Transaction 打点，基于这个功能，用户可以看到线程池内部任务级别的执行情况，且区分业务，任务监控示意图如下图所示：</p><p><a href="https://p1.meituan.net/travelcube/cd0b9445c3c93a866201b7cfb24d2ce7214776.png"><img src="https://p1.meituan.net/travelcube/cd0b9445c3c93a866201b7cfb24d2ce7214776.png" alt="图23 线程池任务执行监控"></a>图23 线程池任务执行监控</p><h4 id="3-2-7-运行时状态实时查看"><a href="#3-2-7-运行时状态实时查看" class="headerlink" title="3.2.7 运行时状态实时查看"></a>3.2.7 运行时状态实时查看</h4><p>用户基于 JDK 原生线程池 ThreadPoolExecutor 提供的几个 public 的 getter 方法，可以读取到当前线程池的运行状态以及参数，如下图所示：</p><p><a href="https://p0.meituan.net/travelcube/aba8d9c09e6f054c7061ddd720a04a26147951.png"><img src="https://p0.meituan.net/travelcube/aba8d9c09e6f054c7061ddd720a04a26147951.png" alt="图24 线程池实时运行情况"></a>图24 线程池实时运行情况</p><p>动态化线程池基于这几个接口封装了运行时状态实时查看的功能，用户基于这个功能可以了解线程池的实时状态，比如当前有多少个工作线程，执行了多少个任务，队列中等待的任务数等等。效果如下图所示：</p><p><a href="https://p1.meituan.net/travelcube/38d5fbeaebd4998f3a30d44bd20b996f113233.png"><img src="https://p1.meituan.net/travelcube/38d5fbeaebd4998f3a30d44bd20b996f113233.png" alt="图25 线程池实时运行情况"></a>图25 线程池实时运行情况</p><h3 id="3-4-实践总结"><a href="#3-4-实践总结" class="headerlink" title="3.4 实践总结"></a>3.4 实践总结</h3><p>面对业务中使用线程池遇到的实际问题，我们曾回到支持并发性问题本身来思考有没有取代线程池的方案，也曾尝试着去追求线程池参数设置的合理性，但面对业界方案具体落地的复杂性、可维护性以及真实运行环境的不确定性，我们在前两个方向上可谓“举步维艰”。最终，我们回到线程池参数动态化方向上探索，得出一个且可以解决业务问题的方案，虽然本质上还是没有逃离使用线程池的范畴，但是在成本和收益之间，算是取得了一个很好的平衡。成本在于实现动态化以及监控成本不高，收益在于：在不颠覆原有线程池使用方式的基础之上，从降低线程池参数修改的成本以及多维度监控这两个方面降低了故障发生的概率。希望本文提供的动态化线程池思路能对大家有帮助。</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
            <tag> 并发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生产环境日常命令</title>
      <link href="2ef1ed5250c5.html"/>
      <url>2ef1ed5250c5.html</url>
      
        <content type="html"><![CDATA[<h2 id="生产环境日常命令"><a href="#生产环境日常命令" class="headerlink" title="生产环境日常命令"></a>生产环境日常命令</h2><p>查看http的并发请求数与其TCP连接状态</p><p>netstat -n | awk ‘/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}’</p><p>{++S[$NF]统计每行最后一个出现的次数，至少一次，放入数组中$NF的意思就是打印最后一行<br>END前面是把最后一个字段+1放到数组S中,END是把数组打印出来,<br>关联数组的key是最后一个字段的值,value都是1(因为默认值是0,++后是1)<br>查看当前系统每个ip的连接数</p><p>ESTABLISHED：正常数据传输状态</p><p>CLOSED：无连接是活动 的或正在进行</p><p>TIME_WAIT：另一边已初始化一个释放</p><p>查看当前系统每个IP的连接数</p><p>netstat -n | awk ‘/^tcp/ {print $5}’| awk -F: ‘{print $1}’ | sort | uniq -c |sort -rn</p><p>sort:排序并输出<br>uniq:去重复行</p><p>用tcpdump嗅探80端口的访问看看谁最高</p><p>tcpdump  -i eth0 -tnn dst port 80 -c 1000 | awk -F”.” ‘{print $1”.”$2”.”$3”.”$4}’ | sort | uniq -c | sort -nr |head -20</p><p>结果：<br>1000 packets captured<br>1002 packets received by filter<br>0 packets dropped by kernel</p><p>1000 IP 192.168.1.103</p><p>#查看网站并发连接数</p><p>netstat -nat|grep ESTABLISHED|wc –l</p><p>查询访问IP总量</p><p>awk ‘{print $1}’ /var/log/nginx/access.log|sort|uniq -c|sort -nr |wc -l</p><p>查询访问量前10的ip</p><p>awk ‘{print $1}’ /var/log/nginx/access.log|sort|uniq -c|sort -nr |head -10</p><p>PV访问量（Page View），即页面访问量，每打开一次页面PV计数+1，刷新页面也是</p><p>IP访问数指公网IP访问数</p><p>UV访问数（Unique Visitor）指独立访客访问数，一台电脑终端为一个访客</p><p>在/test目录中查找包括ibm内容的文件</p><p>ls /test |xargs grep -ri “ibm”</p><p>打印nginx.conf的行号和内容</p><p>cat -n /etc/nginx.conf</p><p>替换文件内容<br>vim /test/test.txt<br>:%  s/b/a/g<br>sed -i ‘s/a/bb/g’ test.txt</p><p>linux如果挂载wind共享目录</p><p>mount -t cifs -o usernam=账户名,password=密码 //ip/目录 挂载目录</p><p>shell下32位随机密码生成<br>cat /dev/urandom | head -1 | md5sum | head -c 32 &gt;&gt; /pass</p><p>写一个脚本查找最后创建时间是3天前，后缀是*.log的文件并删除</p><p>find / -name “*.log” -ctime +3 -exec rm -f {} ;</p><p>写一个脚本将某目录下大于100K的文件移动至/tmp</p><p>#!/bin/bash<br>for file in <code>ls /root</code><br>do<br>if [ -f $file ];then<br>   if [ <code>ls -l $file|awk &#39;&#123;print $5&#125;&#39;</code> -gt 100000 ];then<br>   mv $file /test/<br>fi<br>fi<br>done</p><p>如何查看二进制文件</p><p>hexdump</p><p>在当前目录把包含xx内容的文件找出，并提取出规定三个内容，并把指定的一个内容改成要求的格式（提示：先替换分隔符）</p><p>ls /test |xargs grep -ri “aa” |awk ‘{print $1,$2,$3,$4,$5}</p><h3 id="MySQL误操作后快速恢复数据的方法"><a href="#MySQL误操作后快速恢复数据的方法" class="headerlink" title="MySQL误操作后快速恢复数据的方法"></a>MySQL误操作后快速恢复数据的方法</h3><p><a href="https://www.jb51.net/article/99941.htm">https://www.jb51.net/article/99941.htm</a></p><p><a href="https://www.cnblogs.com/kevingrace/p/5904800.html">https://www.cnblogs.com/kevingrace/p/5904800.html</a></p><p>mysql一主多从，主库宕机如何合理切换从库，其他从库如何处理</p><p><a href="https://blog.csdn.net/yabingshi_tech/article/details/51286073">https://blog.csdn.net/yabingshi_tech/article/details/51286073</a></p><p><a href="http://blog.51cto.com/ucode/1747078">http://blog.51cto.com/ucode/1747078</a></p><p>查看http的并发请求数与其TCP连接状态<br>netstat -n | awk ‘/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}’</p><p>{++S[$NF]  统计每行最后一个出现的次数，至少一次，放入数组中$NF的意思就是打印最后一行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">END前面是把最后一个字段+1放到数组S中,END是把数组打印出来, 关联数组的key是最后一个字段的值,value都是1(因为默认值是0,++后是1)</span><br></pre></td></tr></table></figure><p>查询访问量前10的IP地址<br>awk ‘{print $1}’ /var/log/nginx/access.log|sort|uniq -c|sort -nr|head –10</p><p>sort 将文件进行排序-n：依照数值的大小排序 ，-r：以相反的顺序来排序；</p><p>例子：sort error.log |uniq -c |sort -rn &gt;&gt; cuowu.txt     #对文本行按重复次数进行排序，分析日志用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-b：忽略每行前面开始出的空格字符；</span><br><span class="line">-c：检查文件是否已经按照顺序排序；</span><br><span class="line">-d：排序时，处理英文字母、数字及空格字符外，忽略其他的字符；</span><br><span class="line">-f：排序时，将小写字母视为大写字母；</span><br><span class="line">-i：排序时，除了040至176之间的ASCII字符外，忽略其他的字符；</span><br><span class="line">-m：将几个排序号的文件进行合并；</span><br><span class="line">-M：将前面3个字母依照月份的缩写进行排序；</span><br><span class="line">-n：依照数值的大小排序；</span><br><span class="line">-o&lt;输出文件&gt;：将排序后的结果存入制定的文件；</span><br><span class="line">-r：以相反的顺序来排序；</span><br><span class="line">-t&lt;分隔字符&gt;：指定排序时所用的栏位分隔字符；</span><br><span class="line">+&lt;起始栏位&gt;-&lt;结束栏位&gt;：以指定的栏位来排序，范围由起始栏位到结束栏位的前一栏位。</span><br><span class="line">uniq   去重 -c在每列旁边显示该行的重复次数</span><br><span class="line">-c或——count：在每列旁边显示该行重复出现的次数；</span><br><span class="line">-d或--repeated：仅显示重复出现的行列；</span><br><span class="line">-f&lt;栏位&gt;或--skip-fields&#x3D;&lt;栏位&gt;：忽略比较指定的栏位；</span><br><span class="line">-s&lt;字符位置&gt;或--skip-chars&#x3D;&lt;字符位置&gt;：忽略比较指定的字符；</span><br><span class="line">-u或——unique：仅显示出一次的行列；</span><br><span class="line">-w&lt;字符位置&gt;或--check-chars&#x3D;&lt;字符位置&gt;：指定要比较的字符。</span><br></pre></td></tr></table></figure><p>ls |xargs du -h|sort -rn |head  -20     #列出当前<strong>目录</strong>使用量，并按大小排序，#不递归下级目录使用du –sh</p><p>xargs用作替换工具，读取输入数据重新格式化后输出</p><p>ll   -hS                          #列出当前目录文件并按大小排序</p><p>mysqldump -h 172.26.100.145 -uroot -proot test &gt;/home/testbackup.sql 备份远程test数据库到本地<br>如果要备份本地mysql库到远程服务器，就先备份到本地在拷贝过远程服务器或者挂载远程服务器某目录</p><p>mysqldump -uroot -p123456 –opt –all-databases &gt;all-data.sql     #备份所有库<br>mysql -uroot -pqwer1234 &lt; /bak/mysqlbak/2018031711-all.sql      #还原</p><p>#本地文件复制到远程服务器，如果要复制目录 scp –r</p><p>scp –r /www/  <a href="mailto:&#x72;&#x6f;&#x6f;&#x74;&#64;&#x31;&#50;&#x31;&#x2e;&#50;&#48;&#49;&#46;&#54;&#x36;&#x2e;&#x31;&#x34;&#x39;">&#x72;&#x6f;&#x6f;&#x74;&#64;&#x31;&#50;&#x31;&#x2e;&#50;&#48;&#49;&#46;&#54;&#x36;&#x2e;&#x31;&#x34;&#x39;</a>:/opt/ </p><p>#复制远程服务器目录到本地</p><p>scp -r <a href="mailto:&#x72;&#111;&#111;&#x74;&#x40;&#x31;&#x32;&#49;&#x2e;&#x32;&#x30;&#49;&#x2e;&#54;&#54;&#x2e;&#51;&#56;">&#x72;&#111;&#111;&#x74;&#x40;&#x31;&#x32;&#49;&#x2e;&#x32;&#x30;&#49;&#x2e;&#54;&#54;&#x2e;&#51;&#56;</a>:/www/ /opt/ </p><p>#查找并删除七天以前的数据</p><p>find /opt/db_bak/ -name “*.sql” -type f -mtime +7 -exec rm {} ; &gt; /dev/null 2&gt;&amp;1</p><p>#查找前48~24小时修改过的文件。而不是48小时以内修改过的文件</p><p>find /opt/db_bak/ -name “*.sql” -type f -mtime 1   </p><p>find /opt -type f -size 0 -exec rm -rf {} ;               #删除空文件</p><p>nethogs                #监控每个进程的网络带宽占用<br>iftop                   #动态查看网卡流量</p><p>dstat 3 5               #执行５次，每次间隔３秒性能监控器－dstat</p><p>#看进程号为18842的进程打开了哪些文件<br>ps -ef |grep nginx<br>lsof -p 1859</p><p>lsof 可以列出被进程所打开的文件的信息</p><p>nginx/sbin/nginx -V     #查看nginx有哪些模块</p><p>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf  #nginx指定配置文件启动</p><p>ps aux –sort=rss |sort -k 6 –rn       #以内存大小排序列出进程</p><p>grep -Ev  “#|^$”  xx.conf    #查看文件排除以#开关和空白行，适合查看配置文件</p><p>sed ‘/#.*$/d; /^ *$/d’       #查看文件排除以#开关和空白行，适合查看配置文件</p><p>grep –r –l 内容 路径          #查找包含某些内容的文件</p><p>#查找文件中包含error的内容并显示出来 -A 1是同时显示下行内容 -e选项是或者的意思，也就是多条件</p><p>grep -e “error” -A 1  /var/log/nginx/access.log<br>egrep -v “^#|^$”  xx.conf    #查看文件排除以#开关和空白行，适合查看配置文件</p><p>pgrep nginx|xargs kill              #查找进程pid并kill</p><p>ifconfig |awk -F”[ ]+|[:]” ‘NR==2 {print $4}’  获取当前IP地址，强大的awk<br>utmpdump /var/log/wtmp        #文本方式查看wtmp日志(二进制文件)</p><p>find /home/ -user prj -exec cp -a {} /opt/ ;     #查找prj用户所拥有的文件，并放到/opt/下 </p><p>mii-tool eth0                #查看eth0物理连接状态<br>service –status-all            #查看已安装所有服务包括已运行和未运行的服务</p><p>ping -L 源IP -c  目标ip          #指定源IP ping</p><p>dirs     #打印出当前的目录栈,也就是显示最近访问过的目录</p><p>清除缓存<br>echo 1 &gt; /proc/sys/vm/drop_caches<br>echo 2 &gt; /proc/sys/vm/drop_caches<br>echo 3 &gt; /proc/sys/vm/drop_caches</p><p>查询访问量前10的url<br>cat /var/log/nginx/access.log |cut -f 6 -d ‘ ‘|sort |uniq -c |sort -k 1 -n -r |head -10<br>查询最耗时的页面<br>cat /var/log/nginx/access.log |sort -k 4 -n -r |head –10 </p><p>cat /proc/sys/kernel/threads-max   #查看进程的总数，包括未运行的？</p><p>#查看已运行的进程总数<br> ps -ef |wc -l   </p><p>ps -ef|grep php-fpm|wc -l<br>ps -ef|grep nginx|wc -l<br>ps -ef|grep java|wc –l</p><p>pkill -KILL -t pts/0       #踢出登录的用户，用who查看终端</p><p>mysql –help | grep Distrib     #查看mysql版本</p><p>ln -s /usr/local/mysql/bin/* /usr/local/bin/  #编译安装mysql后无法执行mysql等命令，把命令连接到系统默认的路径，路径可能好几个</p><p>crontab -l                    #查看计划任务列表<br>pgrep nginx                   #查看服务进程号<br>top -id 1                    #观察是否有异常进程出现</p><p>setfacl -m u:natasha:rwx fstab          #单独设置用户权限,而不影响其他用户权限<br>getfacl fstab                  #验证权限</p><p>数据备份还原：<br>压缩：<br>tar czvf /opt/http.tar.gz /var/log/httpd/     #压缩备份，备份的包含了路径去除了/<br>解压<br>tar zxvf /opt/http.tar.gz  -C /          #还原直接到/就可以了，因为备份时/下还有var/log路径</p><p><strong>临时解决DOS攻击-封IP<br>iptables -I INPUT -s 91.121.80.20 -j DROP</strong><br><strong>SSH免密登录：</strong><br>配置ssh免秘钥后用scp不需要密码<br>\1. 在服务器 A 上执行如下命令来生成配对密钥：<br>ssh-keygen -t rsa （后面全部按回车）<br>\2. 将 /root/.ssh/ 目录中的 id_rsa.pub 文件复制到 服务器 B 的 /root/.ssh/ 目录中，并改名为 authorized_keys。 如果已经存在就把内容在末尾添加<br>scp /root/.ssh/id_rsa.pub <a href="mailto:&#114;&#x6f;&#111;&#x74;&#x40;&#x31;&#57;&#50;&#46;&#x31;&#54;&#56;&#46;&#x32;&#52;&#46;&#x31;&#x35;&#48;">&#114;&#x6f;&#111;&#x74;&#x40;&#x31;&#57;&#50;&#46;&#x31;&#54;&#56;&#46;&#x32;&#52;&#46;&#x31;&#x35;&#48;</a>:/root/.ssh/authorized_keys<br>以后从服务器 A scp 到服务器 B 就不需要密码了（如果没有/root/.ssh/是因为没执行ssh-keygen -t rsa 生成秘钥命令）</p><p>yum install openssh-clients -y          #scp软件包</p><p>tac命令用于将文件已行为单位的反序输出，即第一行最后显示，最后一行先显示，与cat相反的命令<br>awk  -v 选项，指定在任何输入被读入前定义参数</p><p>#正常联网情况下直接对网络地址(注意前提是ntpd服务要启动)<br>echo ‘*/15 * * * * /usr/sbin/ntpdate  -u 210.72.145.44 ‘ &gt;&gt; /var/spool/cron/root</p><p>/var/spool/cron/root  #计划任务配置文件<br>凌晨三点    00 03 * * *<br>每五分钟执行 */5 * * * *</p><p>每小时执行   0 * * * *</p><p>每天执行    0 0 * * *</p><p>每周执行    0 0 * * 0</p><p>每月执行    0 0 1 * *</p><p>每年执行    0 0 1 1 *</p><p><strong>在zabbix服务上设置邮件报警外部SMTP模式</strong>：<br>#vim /etc/mail.rc   #尾部追加smtp验证信息<br>set from=pengrongjiana@163.com smtp=smtp.163.com<br>set smtp-auth-user=pengrongjiana@163.com smtp-auth-password=qwer1234<br>set smtp-auth=login<br>#设置完成之后发送一个测试邮件，收到邮件表示配置成功<br>echo “发现短时间内大量访问的ip”|mail -s “网站访问警告” <a href="mailto:&#54;&#50;&#51;&#x31;&#56;&#49;&#x39;&#49;&#50;&#64;&#x71;&#x71;&#46;&#x63;&#x6f;&#109;">&#54;&#50;&#51;&#x31;&#56;&#49;&#x39;&#49;&#50;&#64;&#x71;&#x71;&#46;&#x63;&#x6f;&#109;</a><br>如果没有/etc/mail.rc文件，则需要yum install -y mailx</p><p><strong>tcp wrappers 访问控制</strong></p><p>vim /etc/hosts.allow       #仅允许199.150和199.55ssh连接</p><p>sshd:192.168.199.150,192.168.199.55</p><p>vim /etc/hosts.deny</p><p>sshd:all</p><p><strong>linux命令累积&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</strong></p><p>w      ##查看已登录的用户<br>last                #查看用户登录日志<br>lsof -i :22                   #查看22端口被哪个IP进程占用和已建立连接的客户端<br>lsof /bin/bash                  #查看谁正在使用某个文件<br>#查看php-fpm的地址<br>whereis php-fpm<br>启动php-fpm<br>rpm -ql httpd      #服务详细路径<br>tar zcvf - httpd/ | ssh <a href="mailto:&#x72;&#111;&#111;&#116;&#x40;&#x31;&#x30;&#46;&#x30;&#x2e;&#48;&#x2e;&#49;&#48;">&#x72;&#111;&#111;&#116;&#x40;&#x31;&#x30;&#46;&#x30;&#x2e;&#48;&#x2e;&#49;&#48;</a> tar xzf - -C /root  SSH快速备份文件到另一服务器<br>echo -e  处理特殊字符，而不会将它当成一般文字输出，如 echo -e <code>cat access_log</code><br>/etc/profile                #所有系统用户登录执行<br>hash     #记录了已执行过的命令的完整路径<br>grep –e “内容” *.html /  #找到根目录下以.html结尾的文件中含有“内容”的行并显示它们<br>df -hT<br>uptime<br>free -m<br>ls | xargs rm  #目录中大量文件删除</p><p>linux netstat 用不了，安装net-tools即可: yum -y install net-tools</p><p>生成SSH证书并复制到远端服务器# 好像不行<br>ssh-keygen -y -f ~/.ssh/id_rsa &amp;&amp;　cat ~/.ssh/id_rsa.pub | ssh <a href="mailto:&#x72;&#111;&#x6f;&#116;&#x40;&#x31;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#x31;&#57;&#x33;&#x2e;&#x31;&#50;&#57;">&#x72;&#111;&#x6f;&#116;&#x40;&#x31;&#x39;&#x32;&#x2e;&#49;&#x36;&#x38;&#x2e;&#x31;&#57;&#x33;&#x2e;&#x31;&#50;&#57;</a> “cat - &gt;&gt; ~/.ssh/authorized_keys”<br>sed ‘/^$/d’ filename       #删除空行<br>sed ‘s/ //g’ filename       #删除空格<br>sed -i ‘s/#.*$//g’ filename    #删除#后的注释<br>cat /dev/urandom | tr -dc ‘a-zA-Z0-9’ | fold -w 32 | head -n 1    # 生成随机字符<br>行首或行尾插入：<br>sed ‘s/^/new/g’ file<br>sed ‘s/$/new/g’ file<br>wget -r -p -np -k <a href="http://www.jb51.net/">http://www.jb51.net</a>   #用wget下载整站<br>cat filename |awk -F ‘’ ‘{if(NF&gt;6) print $0}’   #查找每行大于几位数的数据：<br>lynx -dump <a href="http://www.jb51.net/">www.jb51.net</a>    #获取HTML页面文本内容包含页面的URL<br>links -dump <a href="http://www.jb51.net/">www.jb51.net</a>    #获取HTML页面文本内容 对中文内容支持不好<br>socat TCP4-LISTEN:1234,reuseaddr,fork, TCP4:<a href="http://www.baidu.com/">www.baidu.com:80</a>  端口重定向</p><p>rpm -qpl xxxxxx.rpm        #安装包默认安装位置</p><p>who -b           #查看最后一次系统启动的时间<br>last reboot        #查看Linux系统历史启动的时间<br>diff              #输出为了两个文件修改后的内容<br>cfdisk /dev/sdb     #图像分区（2T以下）<br>parted /dev/sdb     #大容量存储分区<br>blkid             #列出所有分区的UUID<br>ls -l /dev/disk/by-uuid/     #列出所有分区的UUID和分区名称</p><p>#开始进入扫描、修复文件系统，注意：在单用户模式(init 1)、修复模式或把设备umount后进行修复</p><p>fsck.ext4 -y /dev/sdb</p><p>ethtool -p ethX                #执行网卡灯亮，多网卡是用来判断网卡位置</p><p>lsusb                     #查看USB设备， -v看详细信息<br>more /proc/cpuinfo |grep -i model       #查看CPU型号<br>more /proc/scsi/scsi |grep -i model      #查看硬盘型号<br>nmcli con |sed -n ‘1,2p’                           #获取网卡UUID<br>more /etc/udev/rules.d/70-persistent-net.rules          #查看网卡MAC地址，ifcofig也行<br>chmod -R  +x 目录                              #目录和目录下子目录权限+执行<br>/root/.bash_profile                               #配置单用户登录后执行<br>env                              #列出当前终端上的全部环境变量<br>lsmod                              #列出加载的内核模块<br>modprobe dm-multipath                           #加载模块<br>cat /proc/partitions                               #查看所有分</p><p>blkid               #列出所有分区的UUID</p><p>ls -l /dev/disk/by-uuid/      #列出所有分区的UUID和分区名称</p><p>ntp服务器配置同步系统时间&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br>#正常联网情况下直接对网络地址<br>echo ‘*/15 * * * * /usr/sbin/ntpdate 地址’ &gt;&gt; /var/spool/cron/root</p><p>设置本地ntp时间服务器/etc/ntp.conf</p><p>1.则将“restrict default kod nomodify notrap nopeer noquery”这行修改成：</p><p>restrict default nomodify</p><p>2.如果需要使用本地时间，则把erver 0.centos.pool.ntp.org iburst把这几行同步互联网的</p><p>删掉或者用“#”号注释掉，然后添加以下两行：（注意：相反不添加这两行，直接使用上面的连接互联网，客户端就更新不了）</p><p>server 127.127.1.0</p><p>fudge 127.127.1.0 stratum 10</p><p>3.重启ntpd服务，设置开机启动ntpd服务        #注意客户端不启动ntpd也行</p><p>客户端连接ntp时间服务器，并加入计划任务</p><p>ntpdate 192.168.199.23        #不要频繁执行连接</p><p>echo ‘*/15 * * * * /usr/sbin/ntpdate 192.168.199.23’ &gt;&gt; /var/spool/cron/root</p><p>客户端设置： </p><p>ntpdate  192.168.199.23</p><p>加入计划任务</p><p>如果本地时间和硬件时间都不对。需要手动设置后重启也生效：</p><p>1.date                #查看本地时间</p><p>2.hwclock –show           #查看机器上的硬件时间</p><p>3.date -s “2017-12-27 16:48”     #一次性设置时间</p><p>4.hwclock -w             #写入 BIOS 时间,系统重启后会读取BIOS,clock -w也可以</p><p>clock -w               #把系统时间写入CMOS</p><p>vi /etc/sysconfig/ntpd </p><p>SYNC_HWCLOCK=yes          #将同步好的时间写到CMOS里</p><p>ntpq -p           #检查时间服务器同步的状态</p><p>clock –utc          #显示UTC时间</p><p>同步互联网时钟并写入硬件bios:</p><p>使用以下方式同步LFS系统时间，cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime 修改时区为上海</p><p>ntpdate cn.pool.ntp.org;hwclock -w ,同步时间并写入bios硬件时间；</p><p>设置计划任务，确保时间得到更新，crontab -e.添加以下内容：</p><p>0 * * * * /usr/sbin/ntpdate cn.pool.ntp.org;hwclock -w</p><p>/usr/sbin/ntpdate time.nist.gov   #同步互联网时间，如果没互联网就同步硬件时钟，如果服务器较多就配置一台ntp时间服务器</p><p>系统负载&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>top -id 1                             #观察是否有异常进程出现</p><p>三行：cpu状态</p><p>6.7% us — 用户空间占用CPU的百分比。</p><p>0.4% sy — 内核空间占用CPU的百分比。</p><p>0.0% ni — 改变过优先级的进程占用CPU的百分比</p><p>92.9% id — 空闲CPU百分比</p><p>0.0% wa — IO等待占用CPU的百分比</p><p>0.0% hi — 硬中断（Hardware IRQ）占用CPU的百分比</p><p>0.0% si — 软中断（Software Interrupts）占用CPU的百分比</p><p>0.0% st - 是当 hypervisor 服务另一个虚拟处理器的时候，虚拟 CPU 等待实际 CPU 的时间的百分比。</p><p>top默认的排序列是“%CPU”，按键盘数字“1”，可监控每个逻辑CPU的状况</p><p>敲击键盘“b”（打开/关闭加亮效果）</p><p>通过”shift + &gt;按照%MEM来排序</p><p>敲击“f”键，top进入另一个视图，在这里可以编排基本视图中的显示字段,想显示哪个字段就按什么，比如显示SWAP就按前面的p字母</p><p>PID — 进程id</p><p>USER — 进程所有者</p><p>PR — 进程优先级</p><p>NI — nice值。负值表示高优先级，正值表示低优先级</p><p>VIRT — 进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES</p><p>RES — 进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA</p><p>SHR — 共享内存大小，单位kb</p><p>S — 进程状态。D=不可中断的睡眠状态 R=运行 S=睡眠 T=跟踪/停止 Z=僵尸进程</p><p>%CPU — 上次更新到现在的CPU时间占用百分比</p><p>%MEM — 进程使用的物理内存百分比</p><p>TIME+ — 进程使用的CPU时间总计，单位1/100秒</p><p>COMMAND — 进程名称（命令名/命令行）</p><p>mpstat           #查看CPU使用率</p><p>系统负载&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>ps aux | wc -l  #进程总数检查进程个数是否正常 (比如超过250，比如单个服务的进程数ps -ef |grep httpd|wc -l</p><p>-a 显示一个终端的所有进程，除了会话引线</p><p>-u uid or username 选择有效的用户id或者是用户名</p><p>-x 显示没有控制终端的进程，同时显示各个命令的具体路径</p><p>USER  用户名</p><p>UID  用户ID（User ID）</p><p>PID  进程ID（Process ID）</p><p>PPID  父进程的进程ID（Parent Process id）</p><p>SID  会话ID（Session id）</p><p>%CPU  进程的cpu占用率</p><p>%MEM  进程的内存占用率</p><p>VSZ  进程所使用的虚存的大小（Virtual Size）</p><p>RSS  进程使用的驻留集大小或者是实际内存的大小，Kbytes字节。</p><p>TTY  与进程关联的终端（tty）</p><p>STAT  进程的状态：进程状态使用字符表示的（STAT的状态码）</p><p>R 运行  Runnable (on run queue)      正在运行或在运行队列中等待。</p><p>S 睡眠  Sleeping        休眠中, 受阻, 在等待某个条件的形成或接受到信号。</p><p>I 空闲  Idle</p><p>Z 僵死  Zombie（a defunct process)    进程已终止, 但进程描述符存在, 直到父进程调用wait4()系统调用后释放。</p><p>D 不可中断  Uninterruptible sleep (ususally IO)  收到信号不唤醒和不可运行, 进程必须等待直到有中断发生。</p><p>T 终止  Terminate        进程收到SIGSTOP, SIGSTP, SIGTIN, SIGTOU信号后停止运行运行。</p><p>P 等待交换页</p><p>W 无驻留页  has no resident pages    没有足够的记忆体分页可分配。</p><p>X 死掉的进程</p><p>&lt; 高优先级进程          高优先序的进程</p><p>N 低优先  级进程          低优先序的进程</p><p>L 内存锁页  Lock        有记忆体分页分配并缩在记忆体内</p><p>s 进程的领导者（在它之下有子进程）；</p><p>l 多进程的（使用 CLONE_THREAD, 类似 NPTL pthreads）</p><p>+ 位于后台的进程组</p><p>START  进程启动时间和日期</p><p>TIME  进程使用的总cpu时间</p><p>COMMAND  正在执行的命令行命令</p><p>NI  优先级(Nice)</p><p>PRI  进程优先级编号(Priority)</p><p>WCHAN  进程正在睡眠的内核函数名称；该函数的名称是从/root/system.map文件中获得的。</p><p>FLAGS  与进程相关的数字标识</p><p>系统负载&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>netstat -ap | grep ssh         #找出程序运行的端口</p><p>netstat -n | grep tcp | grep 23 | wc -l #监控网络服务连接数</p><p>-a (all)显示所有选项，默认不显示LISTEN相关</p><p>-t (tcp)仅显示tcp相关选项</p><p>-u (udp)仅显示udp相关选项</p><p>-n 拒绝显示别名，能显示数字的全部转化成数字。</p><p>-l 仅列出有在 Listen (监听) 的服務状态</p><p>-p 显示建立相关链接的程序名</p><p>-r 显示路由信息，路由表</p><p>-e 显示扩展信息，例如uid等</p><p>-s 按各个协议进行统计</p><p>-c 每隔一个固定时间，执行该netstat命令</p><p>“Recv-Q”和”Send-Q”指%0A的是接收队列和发送队列。这些数字一般都应该是0。</p><p>Foreign Address  外部地址</p><p>state   状态 LISTEM监听</p><p>查看连接某服务端口最多的的IP地址</p><p>netstat -nat | grep “192.168.199.22:22” |awk ‘{print $5}’|awk -F: ‘{print $1}’|sort|uniq -c|sort -nr|head -20</p><p>netstat -nat |awk ‘{print $6}’|sort|uniq -c|sort -rn  #TCP各种状态统计排序</p><p>awk ‘{print $1}’ access.log |sort|uniq -c|sort -nr|head -10 #分析access.log获得访问前10位的ip地址</p><p>netstat -a|more                    #列出所有端口</p><p>netstat -ap | grep ssh t -l           #只显示监听端口</p><p>netstat -s                       #显示所有端口的统计信息</p><p>磁盘读写&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>time dd if=/dev/zero of=/test.dbf bs=8k count=300000  #测试磁盘写能力</p><p>time dd if=/dev/sda of=/dev/null bs=8k        #测试磁盘读能力</p><p>time dd if=/dev/sda of=/dxcs.dbf bs=8k         #测试磁盘同时读写速度</p><p>iotop                         #动态查看IO情况</p><p>iotop -o                       #直接查看输出比较高的磁盘读写程序</p><p>日志分析&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>tail -n20 -f messages          #查询最近动态日志最后20条</p><p>uniq -c demo.log            #标记该行重复的数量，不重复值为1</p><p>more 或者less或者head          #因为这些命令都是不是从最近时间开始排序的所以少用</p><p>sed -n</p><p>more?/var/log/secure          #系统的登录日志，查看是否有可疑登录信息</p><p>修改日志保留默认时间&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>vim /etc/logrotate.conf 修改项 rotate 12 单位是周，默认是4周，修改项/var/log/wtmp {  默认是1，改</p><p>为3，</p><p>service rsyslog restart      #重启日志服务器</p><p>不重启系统情况下新添加硬盘（vm也可以)&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>1.fdisk -l       #确认开始有几个硬盘</p><p>2.新添加一块硬盘</p><p>重新读取：</p><p>echo “- - -“ &gt; /sys/class/scsi_host/host0/scan  </p><p>echo “- - -“ &gt; /sys/class/scsi_host/host1/scan</p><p>echo “- - -“ &gt; /sys/class/scsi_host/host2/scan</p><p>ls /sys/class/scsi_device/     #确认扫出来磁盘多少个</p><p>ls /sys/class/scsi_host/      #多少个盘都固定只有这三个的 </p><p>echo 1 &gt; /sys/class/scsi_device/0:0:0:0/device/rescan</p><p>echo 1 &gt; /sys/class/scsi_device/0:0:2:0/device/rescan</p><p>echo 1 &gt; /sys/class/scsi_device/2:0:0:0/device/rescan</p><p>linux启动后出现桌面背景但无登录界面解决办法&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;(这个方法上次好像也没解决)-手动启动桌面</p><p>1.同时按下Ctrl Alt F2 进入命令行界面。 </p><p>2.root登录进去,执行init3         （登录进去后也可以先执行 init 5 试试能不能进桌面）</p><p>3.执行startx 启动界面</p><p>如果重启后还是一样就修改下面的试试</p><p>vi /etc/pam.d/gdm</p><p>将auth required pam_succeed_if.so user != root quiet 这行注释掉</p><p>yum&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br>yum clean all           #清除本地yum软件包<br>yum makecache<br>yum repolist all         #查看仓库列表和状态<br>yum search vnc          #查找有关vnc的软件包<br>yum update  软件包       #更新软件<br>yum -y install xinetd       #安装service管理命令</p><p>rpm命令&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p><p>rpm -ql 软件名                   #查询已安装的软件包的相关文件的安装路径 </p><p>rpm -qs neokylin-lsb                #列出包里文件并显示状态</p><p>rpm -qf  /usr/libexec/clock-applet        #查看属于哪个软件包</p><p>rpm -pql neokylin-lsb-core-4.1-1.el6.ns6.02.x86_64  #列出RPM软件包内的文件信息</p><p>rpm -pqi redhat-lsb                #列出RPM软件包的描述信息</p><p>ln /bin/neokylin_lsb_init /bin/redhat_lsb-init </p><p>rpm -qa|grep neokylin-lsb              #查看lsb已安装的五个软件包</p><p>rpm2cpio redhat-lsb-4.0-7.el6.centos.src.rpm |cpio -idvm #用于将rpm软件包转换为cpio格式的文件后查找里面的软件包(方便查看包里内容)</p><p>rpm -Uvh *.rpm                   #更新软件包，前提是依赖全部都在</p><p>rpm -e gnome-panel-2.30.2-16.el6.ns6.01.x86_64 –nodeps</p><p>mount&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p><p>mount -o remount,rw /opt       #文件系统是只读模式,只需将这个处于只读状态的文件系统重新挂载即可</p><p>mount -a              #将/etc/fstab的所有内容重新加载</p><p>fuser -m directory          #umount不了的时候查看那个进程在使用状态的目录</p><p>mount -t cifs -o username=administrator,password=1 //192.168.24.108/迅雷下载  /wind #挂载wind共享目录</p><p>mount –move /mnt/userdirs /home  #更换挂载点</p><p>findmnt -t ext4           #列出系统挂载点</p><p>mount -t nfs -o vers=3,proto=tcp,rsize=1048576,wsize=1048576,hard,intr,timeo=50 10.241.2.84:/NFS_CloudDisk/CloudDiskShare/ /media   #挂载华为存储？</p><p>设置分辨率：&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>xrandr              #查看当前及支持的分辨率</p><p>gnome-display-properties     #修改分辨率                   </p><p>xrandr -s 1024×768        #设置分辨率，xrandr查看支持的分辨率，一次性的</p><p>xrandr -s 0           #将屏幕恢复到原来的分辨率，当你使用了一些需要或者会自动改动您屏幕分辨率的程序以后。</p><p>遇到一些旧的显示器，先看显卡支持哪些分辨率，然后修改/boot/grub/grub.conf 在quit 后添加vga=773 保存，如果进不了桌面就</p><p>先编辑引导菜单也是在quit 后添加vga=773进入系统后修改/boot/grub/grub.conf 在quit 后添加vga=773</p><p>因为使用的是vnc、xmanager，直接用gnome-display无法调整</p><p>几乎所有的操作系统都能支持与使用X Window，GNOME和KDE也都是以X Window为基础建构成的</p><p>echo $DESKTOP_SESSION      #查看环境是gnome或者kde</p><p>修改系统界面变成英文字符&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p><p>vim /etc/sysconfig/i18n</p><p>LANG=”zh_CN.UTF-8”         #改成LANG=”zh_US.UTF-8”，保存退出，重启系统，不过已经新建的用户不会改变</p><p>更改已经新建的用户为英文字符集，登录用户</p><p>vi ~/.bash_profile</p><p>export LANG=zh_US.utf-8</p><p>注销再登录用户</p><p><strong>一、安装桌面环境</strong> CentOS6.8-minimal安装gnome桌面</p><p>@1、安装桌面软件</p><p>yum groupinstall “Desktop”</p><p>@2、安装X-Window组件</p><p>yum groupinstall “X Window System”</p><p>@3、安装字体</p><p>yum -y install dejavu-sans-* dejavu-serif-fonts</p><p>@4、开机启动</p><p>编辑/etc/inittab文件, 将id:3:initdefault修改为 id:5:initdefault重启后生效</p><h3 id="Linux普通用户配置java环境变量"><a href="#Linux普通用户配置java环境变量" class="headerlink" title="Linux普通用户配置java环境变量"></a>Linux普通用户配置java环境变量</h3><p>1、上传java包到服务器</p><p>2、解压 tar -zxvf jdk-8u131-linux-x64.tar.gz<br>3、配置环境变量</p><p>  3.1、vi ~/.bash_profile</p><p>  3.2、在.bash_profile文件中填入如下语句：</p><p>  export PATH<br>  export JAVA_HOME=/home/appadmin/apps/jdk1.8.0_131<br>  export PATH=$JAVA_HOME/bin:$PATH</p><p>  export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</p><p> 3.3 保存退出</p><p>4、使配置文件生效</p><p>source ~/.bash_profile</p><p>5、测试 java -version</p><h3 id="nohup-短语-后台运行"><a href="#nohup-短语-后台运行" class="headerlink" title="nohup (短语:后台运行)"></a>nohup (短语:后台运行)</h3><p>   查看该语法使用  nohup –help </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@wxapp203 basesoft]# nohup  --help</span><br><span class="line">Usage: nohup COMMAND [ARG]...</span><br><span class="line">  or:  nohup OPTION</span><br><span class="line">Run COMMAND, ignoring hangup signals.</span><br><span class="line"></span><br><span class="line">      --help     display this help and exit</span><br><span class="line">      --version  output version information and exit</span><br><span class="line"></span><br><span class="line">If standard input is a terminal, redirect it from &#x2F;dev&#x2F;null.  &#x2F;&#x2F;标准输入流  重定向到 &#x2F;dev&#x2F;null</span><br><span class="line">If standard output is a terminal, append output to &#96;nohup.out&#39; if possible, &#x2F;&#x2F;即没有指定输出流是，默认追加到当前目录下的nohup.out(无需自己创建)文件中。</span><br><span class="line">&#96;$HOME&#x2F;nohup.out&#39; otherwise.</span><br><span class="line">If standard error is a terminal, redirect it to standard output.  &#x2F;&#x2F;标准错误输出流，重定向到输出流中，即2&gt;&amp;1To save output to FILE, use &#96;nohup COMMAND &gt; FILE&#39;.      &#x2F;&#x2F;也可以指定输出流到文件</span><br><span class="line"></span><br><span class="line">NOTE: your shell may have its own version of nohup, which usually supersedes</span><br><span class="line">the version described here.  Please refer to your shell&#39;s documentation</span><br><span class="line">for details about the options it supports.</span><br></pre></td></tr></table></figure><p>故：我们可以使用  <strong>nohup java -jar \</strong>*jarFile &gt; /dev/null  &amp;**  来替代标准五的使用</p><p> 例如  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ nohup java -jar fwh_biz-0.0.1-SNAPSHOT.war &gt; &#x2F;dev&#x2F;null &amp;    &#x2F;&#x2F;使用命令</span><br><span class="line">[2] 10112                                                     &#x2F;&#x2F;返回进程id</span><br><span class="line">nohup: ignoring input and redirecting stderr to stdout        &#x2F;&#x2F;提示我们 忽略了输入流 并且把标准错误输出流，重定向到输出流中了，而我们把输出流重定向到&#x2F;dev&#x2F;null中，故什么都不会输出</span><br><span class="line">[1] Killed nohup java -jar fwh_biz-0.0.1-SNAPSHOT.war备注：这样看来nohup的功能就是包装(从效果上看它包装了流的走向和一个提示功能)了我们之前的命令.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sql为啥什么会慢？</title>
      <link href="dc4a5a0392d5.html"/>
      <url>dc4a5a0392d5.html</url>
      
        <content type="html"><![CDATA[<hr><p><strong>SQL 语句执行慢的原因是面试中经常会被问到的</strong>，对于服务端开发来说也是必须要关注的问题。总而言之，<strong>出了问题应该要做到心里有数</strong>。</p><p>在生产环境中，SQL 执行慢是很严重的事件。那么如何定位慢 SQL、慢的原因及如何防患于未然。接下来带着这些问题来开启本篇之旅！</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011901.png" alt="图片"></p><p><strong>写操作</strong></p><p>作为后端开发，日常操作数据库最常用的是写操作和读操作。读操作我们下边会讲，这个分类里我们主要来看看写操作时为什么会导致 SQL 变慢。</p><p><strong>刷脏页</strong></p><p>脏页的定义是这样的：内存数据页和磁盘数据页不一致时，那么称这个内存数据页为脏页。</p><p>那为什么会出现脏页，刷脏页又怎么会导致 SQL 变慢呢？那就需要我们来看看写操作时的流程是什么样的。</p><p>对于一条写操作的 SQL 来说，执行的过程中涉及到写日志，内存及同步磁盘这几种情况。</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011902.png" alt="图片"></p><p>这里要提到一个日志文件，那就是 redo log，位于存储引擎层，用来存储物理日志。在写操作的时候，存储引擎（这里讨论的是 Innodb）会将记录写入到 redo log 中，并更新缓存，这样更新操作就算完成了。后续操作存储引擎会在适当的时候把操作记录同步到磁盘里。</p><p>看到这里你可能会有个疑问，redo log 不是日志文件吗，日志文件就存储在磁盘上，那写的时候岂不很慢吗？</p><p>其实，写redo log 的过程是顺序写磁盘的，磁盘顺序写减少了寻道等时间，速度比随机写要快很多（ 类似Kafka存储原理），因此写 redo log 速度是很快的。</p><p>好了，让我们回到开始时候的问题，为什么会出现脏页，并且脏页为什么会使 SQL 变慢。你想想，redo log 大小是一定的，且是循环写入的。在高并发场景下，redo log 很快被写满了，但是数据来不及同步到磁盘里，这时候就会产生脏页，并且还会阻塞后续的写入操作。SQL 执行自然会变慢。</p><p><strong>锁</strong></p><p>写操作时 SQL 慢的另一种情况是可能遇到了锁，这个很容易理解。举个例子，你和别人合租了一间屋子，只有一个卫生间，你们俩同时都想去，但对方比你早了一丢丢。那么此时你只能等对方出来后才能进去。</p><p>对应到 Mysql 中，当某一条 SQL 所要更改的行刚好被加了锁，那么此时只有等锁释放了后才能进行后续操作。</p><p>但是还有一种极端情况，你的室友一直占用着卫生间，那么此时你该怎么整，总不能尿裤子吧，多丢人。对应到Mysql 里就是遇到了死锁或是锁等待的情况。这时候该如何处理呢？</p><p>Mysql 中提供了查看当前锁情况的方式：</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011903.png" alt="图片"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from information_schema.INNODB_TRX</span><br></pre></td></tr></table></figure><p>通过在命令行执行图中的语句，可以查看当前运行的事务情况，这里介绍几个查询结果中重要的参数：</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011904.png" alt="图片"></p><p>当前事务如果等待时间过长或出现死锁的情况，可以通过 「<strong>kill 线程ID</strong>」 的方式释放当前的锁。</p><p>这里的线程 ID 指表中 <strong>trx_mysql_thread_id</strong> 参数。</p><p><strong>读操作</strong></p><p>说完了写操作，读操作大家可能相对来说更熟悉一些。SQL 慢导致读操作变慢的问题在工作中是经常会被涉及到的。</p><p><strong>慢查询</strong></p><p>在讲读操作变慢的原因之前我们先来看看是如何定位慢 SQL 的。Mysql 中有一个叫作<strong>慢查询日志</strong>的东西，它是用来记录超过指定时间的 SQL 语句的。默认情况下是关闭的，通过手动配置才能开启慢查询日志进行定位。</p><p>具体的配置方式是这样的：</p><ul><li>查看当前慢查询日志的开启情况：</li></ul><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011905.png" alt="图片"></p><ul><li>开启慢查询日志（临时）：</li></ul><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011906.png" alt="图片"></p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011907.png" alt="图片"></p><p>注意这里只是临时开启了慢查询日志，如果 mysql 重启后则会失效。可以 my.cnf 中进行配置使其永久生效。</p><p><strong>存在原因</strong></p><p>知道了如何查看执行慢的 SQL 了，那么我们接着看读操作时为什么会导致慢查询，这里列两点常见的原因。</p><p><strong>（1）未命中索引</strong></p><p>SQL 查询慢的原因之一是可能未命中索引，关于使用索引为什么能使查询变快以及使用时的注意事项，网上已经很多了，这里就不多赘述了。</p><p><strong>（2）脏页问题</strong></p><p>另一种还是我们上边所提到的刷脏页情况，只不过和写操作不同的是，是在读时候进行刷脏页的。</p><p>是不是有点懵逼，别急，听我娓娓道来：</p><p>为了避免每次在读写数据时访问磁盘增加 IO 开销，Innodb 存储引擎通过把相应的数据页和索引页加载到内存的缓冲池（buffer pool）中来提高读写速度。然后按照比如最近最少使用原则来保留缓冲池中的缓存数据。</p><p>那么当要读入的数据页不在内存中时，就需要到缓冲池中申请一个数据页，但缓冲池中数据页是一定的，当数据页达到上限时此时就需要把最久不使用的数据页从内存中淘汰掉。但如果淘汰的是脏页呢，那么就需要把脏页刷到磁盘里才能进行复用。</p><p>你看，又回到了刷脏页的情况，读操作时变慢你也能理解了吧？</p><p><strong>防患于未然</strong></p><p>知道了原因，我们如何来避免或缓解这种情况呢？</p><p>首先来看未命中索引的情况：</p><p>不知道大家有没有使用 Mysql 中 explain 的习惯，反正我是每次都会用它来查看下当前 SQL 命中索引的情况。避免其带来一些未知的隐患。</p><p>这里简单介绍下其使用方式，通过在所执行的 SQL 前加上 explain 就可以来分析当前 SQL 的执行计划：</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011908.png" alt="图片"></p><p>执行后的结果对应的字段概要描述如下图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/downey0115/CDN/post/20210119/2020011909.png" alt="图片"></p><p>这里需要重点关注以下几个字段：</p><p><strong>1、type</strong></p><p>表示 MySQL 在表中找到所需行的方式。其中常用的类型有：ALL、index、range、 ref、eq_ref、const、system、NULL 这些类型从左到右，性能逐渐变好。</p><ul><li>ALL：Mysql 遍历全表来找到匹配的行；</li></ul><ul><li>index：与 ALL 区别为 index 类型只遍历索引树；</li></ul><ul><li>range：只检索给定范围的行，使用一个索引来选择行；</li></ul><ul><li>ref：表示上述表的连接匹配条件，哪些列或常量被用于查找索引列上的值；</li></ul><ul><li>eq_ref：类似ref，区别在于使用的是否为唯一索引。对于每个索引键值，表中只有一条记录匹配，简单来说，就是多表连接中使用 primary key 或者 unique key作为关联条件；</li></ul><ul><li>const、system：当 Mysql 对查询某部分进行优化，并转换为一个常量时，使用这些类型访问。如将主键置于 where 列表中，Mysql 就能将该查询转换为一个常量，system 是 const类型的特例，当查询的表只有一行的情况下，使用system；</li></ul><ul><li>NULL：Mysql 在优化过程中分解语句，执行时甚至不用访问表或索引，例如从一个索引列里选取最小值可以通过单独索引查找完成。</li></ul><p><strong>2、possible_keys</strong></p><p>查询时可能使用到的索引（但不一定会被使用，没有任何索引时显示为 NULL）。</p><p><strong>3、key</strong></p><p>实际使用到的索引。</p><p><strong>4、rows</strong></p><p>估算查找到对应的记录所需要的行数。</p><p><strong>5、Extra</strong></p><p>比较常见的是下面几种：</p><ul><li>Useing index：表明使用了覆盖索引，无需进行回表；</li></ul><ul><li>Using where：不用读取表中所有信息，仅通过索引就可以获取所需数据，这发生在对表的全部的请求列都是同一个索引的部分的时候，表示mysql服务器将在存储引擎检索行后再进行过滤；</li></ul><ul><li>Using temporary：表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询，常见 group by，order by；</li></ul><ul><li>Using filesort：当Query中包含 order by 操作，而且无法利用索引完成的排序操作称为“文件排序”。</li></ul><p>对于刷脏页的情况，我们需要控制脏页的比例，不要让它经常接近 75%。同时还要控制 redo log 的写盘速度，并且通过设置 innodb_io_capacity 参数告诉 InnoDB 你的磁盘能力。</p><p><strong>小 结</strong></p><p><strong>写操作</strong></p><ul><li>当 redo log 写满时就会进行刷脏页，此时写操作也会终止，那么 SQL 执行自然就会变慢。</li></ul><ul><li>遇到所要修改的数据行或表加了锁时，需要等待锁释放后才能进行后续操作，SQL 执行也会变慢。</li></ul><p><strong>读操作</strong></p><ul><li>读操作慢很常见的一个原因是未命中索引从而导致全表扫描，可以通过 explain 方式对 SQL 语句进行分析。</li></ul><ul><li>另一种原因是在读操作时，要读入的数据页不在内存中，需要通过淘汰脏页才能申请新的数据页从而导致执行变慢。</li></ul>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly 安裝文檔 主題頁面</title>
      <link href="9c273b1e3d41.html"/>
      <url>9c273b1e3d41.html</url>
      
        <content type="html"><![CDATA[<h2 id="主题相关教程"><a href="#主题相关教程" class="headerlink" title="主题相关教程"></a>主题相关教程</h2><ul><li><a href="https://butterfly.js.org/posts/7670b080/">魔改结合</a>  </li><li><a href="https://butterfly.js.org/posts/21cfbf15/">主题初始教程</a></li></ul><hr><h2 id="Front-matter"><a href="#Front-matter" class="headerlink" title="Front-matter"></a>Front-matter</h2><p>是檔案最上方以 — 分隔的區域，用於指定個別檔案的變數。</p><div class="note info simple"><p>如果標注可選的參數，可根據自己需要添加，不用全部都寫在markdown裏</p></div><ul><li>Page Front-matter</li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">updated:</span><br><span class="line">type:</span><br><span class="line">comments:</span><br><span class="line">description:</span><br><span class="line">keywords:</span><br><span class="line">top<span class="emphasis">_img:</span></span><br><span class="line"><span class="emphasis">mathjax:</span></span><br><span class="line"><span class="emphasis">katex:</span></span><br><span class="line"><span class="emphasis">aside:</span></span><br><span class="line"><span class="emphasis">aplayer:</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink:</span><br><span class="line">---</span><br></pre></td></tr></table></figure><table><thead><tr><th>寫法</th><th>解釋</th></tr></thead><tbody><tr><td>title</td><td>【必需】頁面標題</td></tr><tr><td>date</td><td>【必需】頁面創建日期</td></tr><tr><td>type</td><td>【必需】標籤、分類和友情鏈接三個頁面需要配置</td></tr><tr><td>updated</td><td>【可選】頁面更新日期</td></tr><tr><td>description</td><td>【可選】頁面描述</td></tr><tr><td>keywords</td><td>【可選】頁面關鍵字</td></tr><tr><td>comments</td><td>【可選】顯示頁面評論模塊(默認 true)</td></tr><tr><td>top_img</td><td>【可選】頁面頂部圖片</td></tr><tr><td>mathjax</td><td>【可選】顯示mathjax(當設置mathjax的per_page: false時，才需要配置，默認 false)</td></tr><tr><td>katex</td><td>【可選】顯示katex(當設置katex的per_page: false時，才需要配置，默認 false)</td></tr><tr><td>aside</td><td>【可選】顯示側邊欄 (默認 true)</td></tr><tr><td>aplayer</td><td>【可選】在需要的頁面加載aplayer的js和css,請參考文章下面的音樂 配置</td></tr><tr><td>highlight_shrink</td><td>【可選】配置代碼框是否展開(true/false)(默認為設置中highlight_shrink的配置)</td></tr></tbody></table><h2 id="Post-Front-matter"><a href="#Post-Front-matter" class="headerlink" title="Post Front-matter"></a>Post Front-matter</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">updated:</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">keywords:</span><br><span class="line">description:</span><br><span class="line">top<span class="emphasis">_img:</span></span><br><span class="line"><span class="emphasis">comments:</span></span><br><span class="line"><span class="emphasis">cover:</span></span><br><span class="line"><span class="emphasis">toc:</span></span><br><span class="line"><span class="emphasis">toc_</span>number:</span><br><span class="line">copyright:</span><br><span class="line">copyright<span class="emphasis">_author:</span></span><br><span class="line"><span class="emphasis">copyright_</span>author<span class="emphasis">_href:</span></span><br><span class="line"><span class="emphasis">copyright_</span>url:</span><br><span class="line">copyright<span class="emphasis">_info:</span></span><br><span class="line"><span class="emphasis">mathjax:</span></span><br><span class="line"><span class="emphasis">katex:</span></span><br><span class="line"><span class="emphasis">aplayer:</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink:</span><br><span class="line">aside:</span><br><span class="line">---</span><br></pre></td></tr></table></figure><table><thead><tr><th>寫法</th><th>解釋</th></tr></thead><tbody><tr><td>title</td><td>【必需】文章標題</td></tr><tr><td>date</td><td>【必需】文章創建日期</td></tr><tr><td>updated</td><td>【可選】文章更新日期</td></tr><tr><td>tags</td><td>【可選】文章標籤</td></tr><tr><td>categories</td><td>【可選】文章分類</td></tr><tr><td>keywords</td><td>【可選】文章關鍵字</td></tr><tr><td>description</td><td>【可選】文章描述</td></tr><tr><td>top_img</td><td>【可選】文章頂部圖片</td></tr><tr><td>cover</td><td>【可選】文章縮略圖(如果沒有設置top_img,文章頁頂部將顯示縮略圖，可設為false/圖片地址/留空)</td></tr><tr><td>comments</td><td>【可選】顯示文章評論模塊(默認  true)</td></tr><tr><td>toc</td><td>【可選】顯示文章TOC(默認為設置中toc的enable配置)</td></tr><tr><td>toc_number</td><td>【可選】顯示toc_number(默認為設置中toc的number配置)</td></tr><tr><td>copyright</td><td>【可選】顯示文章版權模塊(默認為設置中post_copyright的enable配置)</td></tr><tr><td>copyright_author</td><td>【可選】文章版權模塊的文章作者</td></tr><tr><td>copyright_author_href</td><td>【可選】文章版權模塊的文章作者鏈接</td></tr><tr><td>copyright_url</td><td>【可選】文章版權模塊的文章連結鏈接</td></tr><tr><td>copyright_info</td><td>【可選】文章版權模塊的版權聲明文字</td></tr><tr><td>mathjax</td><td>【可選】顯示mathjax(當設置mathjax的per_page: false時，才需要配置，默認 false)</td></tr><tr><td>katex</td><td>【可選】顯示katex(當設置katex的per_page: false時，才需要配置，默認 false)</td></tr><tr><td>aplayer</td><td>【可選】在需要的頁面加載aplayer的js和css,請參考文章下面的音樂 配置</td></tr><tr><td>highlight_shrink</td><td>【可選】配置代碼框是否展開(true/false)(默認為設置中highlight_shrink的配置)</td></tr><tr><td>aside</td><td>【可選】顯示側邊欄 (默認  true)</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
